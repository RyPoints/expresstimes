{"ast":null,"code":"module.exports = Point;\n\nvar util = require('util');\n\nvar Geometry = require('./geometry');\n\nvar Types = require('./types');\n\nvar BinaryWriter = require('./binarywriter');\n\nvar ZigZag = require('./zigzag.js');\n\nfunction Point(x, y, z, m, srid) {\n  Geometry.call(this);\n  this.x = x;\n  this.y = y;\n  this.z = z;\n  this.m = m;\n  this.srid = srid;\n  this.hasZ = typeof this.z !== 'undefined';\n  this.hasM = typeof this.m !== 'undefined';\n}\n\nutil.inherits(Point, Geometry);\n\nPoint.Z = function (x, y, z, srid) {\n  var point = new Point(x, y, z, undefined, srid);\n  point.hasZ = true;\n  return point;\n};\n\nPoint.M = function (x, y, m, srid) {\n  var point = new Point(x, y, undefined, m, srid);\n  point.hasM = true;\n  return point;\n};\n\nPoint.ZM = function (x, y, z, m, srid) {\n  var point = new Point(x, y, z, m, srid);\n  point.hasZ = true;\n  point.hasM = true;\n  return point;\n};\n\nPoint._parseWkt = function (value, options) {\n  var point = new Point();\n  point.srid = options.srid;\n  point.hasZ = options.hasZ;\n  point.hasM = options.hasM;\n  if (value.isMatch(['EMPTY'])) return point;\n  value.expectGroupStart();\n  var coordinate = value.matchCoordinate(options);\n  point.x = coordinate.x;\n  point.y = coordinate.y;\n  point.z = coordinate.z;\n  point.m = coordinate.m;\n  value.expectGroupEnd();\n  return point;\n};\n\nPoint._parseWkb = function (value, options) {\n  var point = Point._readWkbPoint(value, options);\n\n  point.srid = options.srid;\n  return point;\n};\n\nPoint._readWkbPoint = function (value, options) {\n  return new Point(value.readDouble(), value.readDouble(), options.hasZ ? value.readDouble() : undefined, options.hasM ? value.readDouble() : undefined);\n};\n\nPoint._parseTwkb = function (value, options) {\n  var point = new Point();\n  point.hasZ = options.hasZ;\n  point.hasM = options.hasM;\n  if (options.isEmpty) return point;\n  point.x = ZigZag.decode(value.readVarInt()) / options.precisionFactor;\n  point.y = ZigZag.decode(value.readVarInt()) / options.precisionFactor;\n  point.z = options.hasZ ? ZigZag.decode(value.readVarInt()) / options.zPrecisionFactor : undefined;\n  point.m = options.hasM ? ZigZag.decode(value.readVarInt()) / options.mPrecisionFactor : undefined;\n  return point;\n};\n\nPoint._readTwkbPoint = function (value, options, previousPoint) {\n  previousPoint.x += ZigZag.decode(value.readVarInt()) / options.precisionFactor;\n  previousPoint.y += ZigZag.decode(value.readVarInt()) / options.precisionFactor;\n  if (options.hasZ) previousPoint.z += ZigZag.decode(value.readVarInt()) / options.zPrecisionFactor;\n  if (options.hasM) previousPoint.m += ZigZag.decode(value.readVarInt()) / options.mPrecisionFactor;\n  return new Point(previousPoint.x, previousPoint.y, previousPoint.z, previousPoint.m);\n};\n\nPoint._parseGeoJSON = function (value) {\n  return Point._readGeoJSONPoint(value.coordinates);\n};\n\nPoint._readGeoJSONPoint = function (coordinates) {\n  if (coordinates.length === 0) return new Point();\n  if (coordinates.length > 2) return new Point(coordinates[0], coordinates[1], coordinates[2]);\n  return new Point(coordinates[0], coordinates[1]);\n};\n\nPoint.prototype.toWkt = function () {\n  if (typeof this.x === 'undefined' && typeof this.y === 'undefined' && typeof this.z === 'undefined' && typeof this.m === 'undefined') return this._getWktType(Types.wkt.Point, true);\n  return this._getWktType(Types.wkt.Point, false) + '(' + this._getWktCoordinate(this) + ')';\n};\n\nPoint.prototype.toWkb = function (parentOptions) {\n  var wkb = new BinaryWriter(this._getWkbSize());\n  wkb.writeInt8(1);\n\n  this._writeWkbType(wkb, Types.wkb.Point, parentOptions);\n\n  if (typeof this.x === 'undefined' && typeof this.y === 'undefined') {\n    wkb.writeDoubleLE(NaN);\n    wkb.writeDoubleLE(NaN);\n    if (this.hasZ) wkb.writeDoubleLE(NaN);\n    if (this.hasM) wkb.writeDoubleLE(NaN);\n  } else {\n    this._writeWkbPoint(wkb);\n  }\n\n  return wkb.buffer;\n};\n\nPoint.prototype._writeWkbPoint = function (wkb) {\n  wkb.writeDoubleLE(this.x);\n  wkb.writeDoubleLE(this.y);\n  if (this.hasZ) wkb.writeDoubleLE(this.z);\n  if (this.hasM) wkb.writeDoubleLE(this.m);\n};\n\nPoint.prototype.toTwkb = function () {\n  var twkb = new BinaryWriter(0, true);\n  var precision = Geometry.getTwkbPrecision(5, 0, 0);\n  var isEmpty = typeof this.x === 'undefined' && typeof this.y === 'undefined';\n\n  this._writeTwkbHeader(twkb, Types.wkb.Point, precision, isEmpty);\n\n  if (!isEmpty) this._writeTwkbPoint(twkb, precision, new Point(0, 0, 0, 0));\n  return twkb.buffer;\n};\n\nPoint.prototype._writeTwkbPoint = function (twkb, precision, previousPoint) {\n  var x = this.x * precision.xyFactor;\n  var y = this.y * precision.xyFactor;\n  var z = this.z * precision.zFactor;\n  var m = this.m * precision.mFactor;\n  twkb.writeVarInt(ZigZag.encode(x - previousPoint.x));\n  twkb.writeVarInt(ZigZag.encode(y - previousPoint.y));\n  if (this.hasZ) twkb.writeVarInt(ZigZag.encode(z - previousPoint.z));\n  if (this.hasM) twkb.writeVarInt(ZigZag.encode(m - previousPoint.m));\n  previousPoint.x = x;\n  previousPoint.y = y;\n  previousPoint.z = z;\n  previousPoint.m = m;\n};\n\nPoint.prototype._getWkbSize = function () {\n  var size = 1 + 4 + 8 + 8;\n  if (this.hasZ) size += 8;\n  if (this.hasM) size += 8;\n  return size;\n};\n\nPoint.prototype.toGeoJSON = function (options) {\n  var geoJSON = Geometry.prototype.toGeoJSON.call(this, options);\n  geoJSON.type = Types.geoJSON.Point;\n  if (typeof this.x === 'undefined' && typeof this.y === 'undefined') geoJSON.coordinates = [];else if (typeof this.z !== 'undefined') geoJSON.coordinates = [this.x, this.y, this.z];else geoJSON.coordinates = [this.x, this.y];\n  return geoJSON;\n};","map":{"version":3,"sources":["/Users/ryandavis/Development/reactapp5/expresstimes/node_modules/wkx/lib/point.js"],"names":["module","exports","Point","util","require","Geometry","Types","BinaryWriter","ZigZag","x","y","z","m","srid","call","hasZ","hasM","inherits","Z","point","undefined","M","ZM","_parseWkt","value","options","isMatch","expectGroupStart","coordinate","matchCoordinate","expectGroupEnd","_parseWkb","_readWkbPoint","readDouble","_parseTwkb","isEmpty","decode","readVarInt","precisionFactor","zPrecisionFactor","mPrecisionFactor","_readTwkbPoint","previousPoint","_parseGeoJSON","_readGeoJSONPoint","coordinates","length","prototype","toWkt","_getWktType","wkt","_getWktCoordinate","toWkb","parentOptions","wkb","_getWkbSize","writeInt8","_writeWkbType","writeDoubleLE","NaN","_writeWkbPoint","buffer","toTwkb","twkb","precision","getTwkbPrecision","_writeTwkbHeader","_writeTwkbPoint","xyFactor","zFactor","mFactor","writeVarInt","encode","size","toGeoJSON","geoJSON","type"],"mappings":"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","sourcesContent":["module.exports = Point;\r\n\r\nvar util = require('util');\r\n\r\nvar Geometry = require('./geometry');\r\nvar Types = require('./types');\r\nvar BinaryWriter = require('./binarywriter');\r\nvar ZigZag = require('./zigzag.js');\r\n\r\nfunction Point(x, y, z, m, srid) {\r\n    Geometry.call(this);\r\n\r\n    this.x = x;\r\n    this.y = y;\r\n    this.z = z;\r\n    this.m = m;\r\n\tthis.srid = srid;\r\n\r\n    this.hasZ = typeof this.z !== 'undefined';\r\n    this.hasM = typeof this.m !== 'undefined';\r\n}\r\n\r\nutil.inherits(Point, Geometry);\r\n\r\nPoint.Z = function (x, y, z, srid) {\r\n    var point = new Point(x, y, z, undefined, srid);\r\n    point.hasZ = true;\r\n    return point;\r\n};\r\n\r\nPoint.M = function (x, y, m, srid) {\r\n    var point = new Point(x, y, undefined, m, srid);\r\n    point.hasM = true;\r\n    return point;\r\n};\r\n\r\nPoint.ZM = function (x, y, z, m, srid) {\r\n    var point = new Point(x, y, z, m, srid);\r\n    point.hasZ = true;\r\n    point.hasM = true;\r\n    return point;\r\n};\r\n\r\nPoint._parseWkt = function (value, options) {\r\n    var point = new Point();\r\n    point.srid = options.srid;\r\n    point.hasZ = options.hasZ;\r\n    point.hasM = options.hasM;\r\n\r\n    if (value.isMatch(['EMPTY']))\r\n        return point;\r\n\r\n    value.expectGroupStart();\r\n\r\n    var coordinate = value.matchCoordinate(options);\r\n\r\n    point.x = coordinate.x;\r\n    point.y = coordinate.y;\r\n    point.z = coordinate.z;\r\n    point.m = coordinate.m;\r\n\r\n    value.expectGroupEnd();\r\n\r\n    return point;\r\n};\r\n\r\nPoint._parseWkb = function (value, options) {\r\n    var point = Point._readWkbPoint(value, options);\r\n    point.srid = options.srid;\r\n    return point;\r\n};\r\n\r\nPoint._readWkbPoint = function (value, options) {\r\n    return new Point(value.readDouble(), value.readDouble(),\r\n        options.hasZ ? value.readDouble() : undefined,\r\n        options.hasM ? value.readDouble() : undefined);\r\n};\r\n\r\nPoint._parseTwkb = function (value, options) {\r\n    var point = new Point();\r\n    point.hasZ = options.hasZ;\r\n    point.hasM = options.hasM;\r\n\r\n    if (options.isEmpty)\r\n        return point;\r\n\r\n    point.x = ZigZag.decode(value.readVarInt()) / options.precisionFactor;\r\n    point.y = ZigZag.decode(value.readVarInt()) / options.precisionFactor;\r\n    point.z = options.hasZ ? ZigZag.decode(value.readVarInt()) / options.zPrecisionFactor : undefined;\r\n    point.m = options.hasM ? ZigZag.decode(value.readVarInt()) / options.mPrecisionFactor : undefined;\r\n\r\n    return point;\r\n};\r\n\r\nPoint._readTwkbPoint = function (value, options, previousPoint) {\r\n    previousPoint.x += ZigZag.decode(value.readVarInt()) / options.precisionFactor;\r\n    previousPoint.y += ZigZag.decode(value.readVarInt()) / options.precisionFactor;\r\n\r\n    if (options.hasZ)\r\n        previousPoint.z += ZigZag.decode(value.readVarInt()) / options.zPrecisionFactor;\r\n    if (options.hasM)\r\n        previousPoint.m += ZigZag.decode(value.readVarInt()) / options.mPrecisionFactor;\r\n\r\n    return new Point(previousPoint.x, previousPoint.y, previousPoint.z, previousPoint.m);\r\n};\r\n\r\nPoint._parseGeoJSON = function (value) {\r\n    return Point._readGeoJSONPoint(value.coordinates);\r\n};\r\n\r\nPoint._readGeoJSONPoint = function (coordinates) {\r\n    if (coordinates.length === 0)\r\n        return new Point();\r\n\r\n    if (coordinates.length > 2)\r\n        return new Point(coordinates[0], coordinates[1], coordinates[2]);\r\n\r\n    return new Point(coordinates[0], coordinates[1]);\r\n};\r\n\r\nPoint.prototype.toWkt = function () {\r\n    if (typeof this.x === 'undefined' && typeof this.y === 'undefined' &&\r\n        typeof this.z === 'undefined' && typeof this.m === 'undefined')\r\n        return this._getWktType(Types.wkt.Point, true);\r\n\r\n    return this._getWktType(Types.wkt.Point, false) + '(' + this._getWktCoordinate(this) + ')';\r\n};\r\n\r\nPoint.prototype.toWkb = function (parentOptions) {\r\n    var wkb = new BinaryWriter(this._getWkbSize());\r\n\r\n    wkb.writeInt8(1);\r\n    this._writeWkbType(wkb, Types.wkb.Point, parentOptions);\r\n\r\n    if (typeof this.x === 'undefined' && typeof this.y === 'undefined') {\r\n        wkb.writeDoubleLE(NaN);\r\n        wkb.writeDoubleLE(NaN);\r\n\r\n        if (this.hasZ)\r\n            wkb.writeDoubleLE(NaN);\r\n        if (this.hasM)\r\n            wkb.writeDoubleLE(NaN);\r\n    }\r\n    else {\r\n        this._writeWkbPoint(wkb);\r\n    }\r\n\r\n    return wkb.buffer;\r\n};\r\n\r\nPoint.prototype._writeWkbPoint = function (wkb) {\r\n    wkb.writeDoubleLE(this.x);\r\n    wkb.writeDoubleLE(this.y);\r\n\r\n    if (this.hasZ)\r\n        wkb.writeDoubleLE(this.z);\r\n    if (this.hasM)\r\n        wkb.writeDoubleLE(this.m);\r\n};\r\n\r\nPoint.prototype.toTwkb = function () {\r\n    var twkb = new BinaryWriter(0, true);\r\n\r\n    var precision = Geometry.getTwkbPrecision(5, 0, 0);\r\n    var isEmpty = typeof this.x === 'undefined' && typeof this.y === 'undefined';\r\n\r\n    this._writeTwkbHeader(twkb, Types.wkb.Point, precision, isEmpty);\r\n\r\n    if (!isEmpty)\r\n        this._writeTwkbPoint(twkb, precision, new Point(0, 0, 0, 0));\r\n\r\n    return twkb.buffer;\r\n};\r\n\r\nPoint.prototype._writeTwkbPoint = function (twkb, precision, previousPoint) {\r\n    var x = this.x * precision.xyFactor;\r\n    var y = this.y * precision.xyFactor;\r\n    var z = this.z * precision.zFactor;\r\n    var m = this.m * precision.mFactor;\r\n\r\n    twkb.writeVarInt(ZigZag.encode(x - previousPoint.x));\r\n    twkb.writeVarInt(ZigZag.encode(y - previousPoint.y));\r\n    if (this.hasZ)\r\n        twkb.writeVarInt(ZigZag.encode(z - previousPoint.z));\r\n    if (this.hasM)\r\n        twkb.writeVarInt(ZigZag.encode(m - previousPoint.m));\r\n\r\n    previousPoint.x = x;\r\n    previousPoint.y = y;\r\n    previousPoint.z = z;\r\n    previousPoint.m = m;\r\n};\r\n\r\nPoint.prototype._getWkbSize = function () {\r\n    var size = 1 + 4 + 8 + 8;\r\n\r\n    if (this.hasZ)\r\n        size += 8;\r\n    if (this.hasM)\r\n        size += 8;\r\n\r\n    return size;\r\n};\r\n\r\nPoint.prototype.toGeoJSON = function (options) {\r\n    var geoJSON = Geometry.prototype.toGeoJSON.call(this, options);\r\n    geoJSON.type = Types.geoJSON.Point;\r\n\r\n    if (typeof this.x === 'undefined' && typeof this.y === 'undefined')\r\n        geoJSON.coordinates = [];\r\n    else if (typeof this.z !== 'undefined')\r\n        geoJSON.coordinates = [this.x, this.y, this.z];\r\n    else\r\n        geoJSON.coordinates = [this.x, this.y];\r\n\r\n    return geoJSON;\r\n};\r\n"]},"metadata":{},"sourceType":"script"}