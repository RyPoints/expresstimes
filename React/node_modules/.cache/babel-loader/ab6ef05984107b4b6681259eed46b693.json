{"ast":null,"code":"/*\r\n * xpath.js\r\n *\r\n * An XPath 1.0 library for JavaScript.\r\n *\r\n * Cameron McCormack <cam (at) mcc.id.au>\r\n *\r\n *\r\n * Revision 20: April 26, 2011\r\n *   Fixed a typo resulting in FIRST_ORDERED_NODE_TYPE results being wrong,\r\n *   thanks to <shi_a009 (at) hotmail.com>.\r\n *\r\n * Revision 19: November 29, 2005\r\n *   Nodesets now store their nodes in a height balanced tree, increasing\r\n *   performance for the common case of selecting nodes in document order,\r\n *   thanks to Sébastien Cramatte <contact (at) zeninteractif.com>.\r\n *   AVL tree code adapted from Raimund Neumann <rnova (at) gmx.net>.\r\n *\r\n * Revision 18: October 27, 2005\r\n *   DOM 3 XPath support.  Caveats:\r\n *     - namespace prefixes aren't resolved in XPathEvaluator.createExpression,\r\n *       but in XPathExpression.evaluate.\r\n *     - XPathResult.invalidIteratorState is not implemented.\r\n *\r\n * Revision 17: October 25, 2005\r\n *   Some core XPath function fixes and a patch to avoid crashing certain\r\n *   versions of MSXML in PathExpr.prototype.getOwnerElement, thanks to\r\n *   Sébastien Cramatte <contact (at) zeninteractif.com>.\r\n *\r\n * Revision 16: September 22, 2005\r\n *   Workarounds for some IE 5.5 deficiencies.\r\n *   Fixed problem with prefix node tests on attribute nodes.\r\n *\r\n * Revision 15: May 21, 2005\r\n *   Fixed problem with QName node tests on elements with an xmlns=\"...\".\r\n *\r\n * Revision 14: May 19, 2005\r\n *   Fixed QName node tests on attribute node regression.\r\n *\r\n * Revision 13: May 3, 2005\r\n *   Node tests are case insensitive now if working in an HTML DOM.\r\n *\r\n * Revision 12: April 26, 2005\r\n *   Updated licence.  Slight code changes to enable use of Dean\r\n *   Edwards' script compression, http://dean.edwards.name/packer/ .\r\n *\r\n * Revision 11: April 23, 2005\r\n *   Fixed bug with 'and' and 'or' operators, fix thanks to\r\n *   Sandy McArthur <sandy (at) mcarthur.org>.\r\n *\r\n * Revision 10: April 15, 2005\r\n *   Added support for a virtual root node, supposedly helpful for\r\n *   implementing XForms.  Fixed problem with QName node tests and\r\n *   the parent axis.\r\n *\r\n * Revision 9: March 17, 2005\r\n *   Namespace resolver tweaked so using the document node as the context\r\n *   for namespace lookups is equivalent to using the document element.\r\n *\r\n * Revision 8: February 13, 2005\r\n *   Handle implicit declaration of 'xmlns' namespace prefix.\r\n *   Fixed bug when comparing nodesets.\r\n *   Instance data can now be associated with a FunctionResolver, and\r\n *     workaround for MSXML not supporting 'localName' and 'getElementById',\r\n *     thanks to Grant Gongaware.\r\n *   Fix a few problems when the context node is the root node.\r\n *   \r\n * Revision 7: February 11, 2005\r\n *   Default namespace resolver fix from Grant Gongaware\r\n *   <grant (at) gongaware.com>.\r\n *\r\n * Revision 6: February 10, 2005\r\n *   Fixed bug in 'number' function.\r\n *\r\n * Revision 5: February 9, 2005\r\n *   Fixed bug where text nodes not getting converted to string values.\r\n *\r\n * Revision 4: January 21, 2005\r\n *   Bug in 'name' function, fix thanks to Bill Edney.\r\n *   Fixed incorrect processing of namespace nodes.\r\n *   Fixed NamespaceResolver to resolve 'xml' namespace.\r\n *   Implemented union '|' operator.\r\n *\r\n * Revision 3: January 14, 2005\r\n *   Fixed bug with nodeset comparisons, bug lexing < and >.\r\n *\r\n * Revision 2: October 26, 2004\r\n *   QName node test namespace handling fixed.  Few other bug fixes.\r\n *   \r\n * Revision 1: August 13, 2004\r\n *   Bug fixes from William J. Edney <bedney (at) technicalpursuit.com>.\r\n *   Added minimal licence.\r\n *\r\n * Initial version: June 14, 2004\r\n */\n// XPathParser ///////////////////////////////////////////////////////////////\nXPathParser.prototype = new Object();\nXPathParser.prototype.constructor = XPathParser;\nXPathParser.superclass = Object.prototype;\n\nfunction XPathParser() {\n  this.init();\n}\n\nXPathParser.prototype.init = function () {\n  this.reduceActions = [];\n\n  this.reduceActions[3] = function (rhs) {\n    return new OrOperation(rhs[0], rhs[2]);\n  };\n\n  this.reduceActions[5] = function (rhs) {\n    return new AndOperation(rhs[0], rhs[2]);\n  };\n\n  this.reduceActions[7] = function (rhs) {\n    return new EqualsOperation(rhs[0], rhs[2]);\n  };\n\n  this.reduceActions[8] = function (rhs) {\n    return new NotEqualOperation(rhs[0], rhs[2]);\n  };\n\n  this.reduceActions[10] = function (rhs) {\n    return new LessThanOperation(rhs[0], rhs[2]);\n  };\n\n  this.reduceActions[11] = function (rhs) {\n    return new GreaterThanOperation(rhs[0], rhs[2]);\n  };\n\n  this.reduceActions[12] = function (rhs) {\n    return new LessThanOrEqualOperation(rhs[0], rhs[2]);\n  };\n\n  this.reduceActions[13] = function (rhs) {\n    return new GreaterThanOrEqualOperation(rhs[0], rhs[2]);\n  };\n\n  this.reduceActions[15] = function (rhs) {\n    return new PlusOperation(rhs[0], rhs[2]);\n  };\n\n  this.reduceActions[16] = function (rhs) {\n    return new MinusOperation(rhs[0], rhs[2]);\n  };\n\n  this.reduceActions[18] = function (rhs) {\n    return new MultiplyOperation(rhs[0], rhs[2]);\n  };\n\n  this.reduceActions[19] = function (rhs) {\n    return new DivOperation(rhs[0], rhs[2]);\n  };\n\n  this.reduceActions[20] = function (rhs) {\n    return new ModOperation(rhs[0], rhs[2]);\n  };\n\n  this.reduceActions[22] = function (rhs) {\n    return new UnaryMinusOperation(rhs[1]);\n  };\n\n  this.reduceActions[24] = function (rhs) {\n    return new BarOperation(rhs[0], rhs[2]);\n  };\n\n  this.reduceActions[25] = function (rhs) {\n    return new PathExpr(undefined, undefined, rhs[0]);\n  };\n\n  this.reduceActions[27] = function (rhs) {\n    rhs[0].locationPath = rhs[2];\n    return rhs[0];\n  };\n\n  this.reduceActions[28] = function (rhs) {\n    rhs[0].locationPath = rhs[2];\n    rhs[0].locationPath.steps.unshift(new Step(Step.DESCENDANTORSELF, new NodeTest(NodeTest.NODE, undefined), []));\n    return rhs[0];\n  };\n\n  this.reduceActions[29] = function (rhs) {\n    return new PathExpr(rhs[0], [], undefined);\n  };\n\n  this.reduceActions[30] = function (rhs) {\n    if (Utilities.instance_of(rhs[0], PathExpr)) {\n      if (rhs[0].filterPredicates == undefined) {\n        rhs[0].filterPredicates = [];\n      }\n\n      rhs[0].filterPredicates.push(rhs[1]);\n      return rhs[0];\n    } else {\n      return new PathExpr(rhs[0], [rhs[1]], undefined);\n    }\n  };\n\n  this.reduceActions[32] = function (rhs) {\n    return rhs[1];\n  };\n\n  this.reduceActions[33] = function (rhs) {\n    return new XString(rhs[0]);\n  };\n\n  this.reduceActions[34] = function (rhs) {\n    return new XNumber(rhs[0]);\n  };\n\n  this.reduceActions[36] = function (rhs) {\n    return new FunctionCall(rhs[0], []);\n  };\n\n  this.reduceActions[37] = function (rhs) {\n    return new FunctionCall(rhs[0], rhs[2]);\n  };\n\n  this.reduceActions[38] = function (rhs) {\n    return [rhs[0]];\n  };\n\n  this.reduceActions[39] = function (rhs) {\n    rhs[2].unshift(rhs[0]);\n    return rhs[2];\n  };\n\n  this.reduceActions[43] = function (rhs) {\n    return new LocationPath(true, []);\n  };\n\n  this.reduceActions[44] = function (rhs) {\n    rhs[1].absolute = true;\n    return rhs[1];\n  };\n\n  this.reduceActions[46] = function (rhs) {\n    return new LocationPath(false, [rhs[0]]);\n  };\n\n  this.reduceActions[47] = function (rhs) {\n    rhs[0].steps.push(rhs[2]);\n    return rhs[0];\n  };\n\n  this.reduceActions[49] = function (rhs) {\n    return new Step(rhs[0], rhs[1], []);\n  };\n\n  this.reduceActions[50] = function (rhs) {\n    return new Step(Step.CHILD, rhs[0], []);\n  };\n\n  this.reduceActions[51] = function (rhs) {\n    return new Step(rhs[0], rhs[1], rhs[2]);\n  };\n\n  this.reduceActions[52] = function (rhs) {\n    return new Step(Step.CHILD, rhs[0], rhs[1]);\n  };\n\n  this.reduceActions[54] = function (rhs) {\n    return [rhs[0]];\n  };\n\n  this.reduceActions[55] = function (rhs) {\n    rhs[1].unshift(rhs[0]);\n    return rhs[1];\n  };\n\n  this.reduceActions[56] = function (rhs) {\n    if (rhs[0] == \"ancestor\") {\n      return Step.ANCESTOR;\n    } else if (rhs[0] == \"ancestor-or-self\") {\n      return Step.ANCESTORORSELF;\n    } else if (rhs[0] == \"attribute\") {\n      return Step.ATTRIBUTE;\n    } else if (rhs[0] == \"child\") {\n      return Step.CHILD;\n    } else if (rhs[0] == \"descendant\") {\n      return Step.DESCENDANT;\n    } else if (rhs[0] == \"descendant-or-self\") {\n      return Step.DESCENDANTORSELF;\n    } else if (rhs[0] == \"following\") {\n      return Step.FOLLOWING;\n    } else if (rhs[0] == \"following-sibling\") {\n      return Step.FOLLOWINGSIBLING;\n    } else if (rhs[0] == \"namespace\") {\n      return Step.NAMESPACE;\n    } else if (rhs[0] == \"parent\") {\n      return Step.PARENT;\n    } else if (rhs[0] == \"preceding\") {\n      return Step.PRECEDING;\n    } else if (rhs[0] == \"preceding-sibling\") {\n      return Step.PRECEDINGSIBLING;\n    } else if (rhs[0] == \"self\") {\n      return Step.SELF;\n    }\n\n    return -1;\n  };\n\n  this.reduceActions[57] = function (rhs) {\n    return Step.ATTRIBUTE;\n  };\n\n  this.reduceActions[59] = function (rhs) {\n    if (rhs[0] == \"comment\") {\n      return new NodeTest(NodeTest.COMMENT, undefined);\n    } else if (rhs[0] == \"text\") {\n      return new NodeTest(NodeTest.TEXT, undefined);\n    } else if (rhs[0] == \"processing-instruction\") {\n      return new NodeTest(NodeTest.PI, undefined);\n    } else if (rhs[0] == \"node\") {\n      return new NodeTest(NodeTest.NODE, undefined);\n    }\n\n    return new NodeTest(-1, undefined);\n  };\n\n  this.reduceActions[60] = function (rhs) {\n    return new NodeTest(NodeTest.PI, rhs[2]);\n  };\n\n  this.reduceActions[61] = function (rhs) {\n    return rhs[1];\n  };\n\n  this.reduceActions[63] = function (rhs) {\n    rhs[1].absolute = true;\n    rhs[1].steps.unshift(new Step(Step.DESCENDANTORSELF, new NodeTest(NodeTest.NODE, undefined), []));\n    return rhs[1];\n  };\n\n  this.reduceActions[64] = function (rhs) {\n    rhs[0].steps.push(new Step(Step.DESCENDANTORSELF, new NodeTest(NodeTest.NODE, undefined), []));\n    rhs[0].steps.push(rhs[2]);\n    return rhs[0];\n  };\n\n  this.reduceActions[65] = function (rhs) {\n    return new Step(Step.SELF, new NodeTest(NodeTest.NODE, undefined), []);\n  };\n\n  this.reduceActions[66] = function (rhs) {\n    return new Step(Step.PARENT, new NodeTest(NodeTest.NODE, undefined), []);\n  };\n\n  this.reduceActions[67] = function (rhs) {\n    return new VariableReference(rhs[1]);\n  };\n\n  this.reduceActions[68] = function (rhs) {\n    return new NodeTest(NodeTest.NAMETESTANY, undefined);\n  };\n\n  this.reduceActions[69] = function (rhs) {\n    var prefix = rhs[0].substring(0, rhs[0].indexOf(\":\"));\n    return new NodeTest(NodeTest.NAMETESTPREFIXANY, prefix);\n  };\n\n  this.reduceActions[70] = function (rhs) {\n    return new NodeTest(NodeTest.NAMETESTQNAME, rhs[0]);\n  };\n};\n\nXPathParser.actionTable = [\" s s        sssssssss    s ss  s  ss\", \"                 s                  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"                rrrrr               \", \" s s        sssssssss    s ss  s  ss\", \"rs  rrrrrrrr s  sssssrrrrrr  rrs rs \", \" s s        sssssssss    s ss  s  ss\", \"                            s       \", \"                            s       \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"  s                                 \", \"                            s       \", \" s           s  sssss          s  s \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"a                                   \", \"r       s                    rr  r  \", \"r      sr                    rr  r  \", \"r   s  rr            s       rr  r  \", \"r   rssrr            rss     rr  r  \", \"r   rrrrr            rrrss   rr  r  \", \"r   rrrrrsss         rrrrr   rr  r  \", \"r   rrrrrrrr         rrrrr   rr  r  \", \"r   rrrrrrrr         rrrrrs  rr  r  \", \"r   rrrrrrrr         rrrrrr  rr  r  \", \"r   rrrrrrrr         rrrrrr  rr  r  \", \"r  srrrrrrrr         rrrrrrs rr sr  \", \"r  srrrrrrrr         rrrrrrs rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r   rrrrrrrr         rrrrrr  rr  r  \", \"r   rrrrrrrr         rrrrrr  rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"                sssss               \", \"r  rrrrrrrrr         rrrrrrr rr sr  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"                             s      \", \"r  srrrrrrrr         rrrrrrs rr  r  \", \"r   rrrrrrrr         rrrrr   rr  r  \", \"              s                     \", \"                             s      \", \"                rrrrr               \", \" s s        sssssssss    s sss s  ss\", \"r  srrrrrrrr         rrrrrrs rr  r  \", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss      ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s           s  sssss          s  s \", \" s           s  sssss          s  s \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \" s           s  sssss          s  s \", \" s           s  sssss          s  s \", \"r  rrrrrrrrr         rrrrrrr rr sr  \", \"r  rrrrrrrrr         rrrrrrr rr sr  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"                             s      \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"                             rr     \", \"                             s      \", \"                             rs     \", \"r      sr                    rr  r  \", \"r   s  rr            s       rr  r  \", \"r   rssrr            rss     rr  r  \", \"r   rssrr            rss     rr  r  \", \"r   rrrrr            rrrss   rr  r  \", \"r   rrrrr            rrrss   rr  r  \", \"r   rrrrr            rrrss   rr  r  \", \"r   rrrrr            rrrss   rr  r  \", \"r   rrrrrsss         rrrrr   rr  r  \", \"r   rrrrrsss         rrrrr   rr  r  \", \"r   rrrrrrrr         rrrrr   rr  r  \", \"r   rrrrrrrr         rrrrr   rr  r  \", \"r   rrrrrrrr         rrrrr   rr  r  \", \"r   rrrrrrrr         rrrrrr  rr  r  \", \"                                 r  \", \"                                 s  \", \"r  srrrrrrrr         rrrrrrs rr  r  \", \"r  srrrrrrrr         rrrrrrs rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \" s s        sssssssss    s ss  s  ss\", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"                             r      \"];\nXPathParser.actionTableNumber = [\" 1 0        /.-,+*)('    & %$  #  \\\"!\", \"                 J                  \", \"a  aaaaaaaaa         aaaaaaa aa  a  \", \"                YYYYY               \", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \"K1  KKKKKKKK .  +*)('KKKKKK  KK# K\\\" \", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \"                            N       \", \"                            O       \", \"e  eeeeeeeee         eeeeeee ee ee  \", \"f  fffffffff         fffffff ff ff  \", \"d  ddddddddd         ddddddd dd dd  \", \"B  BBBBBBBBB         BBBBBBB BB BB  \", \"A  AAAAAAAAA         AAAAAAA AA AA  \", \"  P                                 \", \"                            Q       \", \" 1           .  +*)('          #  \\\" \", \"b  bbbbbbbbb         bbbbbbb bb  b  \", \"                                    \", \"!       S                    !!  !  \", \"\\\"      T\\\"                    \\\"\\\"  \\\"  \", \"$   V  $$            U       $$  $  \", \"&   &ZY&&            &XW     &&  &  \", \")   )))))            )))\\\\[   ))  )  \", \".   ....._^]         .....   ..  .  \", \"1   11111111         11111   11  1  \", \"5   55555555         55555`  55  5  \", \"7   77777777         777777  77  7  \", \"9   99999999         999999  99  9  \", \":  c::::::::         ::::::b :: a:  \", \"I  fIIIIIIII         IIIIIIe II  I  \", \"=  =========         ======= == ==  \", \"?  ?????????         ??????? ?? ??  \", \"C  CCCCCCCCC         CCCCCCC CC CC  \", \"J   JJJJJJJJ         JJJJJJ  JJ  J  \", \"M   MMMMMMMM         MMMMMM  MM  M  \", \"N  NNNNNNNNN         NNNNNNN NN  N  \", \"P  PPPPPPPPP         PPPPPPP PP  P  \", \"                +*)('               \", \"R  RRRRRRRRR         RRRRRRR RR aR  \", \"U  UUUUUUUUU         UUUUUUU UU  U  \", \"Z  ZZZZZZZZZ         ZZZZZZZ ZZ ZZ  \", \"c  ccccccccc         ccccccc cc cc  \", \"                             j      \", \"L  fLLLLLLLL         LLLLLLe LL  L  \", \"6   66666666         66666   66  6  \", \"              k                     \", \"                             l      \", \"                XXXXX               \", \" 1 0        /.-,+*)('    & %$m #  \\\"!\", \"_  f________         ______e __  _  \", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('      %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1           .  +*)('          #  \\\" \", \" 1           .  +*)('          #  \\\" \", \">  >>>>>>>>>         >>>>>>> >> >>  \", \" 1           .  +*)('          #  \\\" \", \" 1           .  +*)('          #  \\\" \", \"Q  QQQQQQQQQ         QQQQQQQ QQ aQ  \", \"V  VVVVVVVVV         VVVVVVV VV aV  \", \"T  TTTTTTTTT         TTTTTTT TT  T  \", \"@  @@@@@@@@@         @@@@@@@ @@ @@  \", \"                             \\x87      \", \"[  [[[[[[[[[         [[[[[[[ [[ [[  \", \"D  DDDDDDDDD         DDDDDDD DD DD  \", \"                             HH     \", \"                             \\x88      \", \"                             F\\x89     \", \"#      T#                    ##  #  \", \"%   V  %%            U       %%  %  \", \"'   'ZY''            'XW     ''  '  \", \"(   (ZY((            (XW     ((  (  \", \"+   +++++            +++\\\\[   ++  +  \", \"*   *****            ***\\\\[   **  *  \", \"-   -----            ---\\\\[   --  -  \", \",   ,,,,,            ,,,\\\\[   ,,  ,  \", \"0   00000_^]         00000   00  0  \", \"/   /////_^]         /////   //  /  \", \"2   22222222         22222   22  2  \", \"3   33333333         33333   33  3  \", \"4   44444444         44444   44  4  \", \"8   88888888         888888  88  8  \", \"                                 ^  \", \"                                 \\x8a  \", \";  f;;;;;;;;         ;;;;;;e ;;  ;  \", \"<  f<<<<<<<<         <<<<<<e <<  <  \", \"O  OOOOOOOOO         OOOOOOO OO  O  \", \"`  `````````         ``````` ``  `  \", \"S  SSSSSSSSS         SSSSSSS SS  S  \", \"W  WWWWWWWWW         WWWWWWW WW  W  \", \"\\\\  \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\         \\\\\\\\\\\\\\\\\\\\\\\\\\\\ \\\\\\\\ \\\\\\\\  \", \"E  EEEEEEEEE         EEEEEEE EE EE  \", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \"]  ]]]]]]]]]         ]]]]]]] ]] ]]  \", \"                             G      \"];\nXPathParser.gotoTable = [\"3456789:;<=>?@ AB  CDEFGH IJ \", \"                             \", \"                             \", \"                             \", \"L456789:;<=>?@ AB  CDEFGH IJ \", \"            M        EFGH IJ \", \"       N;<=>?@ AB  CDEFGH IJ \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"            S        EFGH IJ \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"              e              \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                        h  J \", \"              i          j   \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"o456789:;<=>?@ ABpqCDEFGH IJ \", \"                             \", \"  r6789:;<=>?@ AB  CDEFGH IJ \", \"   s789:;<=>?@ AB  CDEFGH IJ \", \"    t89:;<=>?@ AB  CDEFGH IJ \", \"    u89:;<=>?@ AB  CDEFGH IJ \", \"     v9:;<=>?@ AB  CDEFGH IJ \", \"     w9:;<=>?@ AB  CDEFGH IJ \", \"     x9:;<=>?@ AB  CDEFGH IJ \", \"     y9:;<=>?@ AB  CDEFGH IJ \", \"      z:;<=>?@ AB  CDEFGH IJ \", \"      {:;<=>?@ AB  CDEFGH IJ \", \"       |;<=>?@ AB  CDEFGH IJ \", \"       };<=>?@ AB  CDEFGH IJ \", \"       ~;<=>?@ AB  CDEFGH IJ \", \"         \\x7f=>?@ AB  CDEFGH IJ \", \"\\x80456789:;<=>?@ AB  CDEFGH IJ\\x81\", \"            \\x82        EFGH IJ \", \"            \\x83        EFGH IJ \", \"                             \", \"                     \\x84 GH IJ \", \"                     \\x85 GH IJ \", \"              i          \\x86   \", \"              i          \\x87   \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"o456789:;<=>?@ AB\\x8cqCDEFGH IJ \", \"                             \", \"                             \"];\nXPathParser.productions = [[1, 1, 2], [2, 1, 3], [3, 1, 4], [3, 3, 3, -9, 4], [4, 1, 5], [4, 3, 4, -8, 5], [5, 1, 6], [5, 3, 5, -22, 6], [5, 3, 5, -5, 6], [6, 1, 7], [6, 3, 6, -23, 7], [6, 3, 6, -24, 7], [6, 3, 6, -6, 7], [6, 3, 6, -7, 7], [7, 1, 8], [7, 3, 7, -25, 8], [7, 3, 7, -26, 8], [8, 1, 9], [8, 3, 8, -12, 9], [8, 3, 8, -11, 9], [8, 3, 8, -10, 9], [9, 1, 10], [9, 2, -26, 9], [10, 1, 11], [10, 3, 10, -27, 11], [11, 1, 12], [11, 1, 13], [11, 3, 13, -28, 14], [11, 3, 13, -4, 14], [13, 1, 15], [13, 2, 13, 16], [15, 1, 17], [15, 3, -29, 2, -30], [15, 1, -15], [15, 1, -16], [15, 1, 18], [18, 3, -13, -29, -30], [18, 4, -13, -29, 19, -30], [19, 1, 20], [19, 3, 20, -31, 19], [20, 1, 2], [12, 1, 14], [12, 1, 21], [21, 1, -28], [21, 2, -28, 14], [21, 1, 22], [14, 1, 23], [14, 3, 14, -28, 23], [14, 1, 24], [23, 2, 25, 26], [23, 1, 26], [23, 3, 25, 26, 27], [23, 2, 26, 27], [23, 1, 28], [27, 1, 16], [27, 2, 16, 27], [25, 2, -14, -3], [25, 1, -32], [26, 1, 29], [26, 3, -20, -29, -30], [26, 4, -21, -29, -15, -30], [16, 3, -33, 30, -34], [30, 1, 2], [22, 2, -4, 14], [24, 3, 14, -4, 23], [28, 1, -35], [28, 1, -2], [17, 2, -36, -18], [29, 1, -17], [29, 1, -19], [29, 1, -18]];\nXPathParser.DOUBLEDOT = 2;\nXPathParser.DOUBLECOLON = 3;\nXPathParser.DOUBLESLASH = 4;\nXPathParser.NOTEQUAL = 5;\nXPathParser.LESSTHANOREQUAL = 6;\nXPathParser.GREATERTHANOREQUAL = 7;\nXPathParser.AND = 8;\nXPathParser.OR = 9;\nXPathParser.MOD = 10;\nXPathParser.DIV = 11;\nXPathParser.MULTIPLYOPERATOR = 12;\nXPathParser.FUNCTIONNAME = 13;\nXPathParser.AXISNAME = 14;\nXPathParser.LITERAL = 15;\nXPathParser.NUMBER = 16;\nXPathParser.ASTERISKNAMETEST = 17;\nXPathParser.QNAME = 18;\nXPathParser.NCNAMECOLONASTERISK = 19;\nXPathParser.NODETYPE = 20;\nXPathParser.PROCESSINGINSTRUCTIONWITHLITERAL = 21;\nXPathParser.EQUALS = 22;\nXPathParser.LESSTHAN = 23;\nXPathParser.GREATERTHAN = 24;\nXPathParser.PLUS = 25;\nXPathParser.MINUS = 26;\nXPathParser.BAR = 27;\nXPathParser.SLASH = 28;\nXPathParser.LEFTPARENTHESIS = 29;\nXPathParser.RIGHTPARENTHESIS = 30;\nXPathParser.COMMA = 31;\nXPathParser.AT = 32;\nXPathParser.LEFTBRACKET = 33;\nXPathParser.RIGHTBRACKET = 34;\nXPathParser.DOT = 35;\nXPathParser.DOLLAR = 36;\n\nXPathParser.prototype.tokenize = function (s1) {\n  var types = [];\n  var values = [];\n  var s = s1 + '\\0';\n  var pos = 0;\n  var c = s.charAt(pos++);\n\n  while (1) {\n    while (c == ' ' || c == '\\t' || c == '\\r' || c == '\\n') {\n      c = s.charAt(pos++);\n    }\n\n    if (c == '\\0' || pos >= s.length) {\n      break;\n    }\n\n    if (c == '(') {\n      types.push(XPathParser.LEFTPARENTHESIS);\n      values.push(c);\n      c = s.charAt(pos++);\n      continue;\n    }\n\n    if (c == ')') {\n      types.push(XPathParser.RIGHTPARENTHESIS);\n      values.push(c);\n      c = s.charAt(pos++);\n      continue;\n    }\n\n    if (c == '[') {\n      types.push(XPathParser.LEFTBRACKET);\n      values.push(c);\n      c = s.charAt(pos++);\n      continue;\n    }\n\n    if (c == ']') {\n      types.push(XPathParser.RIGHTBRACKET);\n      values.push(c);\n      c = s.charAt(pos++);\n      continue;\n    }\n\n    if (c == '@') {\n      types.push(XPathParser.AT);\n      values.push(c);\n      c = s.charAt(pos++);\n      continue;\n    }\n\n    if (c == ',') {\n      types.push(XPathParser.COMMA);\n      values.push(c);\n      c = s.charAt(pos++);\n      continue;\n    }\n\n    if (c == '|') {\n      types.push(XPathParser.BAR);\n      values.push(c);\n      c = s.charAt(pos++);\n      continue;\n    }\n\n    if (c == '+') {\n      types.push(XPathParser.PLUS);\n      values.push(c);\n      c = s.charAt(pos++);\n      continue;\n    }\n\n    if (c == '-') {\n      types.push(XPathParser.MINUS);\n      values.push(c);\n      c = s.charAt(pos++);\n      continue;\n    }\n\n    if (c == '=') {\n      types.push(XPathParser.EQUALS);\n      values.push(c);\n      c = s.charAt(pos++);\n      continue;\n    }\n\n    if (c == '$') {\n      types.push(XPathParser.DOLLAR);\n      values.push(c);\n      c = s.charAt(pos++);\n      continue;\n    }\n\n    if (c == '.') {\n      c = s.charAt(pos++);\n\n      if (c == '.') {\n        types.push(XPathParser.DOUBLEDOT);\n        values.push(\"..\");\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      if (c >= '0' && c <= '9') {\n        var number = \".\" + c;\n        c = s.charAt(pos++);\n\n        while (c >= '0' && c <= '9') {\n          number += c;\n          c = s.charAt(pos++);\n        }\n\n        types.push(XPathParser.NUMBER);\n        values.push(number);\n        continue;\n      }\n\n      types.push(XPathParser.DOT);\n      values.push('.');\n      continue;\n    }\n\n    if (c == '\\'' || c == '\"') {\n      var delimiter = c;\n      var literal = \"\";\n\n      while ((c = s.charAt(pos++)) != delimiter) {\n        literal += c;\n      }\n\n      types.push(XPathParser.LITERAL);\n      values.push(literal);\n      c = s.charAt(pos++);\n      continue;\n    }\n\n    if (c >= '0' && c <= '9') {\n      var number = c;\n      c = s.charAt(pos++);\n\n      while (c >= '0' && c <= '9') {\n        number += c;\n        c = s.charAt(pos++);\n      }\n\n      if (c == '.') {\n        if (s.charAt(pos) >= '0' && s.charAt(pos) <= '9') {\n          number += c;\n          number += s.charAt(pos++);\n          c = s.charAt(pos++);\n\n          while (c >= '0' && c <= '9') {\n            number += c;\n            c = s.charAt(pos++);\n          }\n        }\n      }\n\n      types.push(XPathParser.NUMBER);\n      values.push(number);\n      continue;\n    }\n\n    if (c == '*') {\n      if (types.length > 0) {\n        var last = types[types.length - 1];\n\n        if (last != XPathParser.AT && last != XPathParser.DOUBLECOLON && last != XPathParser.LEFTPARENTHESIS && last != XPathParser.LEFTBRACKET && last != XPathParser.AND && last != XPathParser.OR && last != XPathParser.MOD && last != XPathParser.DIV && last != XPathParser.MULTIPLYOPERATOR && last != XPathParser.SLASH && last != XPathParser.DOUBLESLASH && last != XPathParser.BAR && last != XPathParser.PLUS && last != XPathParser.MINUS && last != XPathParser.EQUALS && last != XPathParser.NOTEQUAL && last != XPathParser.LESSTHAN && last != XPathParser.LESSTHANOREQUAL && last != XPathParser.GREATERTHAN && last != XPathParser.GREATERTHANOREQUAL) {\n          types.push(XPathParser.MULTIPLYOPERATOR);\n          values.push(c);\n          c = s.charAt(pos++);\n          continue;\n        }\n      }\n\n      types.push(XPathParser.ASTERISKNAMETEST);\n      values.push(c);\n      c = s.charAt(pos++);\n      continue;\n    }\n\n    if (c == ':') {\n      if (s.charAt(pos) == ':') {\n        types.push(XPathParser.DOUBLECOLON);\n        values.push(\"::\");\n        pos++;\n        c = s.charAt(pos++);\n        continue;\n      }\n    }\n\n    if (c == '/') {\n      c = s.charAt(pos++);\n\n      if (c == '/') {\n        types.push(XPathParser.DOUBLESLASH);\n        values.push(\"//\");\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      types.push(XPathParser.SLASH);\n      values.push('/');\n      continue;\n    }\n\n    if (c == '!') {\n      if (s.charAt(pos) == '=') {\n        types.push(XPathParser.NOTEQUAL);\n        values.push(\"!=\");\n        pos++;\n        c = s.charAt(pos++);\n        continue;\n      }\n    }\n\n    if (c == '<') {\n      if (s.charAt(pos) == '=') {\n        types.push(XPathParser.LESSTHANOREQUAL);\n        values.push(\"<=\");\n        pos++;\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      types.push(XPathParser.LESSTHAN);\n      values.push('<');\n      c = s.charAt(pos++);\n      continue;\n    }\n\n    if (c == '>') {\n      if (s.charAt(pos) == '=') {\n        types.push(XPathParser.GREATERTHANOREQUAL);\n        values.push(\">=\");\n        pos++;\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      types.push(XPathParser.GREATERTHAN);\n      values.push('>');\n      c = s.charAt(pos++);\n      continue;\n    }\n\n    if (c == '_' || Utilities.isLetter(c.charCodeAt(0))) {\n      var name = c;\n      c = s.charAt(pos++);\n\n      while (Utilities.isNCNameChar(c.charCodeAt(0))) {\n        name += c;\n        c = s.charAt(pos++);\n      }\n\n      if (types.length > 0) {\n        var last = types[types.length - 1];\n\n        if (last != XPathParser.AT && last != XPathParser.DOUBLECOLON && last != XPathParser.LEFTPARENTHESIS && last != XPathParser.LEFTBRACKET && last != XPathParser.AND && last != XPathParser.OR && last != XPathParser.MOD && last != XPathParser.DIV && last != XPathParser.MULTIPLYOPERATOR && last != XPathParser.SLASH && last != XPathParser.DOUBLESLASH && last != XPathParser.BAR && last != XPathParser.PLUS && last != XPathParser.MINUS && last != XPathParser.EQUALS && last != XPathParser.NOTEQUAL && last != XPathParser.LESSTHAN && last != XPathParser.LESSTHANOREQUAL && last != XPathParser.GREATERTHAN && last != XPathParser.GREATERTHANOREQUAL) {\n          if (name == \"and\") {\n            types.push(XPathParser.AND);\n            values.push(name);\n            continue;\n          }\n\n          if (name == \"or\") {\n            types.push(XPathParser.OR);\n            values.push(name);\n            continue;\n          }\n\n          if (name == \"mod\") {\n            types.push(XPathParser.MOD);\n            values.push(name);\n            continue;\n          }\n\n          if (name == \"div\") {\n            types.push(XPathParser.DIV);\n            values.push(name);\n            continue;\n          }\n        }\n      }\n\n      if (c == ':') {\n        if (s.charAt(pos) == '*') {\n          types.push(XPathParser.NCNAMECOLONASTERISK);\n          values.push(name + \":*\");\n          pos++;\n          c = s.charAt(pos++);\n          continue;\n        }\n\n        if (s.charAt(pos) == '_' || Utilities.isLetter(s.charCodeAt(pos))) {\n          name += ':';\n          c = s.charAt(pos++);\n\n          while (Utilities.isNCNameChar(c.charCodeAt(0))) {\n            name += c;\n            c = s.charAt(pos++);\n          }\n\n          if (c == '(') {\n            types.push(XPathParser.FUNCTIONNAME);\n            values.push(name);\n            continue;\n          }\n\n          types.push(XPathParser.QNAME);\n          values.push(name);\n          continue;\n        }\n\n        if (s.charAt(pos) == ':') {\n          types.push(XPathParser.AXISNAME);\n          values.push(name);\n          continue;\n        }\n      }\n\n      if (c == '(') {\n        if (name == \"comment\" || name == \"text\" || name == \"node\") {\n          types.push(XPathParser.NODETYPE);\n          values.push(name);\n          continue;\n        }\n\n        if (name == \"processing-instruction\") {\n          if (s.charAt(pos) == ')') {\n            types.push(XPathParser.NODETYPE);\n          } else {\n            types.push(XPathParser.PROCESSINGINSTRUCTIONWITHLITERAL);\n          }\n\n          values.push(name);\n          continue;\n        }\n\n        types.push(XPathParser.FUNCTIONNAME);\n        values.push(name);\n        continue;\n      }\n\n      types.push(XPathParser.QNAME);\n      values.push(name);\n      continue;\n    }\n\n    throw new Error(\"Unexpected character \" + c);\n  }\n\n  types.push(1);\n  values.push(\"[EOF]\");\n  return [types, values];\n};\n\nXPathParser.SHIFT = 's';\nXPathParser.REDUCE = 'r';\nXPathParser.ACCEPT = 'a';\n\nXPathParser.prototype.parse = function (s) {\n  var types;\n  var values;\n  var res = this.tokenize(s);\n\n  if (res == undefined) {\n    return undefined;\n  }\n\n  types = res[0];\n  values = res[1];\n  var tokenPos = 0;\n  var state = [];\n  var tokenType = [];\n  var tokenValue = [];\n  var s;\n  var a;\n  var t;\n  state.push(0);\n  tokenType.push(1);\n  tokenValue.push(\"_S\");\n  a = types[tokenPos];\n  t = values[tokenPos++];\n\n  while (1) {\n    s = state[state.length - 1];\n\n    switch (XPathParser.actionTable[s].charAt(a - 1)) {\n      case XPathParser.SHIFT:\n        tokenType.push(-a);\n        tokenValue.push(t);\n        state.push(XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32);\n        a = types[tokenPos];\n        t = values[tokenPos++];\n        break;\n\n      case XPathParser.REDUCE:\n        var num = XPathParser.productions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32][1];\n        var rhs = [];\n\n        for (var i = 0; i < num; i++) {\n          tokenType.pop();\n          rhs.unshift(tokenValue.pop());\n          state.pop();\n        }\n\n        var s_ = state[state.length - 1];\n        tokenType.push(XPathParser.productions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32][0]);\n\n        if (this.reduceActions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32] == undefined) {\n          tokenValue.push(rhs[0]);\n        } else {\n          tokenValue.push(this.reduceActions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32](rhs));\n        }\n\n        state.push(XPathParser.gotoTable[s_].charCodeAt(XPathParser.productions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32][0] - 2) - 33);\n        break;\n\n      case XPathParser.ACCEPT:\n        return new XPath(tokenValue.pop());\n\n      default:\n        throw new Error(\"XPath parse error\");\n    }\n  }\n}; // XPath /////////////////////////////////////////////////////////////////////\n\n\nXPath.prototype = new Object();\nXPath.prototype.constructor = XPath;\nXPath.superclass = Object.prototype;\n\nfunction XPath(e) {\n  this.expression = e;\n}\n\nXPath.prototype.toString = function () {\n  return this.expression.toString();\n};\n\nXPath.prototype.evaluate = function (c) {\n  c.contextNode = c.expressionContextNode;\n  c.contextSize = 1;\n  c.contextPosition = 1;\n  c.caseInsensitive = false;\n\n  if (c.contextNode != null) {\n    var doc = c.contextNode;\n\n    if (doc.nodeType != 9\n    /*Node.DOCUMENT_NODE*/\n    ) {\n        doc = doc.ownerDocument;\n      }\n\n    try {\n      c.caseInsensitive = doc.implementation.hasFeature(\"HTML\", \"2.0\");\n    } catch (e) {\n      c.caseInsensitive = true;\n    }\n  }\n\n  return this.expression.evaluate(c);\n};\n\nXPath.XML_NAMESPACE_URI = \"http://www.w3.org/XML/1998/namespace\";\nXPath.XMLNS_NAMESPACE_URI = \"http://www.w3.org/2000/xmlns/\"; // Expression ////////////////////////////////////////////////////////////////\n\nExpression.prototype = new Object();\nExpression.prototype.constructor = Expression;\nExpression.superclass = Object.prototype;\n\nfunction Expression() {}\n\nExpression.prototype.init = function () {};\n\nExpression.prototype.toString = function () {\n  return \"<Expression>\";\n};\n\nExpression.prototype.evaluate = function (c) {\n  throw new Error(\"Could not evaluate expression.\");\n}; // UnaryOperation ////////////////////////////////////////////////////////////\n\n\nUnaryOperation.prototype = new Expression();\nUnaryOperation.prototype.constructor = UnaryOperation;\nUnaryOperation.superclass = Expression.prototype;\n\nfunction UnaryOperation(rhs) {\n  if (arguments.length > 0) {\n    this.init(rhs);\n  }\n}\n\nUnaryOperation.prototype.init = function (rhs) {\n  this.rhs = rhs;\n}; // UnaryMinusOperation ///////////////////////////////////////////////////////\n\n\nUnaryMinusOperation.prototype = new UnaryOperation();\nUnaryMinusOperation.prototype.constructor = UnaryMinusOperation;\nUnaryMinusOperation.superclass = UnaryOperation.prototype;\n\nfunction UnaryMinusOperation(rhs) {\n  if (arguments.length > 0) {\n    this.init(rhs);\n  }\n}\n\nUnaryMinusOperation.prototype.init = function (rhs) {\n  UnaryMinusOperation.superclass.init.call(this, rhs);\n};\n\nUnaryMinusOperation.prototype.evaluate = function (c) {\n  return this.rhs.evaluate(c).number().negate();\n};\n\nUnaryMinusOperation.prototype.toString = function () {\n  return \"-\" + this.rhs.toString();\n}; // BinaryOperation ///////////////////////////////////////////////////////////\n\n\nBinaryOperation.prototype = new Expression();\nBinaryOperation.prototype.constructor = BinaryOperation;\nBinaryOperation.superclass = Expression.prototype;\n\nfunction BinaryOperation(lhs, rhs) {\n  if (arguments.length > 0) {\n    this.init(lhs, rhs);\n  }\n}\n\nBinaryOperation.prototype.init = function (lhs, rhs) {\n  this.lhs = lhs;\n  this.rhs = rhs;\n}; // OrOperation ///////////////////////////////////////////////////////////////\n\n\nOrOperation.prototype = new BinaryOperation();\nOrOperation.prototype.constructor = OrOperation;\nOrOperation.superclass = BinaryOperation.prototype;\n\nfunction OrOperation(lhs, rhs) {\n  if (arguments.length > 0) {\n    this.init(lhs, rhs);\n  }\n}\n\nOrOperation.prototype.init = function (lhs, rhs) {\n  OrOperation.superclass.init.call(this, lhs, rhs);\n};\n\nOrOperation.prototype.toString = function () {\n  return \"(\" + this.lhs.toString() + \" or \" + this.rhs.toString() + \")\";\n};\n\nOrOperation.prototype.evaluate = function (c) {\n  var b = this.lhs.evaluate(c).bool();\n\n  if (b.booleanValue()) {\n    return b;\n  }\n\n  return this.rhs.evaluate(c).bool();\n}; // AndOperation //////////////////////////////////////////////////////////////\n\n\nAndOperation.prototype = new BinaryOperation();\nAndOperation.prototype.constructor = AndOperation;\nAndOperation.superclass = BinaryOperation.prototype;\n\nfunction AndOperation(lhs, rhs) {\n  if (arguments.length > 0) {\n    this.init(lhs, rhs);\n  }\n}\n\nAndOperation.prototype.init = function (lhs, rhs) {\n  AndOperation.superclass.init.call(this, lhs, rhs);\n};\n\nAndOperation.prototype.toString = function () {\n  return \"(\" + this.lhs.toString() + \" and \" + this.rhs.toString() + \")\";\n};\n\nAndOperation.prototype.evaluate = function (c) {\n  var b = this.lhs.evaluate(c).bool();\n\n  if (!b.booleanValue()) {\n    return b;\n  }\n\n  return this.rhs.evaluate(c).bool();\n}; // EqualsOperation ///////////////////////////////////////////////////////////\n\n\nEqualsOperation.prototype = new BinaryOperation();\nEqualsOperation.prototype.constructor = EqualsOperation;\nEqualsOperation.superclass = BinaryOperation.prototype;\n\nfunction EqualsOperation(lhs, rhs) {\n  if (arguments.length > 0) {\n    this.init(lhs, rhs);\n  }\n}\n\nEqualsOperation.prototype.init = function (lhs, rhs) {\n  EqualsOperation.superclass.init.call(this, lhs, rhs);\n};\n\nEqualsOperation.prototype.toString = function () {\n  return \"(\" + this.lhs.toString() + \" = \" + this.rhs.toString() + \")\";\n};\n\nEqualsOperation.prototype.evaluate = function (c) {\n  return this.lhs.evaluate(c).equals(this.rhs.evaluate(c));\n}; // NotEqualOperation /////////////////////////////////////////////////////////\n\n\nNotEqualOperation.prototype = new BinaryOperation();\nNotEqualOperation.prototype.constructor = NotEqualOperation;\nNotEqualOperation.superclass = BinaryOperation.prototype;\n\nfunction NotEqualOperation(lhs, rhs) {\n  if (arguments.length > 0) {\n    this.init(lhs, rhs);\n  }\n}\n\nNotEqualOperation.prototype.init = function (lhs, rhs) {\n  NotEqualOperation.superclass.init.call(this, lhs, rhs);\n};\n\nNotEqualOperation.prototype.toString = function () {\n  return \"(\" + this.lhs.toString() + \" != \" + this.rhs.toString() + \")\";\n};\n\nNotEqualOperation.prototype.evaluate = function (c) {\n  return this.lhs.evaluate(c).notequal(this.rhs.evaluate(c));\n}; // LessThanOperation /////////////////////////////////////////////////////////\n\n\nLessThanOperation.prototype = new BinaryOperation();\nLessThanOperation.prototype.constructor = LessThanOperation;\nLessThanOperation.superclass = BinaryOperation.prototype;\n\nfunction LessThanOperation(lhs, rhs) {\n  if (arguments.length > 0) {\n    this.init(lhs, rhs);\n  }\n}\n\nLessThanOperation.prototype.init = function (lhs, rhs) {\n  LessThanOperation.superclass.init.call(this, lhs, rhs);\n};\n\nLessThanOperation.prototype.evaluate = function (c) {\n  return this.lhs.evaluate(c).lessthan(this.rhs.evaluate(c));\n};\n\nLessThanOperation.prototype.toString = function () {\n  return \"(\" + this.lhs.toString() + \" < \" + this.rhs.toString() + \")\";\n}; // GreaterThanOperation //////////////////////////////////////////////////////\n\n\nGreaterThanOperation.prototype = new BinaryOperation();\nGreaterThanOperation.prototype.constructor = GreaterThanOperation;\nGreaterThanOperation.superclass = BinaryOperation.prototype;\n\nfunction GreaterThanOperation(lhs, rhs) {\n  if (arguments.length > 0) {\n    this.init(lhs, rhs);\n  }\n}\n\nGreaterThanOperation.prototype.init = function (lhs, rhs) {\n  GreaterThanOperation.superclass.init.call(this, lhs, rhs);\n};\n\nGreaterThanOperation.prototype.evaluate = function (c) {\n  return this.lhs.evaluate(c).greaterthan(this.rhs.evaluate(c));\n};\n\nGreaterThanOperation.prototype.toString = function () {\n  return \"(\" + this.lhs.toString() + \" > \" + this.rhs.toString() + \")\";\n}; // LessThanOrEqualOperation //////////////////////////////////////////////////\n\n\nLessThanOrEqualOperation.prototype = new BinaryOperation();\nLessThanOrEqualOperation.prototype.constructor = LessThanOrEqualOperation;\nLessThanOrEqualOperation.superclass = BinaryOperation.prototype;\n\nfunction LessThanOrEqualOperation(lhs, rhs) {\n  if (arguments.length > 0) {\n    this.init(lhs, rhs);\n  }\n}\n\nLessThanOrEqualOperation.prototype.init = function (lhs, rhs) {\n  LessThanOrEqualOperation.superclass.init.call(this, lhs, rhs);\n};\n\nLessThanOrEqualOperation.prototype.evaluate = function (c) {\n  return this.lhs.evaluate(c).lessthanorequal(this.rhs.evaluate(c));\n};\n\nLessThanOrEqualOperation.prototype.toString = function () {\n  return \"(\" + this.lhs.toString() + \" <= \" + this.rhs.toString() + \")\";\n}; // GreaterThanOrEqualOperation ///////////////////////////////////////////////\n\n\nGreaterThanOrEqualOperation.prototype = new BinaryOperation();\nGreaterThanOrEqualOperation.prototype.constructor = GreaterThanOrEqualOperation;\nGreaterThanOrEqualOperation.superclass = BinaryOperation.prototype;\n\nfunction GreaterThanOrEqualOperation(lhs, rhs) {\n  if (arguments.length > 0) {\n    this.init(lhs, rhs);\n  }\n}\n\nGreaterThanOrEqualOperation.prototype.init = function (lhs, rhs) {\n  GreaterThanOrEqualOperation.superclass.init.call(this, lhs, rhs);\n};\n\nGreaterThanOrEqualOperation.prototype.evaluate = function (c) {\n  return this.lhs.evaluate(c).greaterthanorequal(this.rhs.evaluate(c));\n};\n\nGreaterThanOrEqualOperation.prototype.toString = function () {\n  return \"(\" + this.lhs.toString() + \" >= \" + this.rhs.toString() + \")\";\n}; // PlusOperation /////////////////////////////////////////////////////////////\n\n\nPlusOperation.prototype = new BinaryOperation();\nPlusOperation.prototype.constructor = PlusOperation;\nPlusOperation.superclass = BinaryOperation.prototype;\n\nfunction PlusOperation(lhs, rhs) {\n  if (arguments.length > 0) {\n    this.init(lhs, rhs);\n  }\n}\n\nPlusOperation.prototype.init = function (lhs, rhs) {\n  PlusOperation.superclass.init.call(this, lhs, rhs);\n};\n\nPlusOperation.prototype.evaluate = function (c) {\n  return this.lhs.evaluate(c).number().plus(this.rhs.evaluate(c).number());\n};\n\nPlusOperation.prototype.toString = function () {\n  return \"(\" + this.lhs.toString() + \" + \" + this.rhs.toString() + \")\";\n}; // MinusOperation ////////////////////////////////////////////////////////////\n\n\nMinusOperation.prototype = new BinaryOperation();\nMinusOperation.prototype.constructor = MinusOperation;\nMinusOperation.superclass = BinaryOperation.prototype;\n\nfunction MinusOperation(lhs, rhs) {\n  if (arguments.length > 0) {\n    this.init(lhs, rhs);\n  }\n}\n\nMinusOperation.prototype.init = function (lhs, rhs) {\n  MinusOperation.superclass.init.call(this, lhs, rhs);\n};\n\nMinusOperation.prototype.evaluate = function (c) {\n  return this.lhs.evaluate(c).number().minus(this.rhs.evaluate(c).number());\n};\n\nMinusOperation.prototype.toString = function () {\n  return \"(\" + this.lhs.toString() + \" - \" + this.rhs.toString() + \")\";\n}; // MultiplyOperation /////////////////////////////////////////////////////////\n\n\nMultiplyOperation.prototype = new BinaryOperation();\nMultiplyOperation.prototype.constructor = MultiplyOperation;\nMultiplyOperation.superclass = BinaryOperation.prototype;\n\nfunction MultiplyOperation(lhs, rhs) {\n  if (arguments.length > 0) {\n    this.init(lhs, rhs);\n  }\n}\n\nMultiplyOperation.prototype.init = function (lhs, rhs) {\n  MultiplyOperation.superclass.init.call(this, lhs, rhs);\n};\n\nMultiplyOperation.prototype.evaluate = function (c) {\n  return this.lhs.evaluate(c).number().multiply(this.rhs.evaluate(c).number());\n};\n\nMultiplyOperation.prototype.toString = function () {\n  return \"(\" + this.lhs.toString() + \" * \" + this.rhs.toString() + \")\";\n}; // DivOperation //////////////////////////////////////////////////////////////\n\n\nDivOperation.prototype = new BinaryOperation();\nDivOperation.prototype.constructor = DivOperation;\nDivOperation.superclass = BinaryOperation.prototype;\n\nfunction DivOperation(lhs, rhs) {\n  if (arguments.length > 0) {\n    this.init(lhs, rhs);\n  }\n}\n\nDivOperation.prototype.init = function (lhs, rhs) {\n  DivOperation.superclass.init.call(this, lhs, rhs);\n};\n\nDivOperation.prototype.evaluate = function (c) {\n  return this.lhs.evaluate(c).number().div(this.rhs.evaluate(c).number());\n};\n\nDivOperation.prototype.toString = function () {\n  return \"(\" + this.lhs.toString() + \" div \" + this.rhs.toString() + \")\";\n}; // ModOperation //////////////////////////////////////////////////////////////\n\n\nModOperation.prototype = new BinaryOperation();\nModOperation.prototype.constructor = ModOperation;\nModOperation.superclass = BinaryOperation.prototype;\n\nfunction ModOperation(lhs, rhs) {\n  if (arguments.length > 0) {\n    this.init(lhs, rhs);\n  }\n}\n\nModOperation.prototype.init = function (lhs, rhs) {\n  ModOperation.superclass.init.call(this, lhs, rhs);\n};\n\nModOperation.prototype.evaluate = function (c) {\n  return this.lhs.evaluate(c).number().mod(this.rhs.evaluate(c).number());\n};\n\nModOperation.prototype.toString = function () {\n  return \"(\" + this.lhs.toString() + \" mod \" + this.rhs.toString() + \")\";\n}; // BarOperation //////////////////////////////////////////////////////////////\n\n\nBarOperation.prototype = new BinaryOperation();\nBarOperation.prototype.constructor = BarOperation;\nBarOperation.superclass = BinaryOperation.prototype;\n\nfunction BarOperation(lhs, rhs) {\n  if (arguments.length > 0) {\n    this.init(lhs, rhs);\n  }\n}\n\nBarOperation.prototype.init = function (lhs, rhs) {\n  BarOperation.superclass.init.call(this, lhs, rhs);\n};\n\nBarOperation.prototype.evaluate = function (c) {\n  return this.lhs.evaluate(c).nodeset().union(this.rhs.evaluate(c).nodeset());\n};\n\nBarOperation.prototype.toString = function () {\n  return this.lhs.toString() + \" | \" + this.rhs.toString();\n}; // PathExpr //////////////////////////////////////////////////////////////////\n\n\nPathExpr.prototype = new Expression();\nPathExpr.prototype.constructor = PathExpr;\nPathExpr.superclass = Expression.prototype;\n\nfunction PathExpr(filter, filterPreds, locpath) {\n  if (arguments.length > 0) {\n    this.init(filter, filterPreds, locpath);\n  }\n}\n\nPathExpr.prototype.init = function (filter, filterPreds, locpath) {\n  PathExpr.superclass.init.call(this);\n  this.filter = filter;\n  this.filterPredicates = filterPreds;\n  this.locationPath = locpath;\n};\n\nPathExpr.prototype.evaluate = function (c) {\n  var nodes;\n  var xpc = new XPathContext();\n  xpc.variableResolver = c.variableResolver;\n  xpc.functionResolver = c.functionResolver;\n  xpc.namespaceResolver = c.namespaceResolver;\n  xpc.expressionContextNode = c.expressionContextNode;\n  xpc.virtualRoot = c.virtualRoot;\n  xpc.caseInsensitive = c.caseInsensitive;\n\n  if (this.filter == null) {\n    nodes = [c.contextNode];\n  } else {\n    var ns = this.filter.evaluate(c);\n\n    if (!Utilities.instance_of(ns, XNodeSet)) {\n      if (this.filterPredicates != null && this.filterPredicates.length > 0 || this.locationPath != null) {\n        throw new Error(\"Path expression filter must evaluate to a nodset if predicates or location path are used\");\n      }\n\n      return ns;\n    }\n\n    nodes = ns.toArray();\n\n    if (this.filterPredicates != null) {\n      // apply each of the predicates in turn\n      for (var j = 0; j < this.filterPredicates.length; j++) {\n        var pred = this.filterPredicates[j];\n        var newNodes = [];\n        xpc.contextSize = nodes.length;\n\n        for (xpc.contextPosition = 1; xpc.contextPosition <= xpc.contextSize; xpc.contextPosition++) {\n          xpc.contextNode = nodes[xpc.contextPosition - 1];\n\n          if (this.predicateMatches(pred, xpc)) {\n            newNodes.push(xpc.contextNode);\n          }\n        }\n\n        nodes = newNodes;\n      }\n    }\n  }\n\n  if (this.locationPath != null) {\n    if (this.locationPath.absolute) {\n      if (nodes[0].nodeType != 9\n      /*Node.DOCUMENT_NODE*/\n      ) {\n          if (xpc.virtualRoot != null) {\n            nodes = [xpc.virtualRoot];\n          } else {\n            if (nodes[0].ownerDocument == null) {\n              // IE 5.5 doesn't have ownerDocument?\n              var n = nodes[0];\n\n              while (n.parentNode != null) {\n                n = n.parentNode;\n              }\n\n              nodes = [n];\n            } else {\n              nodes = [nodes[0].ownerDocument];\n            }\n          }\n        } else {\n        nodes = [nodes[0]];\n      }\n    }\n\n    for (var i = 0; i < this.locationPath.steps.length; i++) {\n      var step = this.locationPath.steps[i];\n      var newNodes = [];\n      var newLocalContext = [];\n\n      for (var j = 0; j < nodes.length; j++) {\n        xpc.contextNode = nodes[j];\n\n        switch (step.axis) {\n          case Step.ANCESTOR:\n            // look at all the ancestor nodes\n            if (xpc.contextNode === xpc.virtualRoot) {\n              break;\n            }\n\n            var m;\n\n            if (xpc.contextNode.nodeType == 2\n            /*Node.ATTRIBUTE_NODE*/\n            ) {\n                m = this.getOwnerElement(xpc.contextNode);\n              } else {\n              m = xpc.contextNode.parentNode;\n            }\n\n            while (m != null) {\n              if (step.nodeTest.matches(m, xpc)) {\n                newNodes.push(m);\n              }\n\n              if (m === xpc.virtualRoot) {\n                break;\n              }\n\n              m = m.parentNode;\n            }\n\n            break;\n\n          case Step.ANCESTORORSELF:\n            // look at all the ancestor nodes and the current node\n            for (var m = xpc.contextNode; m != null; m = m.nodeType == 2\n            /*Node.ATTRIBUTE_NODE*/\n            ? this.getOwnerElement(m) : m.parentNode) {\n              if (step.nodeTest.matches(m, xpc)) {\n                newNodes.push(m);\n              }\n\n              if (m === xpc.virtualRoot) {\n                break;\n              }\n            }\n\n            break;\n\n          case Step.ATTRIBUTE:\n            // look at the attributes\n            var nnm = xpc.contextNode.attributes;\n\n            if (nnm != null) {\n              for (var k = 0; k < nnm.length; k++) {\n                var m = nnm.item(k);\n\n                if (step.nodeTest.matches(m, xpc)) {\n                  newNodes.push(m);\n                }\n              }\n            }\n\n            break;\n\n          case Step.CHILD:\n            // look at all child elements\n            var pos = 0;\n            var tmpContext = [];\n\n            for (var m = xpc.contextNode.firstChild; m != null; m = m.nextSibling) {\n              if (step.nodeTest.matches(m, xpc)) {\n                newNodes.push(m); //keep track of the element position between other matching siblings\n\n                tmpContext.push({\n                  contextPosition: ++pos\n                });\n              }\n            }\n\n            for (var k = 0; k < tmpContext.length; k++) {\n              //track size of matching siblings\n              tmpContext[k].contextSize = pos;\n              newLocalContext.push(tmpContext[k]);\n            }\n\n            break;\n\n          case Step.DESCENDANT:\n            // look at all descendant nodes\n            var st = [xpc.contextNode.firstChild];\n\n            while (st.length > 0) {\n              for (var m = st.pop(); m != null;) {\n                if (step.nodeTest.matches(m, xpc)) {\n                  newNodes.push(m);\n                }\n\n                if (m.firstChild != null) {\n                  st.push(m.nextSibling);\n                  m = m.firstChild;\n                } else {\n                  m = m.nextSibling;\n                }\n              }\n            }\n\n            break;\n\n          case Step.DESCENDANTORSELF:\n            // look at self\n            if (step.nodeTest.matches(xpc.contextNode, xpc)) {\n              newNodes.push(xpc.contextNode);\n            } // look at all descendant nodes\n\n\n            var st = [xpc.contextNode.firstChild];\n\n            while (st.length > 0) {\n              for (var m = st.pop(); m != null;) {\n                if (step.nodeTest.matches(m, xpc)) {\n                  newNodes.push(m);\n                }\n\n                if (m.firstChild != null) {\n                  st.push(m.nextSibling);\n                  m = m.firstChild;\n                } else {\n                  m = m.nextSibling;\n                }\n              }\n            }\n\n            break;\n\n          case Step.FOLLOWING:\n            if (xpc.contextNode === xpc.virtualRoot) {\n              break;\n            }\n\n            var st = [];\n\n            if (xpc.contextNode.firstChild != null) {\n              st.unshift(xpc.contextNode.firstChild);\n            } else {\n              st.unshift(xpc.contextNode.nextSibling);\n            }\n\n            for (var m = xpc.contextNode; m != null && m.nodeType != 9\n            /*Node.DOCUMENT_NODE*/\n            && m !== xpc.virtualRoot; m = m.parentNode) {\n              st.unshift(m.nextSibling);\n            }\n\n            do {\n              for (var m = st.pop(); m != null;) {\n                if (step.nodeTest.matches(m, xpc)) {\n                  newNodes.push(m);\n                }\n\n                if (m.firstChild != null) {\n                  st.push(m.nextSibling);\n                  m = m.firstChild;\n                } else {\n                  m = m.nextSibling;\n                }\n              }\n            } while (st.length > 0);\n\n            break;\n\n          case Step.FOLLOWINGSIBLING:\n            if (xpc.contextNode === xpc.virtualRoot) {\n              break;\n            }\n\n            for (var m = xpc.contextNode.nextSibling; m != null; m = m.nextSibling) {\n              if (step.nodeTest.matches(m, xpc)) {\n                newNodes.push(m);\n              }\n            }\n\n            break;\n\n          case Step.NAMESPACE:\n            var n = {};\n\n            if (xpc.contextNode.nodeType == 1\n            /*Node.ELEMENT_NODE*/\n            ) {\n                n[\"xml\"] = XPath.XML_NAMESPACE_URI;\n                n[\"xmlns\"] = XPath.XMLNS_NAMESPACE_URI;\n\n                for (var m = xpc.contextNode; m != null && m.nodeType == 1\n                /*Node.ELEMENT_NODE*/\n                ; m = m.parentNode) {\n                  for (var k = 0; k < m.attributes.length; k++) {\n                    var attr = m.attributes.item(k);\n                    var nm = String(attr.name);\n\n                    if (nm == \"xmlns\") {\n                      if (n[\"\"] == undefined) {\n                        n[\"\"] = attr.value;\n                      }\n                    } else if (nm.length > 6 && nm.substring(0, 6) == \"xmlns:\") {\n                      var pre = nm.substring(6, nm.length);\n\n                      if (n[pre] == undefined) {\n                        n[pre] = attr.value;\n                      }\n                    }\n                  }\n                }\n\n                for (var pre in n) {\n                  var nsn = new NamespaceNode(pre, n[pre], xpc.contextNode);\n\n                  if (step.nodeTest.matches(nsn, xpc)) {\n                    newNodes.push(nsn);\n                  }\n                }\n              }\n\n            break;\n\n          case Step.PARENT:\n            m = null;\n\n            if (xpc.contextNode !== xpc.virtualRoot) {\n              if (xpc.contextNode.nodeType == 2\n              /*Node.ATTRIBUTE_NODE*/\n              ) {\n                  m = this.getOwnerElement(xpc.contextNode);\n                } else {\n                m = xpc.contextNode.parentNode;\n              }\n            }\n\n            if (m != null && step.nodeTest.matches(m, xpc)) {\n              newNodes.push(m);\n            }\n\n            break;\n\n          case Step.PRECEDING:\n            var st;\n\n            if (xpc.virtualRoot != null) {\n              st = [xpc.virtualRoot];\n            } else {\n              st = xpc.contextNode.nodeType == 9\n              /*Node.DOCUMENT_NODE*/\n              ? [xpc.contextNode] : [xpc.contextNode.ownerDocument];\n            }\n\n            outer: while (st.length > 0) {\n              for (var m = st.pop(); m != null;) {\n                if (m == xpc.contextNode) {\n                  break outer;\n                }\n\n                if (step.nodeTest.matches(m, xpc)) {\n                  newNodes.unshift(m);\n                }\n\n                if (m.firstChild != null) {\n                  st.push(m.nextSibling);\n                  m = m.firstChild;\n                } else {\n                  m = m.nextSibling;\n                }\n              }\n            }\n\n            break;\n\n          case Step.PRECEDINGSIBLING:\n            if (xpc.contextNode === xpc.virtualRoot) {\n              break;\n            }\n\n            for (var m = xpc.contextNode.previousSibling; m != null; m = m.previousSibling) {\n              if (step.nodeTest.matches(m, xpc)) {\n                newNodes.push(m);\n              }\n            }\n\n            break;\n\n          case Step.SELF:\n            if (step.nodeTest.matches(xpc.contextNode, xpc)) {\n              newNodes.push(xpc.contextNode);\n            }\n\n            break;\n\n          default:\n        }\n      }\n\n      nodes = newNodes; // apply each of the predicates in turn\t\t\t\n\n      for (var j = 0; j < step.predicates.length; j++) {\n        var pred = step.predicates[j];\n        var newNodes = [];\n        xpc.contextSize = nodes.length;\n\n        for (xpc.contextPosition = 1; xpc.contextPosition <= xpc.contextSize; xpc.contextPosition++) {\n          xpc.contextNode = nodes[xpc.contextPosition - 1]; //if we keep track of the node original context then use it\n          //end goal is to always use original cotnext, now implemented just for CHILD axis\n\n          var localCtx = newLocalContext.length > 0 ? this.getLocalCtx(xpc, newLocalContext[xpc.contextPosition - 1]) : xpc;\n\n          if (this.predicateMatches(pred, localCtx)) {\n            newNodes.push(xpc.contextNode);\n          } else {}\n        }\n\n        nodes = newNodes; //console.log(nodes.length)\n      }\n    }\n  }\n\n  var ns = new XNodeSet();\n  ns.addArray(nodes);\n  return ns;\n};\n\nPathExpr.prototype.getLocalCtx = function (xpc, localCtx, length) {\n  var res = new XPathContext();\n  res.variableResolver = xpc.variableResolver;\n  res.functionResolver = xpc.functionResolver;\n  res.namespaceResolver = xpc.namespaceResolver;\n  res.expressionContextNode = xpc.expressionContextNode;\n  res.virtualRoot = xpc.virtualRoot;\n  res.caseInsensitive = xpc.caseInsensitive;\n  res.contextNode = xpc.contextNode;\n  res.contextPosition = localCtx.contextPosition;\n  res.contextSize = localCtx.contextSize;\n  return res;\n};\n\nPathExpr.prototype.predicateMatches = function (pred, c) {\n  var res = pred.evaluate(c);\n\n  if (Utilities.instance_of(res, XNumber)) {\n    var val = c.contextPosition == res.numberValue();\n    return val;\n  }\n\n  return res.booleanValue();\n};\n\nPathExpr.prototype.toString = function () {\n  if (this.filter != undefined) {\n    var s = this.filter.toString();\n\n    if (Utilities.instance_of(this.filter, XString)) {\n      s = \"'\" + s + \"'\";\n    }\n\n    if (this.filterPredicates != undefined) {\n      for (var i = 0; i < this.filterPredicates.length; i++) {\n        s = s + \"[\" + this.filterPredicates[i].toString() + \"]\";\n      }\n    }\n\n    if (this.locationPath != undefined) {\n      if (!this.locationPath.absolute) {\n        s += \"/\";\n      }\n\n      s += this.locationPath.toString();\n    }\n\n    return s;\n  }\n\n  return this.locationPath.toString();\n};\n\nPathExpr.prototype.getOwnerElement = function (n) {\n  // DOM 2 has ownerElement\n  if (n.ownerElement) {\n    return n.ownerElement;\n  } // DOM 1 Internet Explorer can use selectSingleNode (ironically)\n\n\n  try {\n    if (n.selectSingleNode) {\n      return n.selectSingleNode(\"..\");\n    }\n  } catch (e) {} // Other DOM 1 implementations must use this egregious search\n\n\n  var doc = n.nodeType == 9\n  /*Node.DOCUMENT_NODE*/\n  ? n : n.ownerDocument;\n  var elts = doc.getElementsByTagName(\"*\");\n\n  for (var i = 0; i < elts.length; i++) {\n    var elt = elts.item(i);\n    var nnm = elt.attributes;\n\n    for (var j = 0; j < nnm.length; j++) {\n      var an = nnm.item(j);\n\n      if (an === n) {\n        return elt;\n      }\n    }\n  }\n\n  return null;\n}; // LocationPath //////////////////////////////////////////////////////////////\n\n\nLocationPath.prototype = new Object();\nLocationPath.prototype.constructor = LocationPath;\nLocationPath.superclass = Object.prototype;\n\nfunction LocationPath(abs, steps) {\n  if (arguments.length > 0) {\n    this.init(abs, steps);\n  }\n}\n\nLocationPath.prototype.init = function (abs, steps) {\n  this.absolute = abs;\n  this.steps = steps;\n};\n\nLocationPath.prototype.toString = function () {\n  var s;\n\n  if (this.absolute) {\n    s = \"/\";\n  } else {\n    s = \"\";\n  }\n\n  for (var i = 0; i < this.steps.length; i++) {\n    if (i != 0) {\n      s += \"/\";\n    }\n\n    s += this.steps[i].toString();\n  }\n\n  return s;\n}; // Step //////////////////////////////////////////////////////////////////////\n\n\nStep.prototype = new Object();\nStep.prototype.constructor = Step;\nStep.superclass = Object.prototype;\n\nfunction Step(axis, nodetest, preds) {\n  if (arguments.length > 0) {\n    this.init(axis, nodetest, preds);\n  }\n}\n\nStep.prototype.init = function (axis, nodetest, preds) {\n  this.axis = axis;\n  this.nodeTest = nodetest;\n  this.predicates = preds;\n};\n\nStep.prototype.toString = function () {\n  var s;\n\n  switch (this.axis) {\n    case Step.ANCESTOR:\n      s = \"ancestor\";\n      break;\n\n    case Step.ANCESTORORSELF:\n      s = \"ancestor-or-self\";\n      break;\n\n    case Step.ATTRIBUTE:\n      s = \"attribute\";\n      break;\n\n    case Step.CHILD:\n      s = \"child\";\n      break;\n\n    case Step.DESCENDANT:\n      s = \"descendant\";\n      break;\n\n    case Step.DESCENDANTORSELF:\n      s = \"descendant-or-self\";\n      break;\n\n    case Step.FOLLOWING:\n      s = \"following\";\n      break;\n\n    case Step.FOLLOWINGSIBLING:\n      s = \"following-sibling\";\n      break;\n\n    case Step.NAMESPACE:\n      s = \"namespace\";\n      break;\n\n    case Step.PARENT:\n      s = \"parent\";\n      break;\n\n    case Step.PRECEDING:\n      s = \"preceding\";\n      break;\n\n    case Step.PRECEDINGSIBLING:\n      s = \"preceding-sibling\";\n      break;\n\n    case Step.SELF:\n      s = \"self\";\n      break;\n  }\n\n  s += \"::\";\n  s += this.nodeTest.toString();\n\n  for (var i = 0; i < this.predicates.length; i++) {\n    s += \"[\" + this.predicates[i].toString() + \"]\";\n  }\n\n  return s;\n};\n\nStep.ANCESTOR = 0;\nStep.ANCESTORORSELF = 1;\nStep.ATTRIBUTE = 2;\nStep.CHILD = 3;\nStep.DESCENDANT = 4;\nStep.DESCENDANTORSELF = 5;\nStep.FOLLOWING = 6;\nStep.FOLLOWINGSIBLING = 7;\nStep.NAMESPACE = 8;\nStep.PARENT = 9;\nStep.PRECEDING = 10;\nStep.PRECEDINGSIBLING = 11;\nStep.SELF = 12; // NodeTest //////////////////////////////////////////////////////////////////\n\nNodeTest.prototype = new Object();\nNodeTest.prototype.constructor = NodeTest;\nNodeTest.superclass = Object.prototype;\n\nfunction NodeTest(type, value) {\n  if (arguments.length > 0) {\n    this.init(type, value);\n  }\n}\n\nNodeTest.prototype.init = function (type, value) {\n  this.type = type;\n  this.value = value;\n};\n\nNodeTest.prototype.toString = function () {\n  switch (this.type) {\n    case NodeTest.NAMETESTANY:\n      return \"*\";\n\n    case NodeTest.NAMETESTPREFIXANY:\n      return this.value + \":*\";\n\n    case NodeTest.NAMETESTRESOLVEDANY:\n      return \"{\" + this.value + \"}*\";\n\n    case NodeTest.NAMETESTQNAME:\n      return this.value;\n\n    case NodeTest.NAMETESTRESOLVEDNAME:\n      return \"{\" + this.namespaceURI + \"}\" + this.value;\n\n    case NodeTest.COMMENT:\n      return \"comment()\";\n\n    case NodeTest.TEXT:\n      return \"text()\";\n\n    case NodeTest.PI:\n      if (this.value != undefined) {\n        return \"processing-instruction(\\\"\" + this.value + \"\\\")\";\n      }\n\n      return \"processing-instruction()\";\n\n    case NodeTest.NODE:\n      return \"node()\";\n  }\n\n  return \"<unknown nodetest type>\";\n};\n\nNodeTest.prototype.matches = function (n, xpc) {\n  switch (this.type) {\n    case NodeTest.NAMETESTANY:\n      if (n.nodeType == 2\n      /*Node.ATTRIBUTE_NODE*/\n      || n.nodeType == 1\n      /*Node.ELEMENT_NODE*/\n      || n.nodeType == XPathNamespace.XPATH_NAMESPACE_NODE) {\n        return true;\n      }\n\n      return false;\n\n    case NodeTest.NAMETESTPREFIXANY:\n      if (n.nodeType == 2\n      /*Node.ATTRIBUTE_NODE*/\n      || n.nodeType == 1\n      /*Node.ELEMENT_NODE*/\n      ) {\n          var ns = xpc.namespaceResolver.getNamespace(this.value, xpc.expressionContextNode);\n\n          if (ns == null) {\n            throw new Error(\"Cannot resolve QName \" + this.value);\n          }\n\n          return true;\n        }\n\n      return false;\n\n    case NodeTest.NAMETESTQNAME:\n      if (n.nodeType == 2\n      /*Node.ATTRIBUTE_NODE*/\n      || n.nodeType == 1\n      /*Node.ELEMENT_NODE*/\n      || n.nodeType == XPathNamespace.XPATH_NAMESPACE_NODE) {\n        var test = Utilities.resolveQName(this.value, xpc.namespaceResolver, xpc.expressionContextNode, false);\n\n        if (test[0] == null) {\n          throw new Error(\"Cannot resolve QName \" + this.value);\n        }\n\n        test[0] = String(test[0]);\n        test[1] = String(test[1]);\n\n        if (test[0] == \"\") {\n          test[0] = null;\n        }\n\n        var node = Utilities.resolveQName(n.nodeName, xpc.namespaceResolver, n, n.nodeType == 1\n        /*Node.ELEMENT_NODE*/\n        );\n        node[0] = String(node[0]);\n        node[1] = String(node[1]);\n\n        if (node[0] == \"\") {\n          node[0] = null;\n        }\n\n        if (xpc.caseInsensitive) {\n          return test[0] == node[0] && String(test[1]).toLowerCase() == String(node[1]).toLowerCase();\n        }\n\n        return test[0] == node[0] && test[1] == node[1];\n      }\n\n      return false;\n\n    case NodeTest.COMMENT:\n      return n.nodeType == 8\n      /*Node.COMMENT_NODE*/\n      ;\n\n    case NodeTest.TEXT:\n      return n.nodeType == 3\n      /*Node.TEXT_NODE*/\n      || n.nodeType == 4\n      /*Node.CDATA_SECTION_NODE*/\n      ;\n\n    case NodeTest.PI:\n      return n.nodeType == 7\n      /*Node.PROCESSING_INSTRUCTION_NODE*/\n      && (this.value == null || n.nodeName == this.value);\n\n    case NodeTest.NODE:\n      return n.nodeType == 9\n      /*Node.DOCUMENT_NODE*/\n      || n.nodeType == 1\n      /*Node.ELEMENT_NODE*/\n      || n.nodeType == 2\n      /*Node.ATTRIBUTE_NODE*/\n      || n.nodeType == 3\n      /*Node.TEXT_NODE*/\n      || n.nodeType == 4\n      /*Node.CDATA_SECTION_NODE*/\n      || n.nodeType == 8\n      /*Node.COMMENT_NODE*/\n      || n.nodeType == 7\n      /*Node.PROCESSING_INSTRUCTION_NODE*/\n      ;\n  }\n\n  return false;\n};\n\nNodeTest.NAMETESTANY = 0;\nNodeTest.NAMETESTPREFIXANY = 1;\nNodeTest.NAMETESTQNAME = 2;\nNodeTest.COMMENT = 3;\nNodeTest.TEXT = 4;\nNodeTest.PI = 5;\nNodeTest.NODE = 6; // VariableReference /////////////////////////////////////////////////////////\n\nVariableReference.prototype = new Expression();\nVariableReference.prototype.constructor = VariableReference;\nVariableReference.superclass = Expression.prototype;\n\nfunction VariableReference(v) {\n  if (arguments.length > 0) {\n    this.init(v);\n  }\n}\n\nVariableReference.prototype.init = function (v) {\n  this.variable = v;\n};\n\nVariableReference.prototype.toString = function () {\n  return \"$\" + this.variable;\n};\n\nVariableReference.prototype.evaluate = function (c) {\n  return c.variableResolver.getVariable(this.variable, c);\n}; // FunctionCall //////////////////////////////////////////////////////////////\n\n\nFunctionCall.prototype = new Expression();\nFunctionCall.prototype.constructor = FunctionCall;\nFunctionCall.superclass = Expression.prototype;\n\nfunction FunctionCall(fn, args) {\n  if (arguments.length > 0) {\n    this.init(fn, args);\n  }\n}\n\nFunctionCall.prototype.init = function (fn, args) {\n  this.functionName = fn;\n  this.arguments = args;\n};\n\nFunctionCall.prototype.toString = function () {\n  var s = this.functionName + \"(\";\n\n  for (var i = 0; i < this.arguments.length; i++) {\n    if (i > 0) {\n      s += \", \";\n    }\n\n    s += this.arguments[i].toString();\n  }\n\n  return s + \")\";\n};\n\nFunctionCall.prototype.evaluate = function (c) {\n  var f = c.functionResolver.getFunction(this.functionName, c);\n\n  if (f == undefined) {\n    throw new Error(\"Unknown function \" + this.functionName);\n  }\n\n  var a = [c].concat(this.arguments);\n  return f.apply(c.functionResolver.thisArg, a);\n}; // XString ///////////////////////////////////////////////////////////////////\n\n\nXString.prototype = new Expression();\nXString.prototype.constructor = XString;\nXString.superclass = Expression.prototype;\n\nfunction XString(s) {\n  if (arguments.length > 0) {\n    this.init(s);\n  }\n}\n\nXString.prototype.init = function (s) {\n  this.str = s;\n};\n\nXString.prototype.toString = function () {\n  return this.str;\n};\n\nXString.prototype.evaluate = function (c) {\n  return this;\n};\n\nXString.prototype.string = function () {\n  return this;\n};\n\nXString.prototype.number = function () {\n  return new XNumber(this.str);\n};\n\nXString.prototype.bool = function () {\n  return new XBoolean(this.str);\n};\n\nXString.prototype.nodeset = function () {\n  throw new Error(\"Cannot convert string to nodeset\");\n};\n\nXString.prototype.stringValue = function () {\n  return this.str;\n};\n\nXString.prototype.numberValue = function () {\n  return this.number().numberValue();\n};\n\nXString.prototype.booleanValue = function () {\n  return this.bool().booleanValue();\n};\n\nXString.prototype.equals = function (r) {\n  if (Utilities.instance_of(r, XBoolean)) {\n    return this.bool().equals(r);\n  }\n\n  if (Utilities.instance_of(r, XNumber)) {\n    return this.number().equals(r);\n  }\n\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithString(this, Operators.equals);\n  }\n\n  return new XBoolean(this.str == r.str);\n};\n\nXString.prototype.notequal = function (r) {\n  if (Utilities.instance_of(r, XBoolean)) {\n    return this.bool().notequal(r);\n  }\n\n  if (Utilities.instance_of(r, XNumber)) {\n    return this.number().notequal(r);\n  }\n\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithString(this, Operators.notequal);\n  }\n\n  return new XBoolean(this.str != r.str);\n};\n\nXString.prototype.lessthan = function (r) {\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithNumber(this.number(), Operators.greaterthanorequal);\n  }\n\n  return this.number().lessthan(r.number());\n};\n\nXString.prototype.greaterthan = function (r) {\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithNumber(this.number(), Operators.lessthanorequal);\n  }\n\n  return this.number().greaterthan(r.number());\n};\n\nXString.prototype.lessthanorequal = function (r) {\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithNumber(this.number(), Operators.greaterthan);\n  }\n\n  return this.number().lessthanorequal(r.number());\n};\n\nXString.prototype.greaterthanorequal = function (r) {\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithNumber(this.number(), Operators.lessthan);\n  }\n\n  return this.number().greaterthanorequal(r.number());\n}; // XNumber ///////////////////////////////////////////////////////////////////\n\n\nXNumber.prototype = new Expression();\nXNumber.prototype.constructor = XNumber;\nXNumber.superclass = Expression.prototype;\n\nfunction XNumber(n) {\n  if (arguments.length > 0) {\n    this.init(n);\n  }\n}\n\nXNumber.prototype.init = function (n) {\n  this.num = Number(n);\n};\n\nXNumber.prototype.toString = function () {\n  return this.num;\n};\n\nXNumber.prototype.evaluate = function (c) {\n  return this;\n};\n\nXNumber.prototype.string = function () {\n  return new XString(this.num);\n};\n\nXNumber.prototype.number = function () {\n  return this;\n};\n\nXNumber.prototype.bool = function () {\n  return new XBoolean(this.num);\n};\n\nXNumber.prototype.nodeset = function () {\n  throw new Error(\"Cannot convert number to nodeset\");\n};\n\nXNumber.prototype.stringValue = function () {\n  return this.string().stringValue();\n};\n\nXNumber.prototype.numberValue = function () {\n  return this.num;\n};\n\nXNumber.prototype.booleanValue = function () {\n  return this.bool().booleanValue();\n};\n\nXNumber.prototype.negate = function () {\n  return new XNumber(-this.num);\n};\n\nXNumber.prototype.equals = function (r) {\n  if (Utilities.instance_of(r, XBoolean)) {\n    return this.bool().equals(r);\n  }\n\n  if (Utilities.instance_of(r, XString)) {\n    return this.equals(r.number());\n  }\n\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithNumber(this, Operators.equals);\n  }\n\n  return new XBoolean(this.num == r.num);\n};\n\nXNumber.prototype.notequal = function (r) {\n  if (Utilities.instance_of(r, XBoolean)) {\n    return this.bool().notequal(r);\n  }\n\n  if (Utilities.instance_of(r, XString)) {\n    return this.notequal(r.number());\n  }\n\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithNumber(this, Operators.notequal);\n  }\n\n  return new XBoolean(this.num != r.num);\n};\n\nXNumber.prototype.lessthan = function (r) {\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithNumber(this, Operators.greaterthanorequal);\n  }\n\n  if (Utilities.instance_of(r, XBoolean) || Utilities.instance_of(r, XString)) {\n    return this.lessthan(r.number());\n  }\n\n  return new XBoolean(this.num < r.num);\n};\n\nXNumber.prototype.greaterthan = function (r) {\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithNumber(this, Operators.lessthanorequal);\n  }\n\n  if (Utilities.instance_of(r, XBoolean) || Utilities.instance_of(r, XString)) {\n    return this.greaterthan(r.number());\n  }\n\n  return new XBoolean(this.num > r.num);\n};\n\nXNumber.prototype.lessthanorequal = function (r) {\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithNumber(this, Operators.greaterthan);\n  }\n\n  if (Utilities.instance_of(r, XBoolean) || Utilities.instance_of(r, XString)) {\n    return this.lessthanorequal(r.number());\n  }\n\n  return new XBoolean(this.num <= r.num);\n};\n\nXNumber.prototype.greaterthanorequal = function (r) {\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithNumber(this, Operators.lessthan);\n  }\n\n  if (Utilities.instance_of(r, XBoolean) || Utilities.instance_of(r, XString)) {\n    return this.greaterthanorequal(r.number());\n  }\n\n  return new XBoolean(this.num >= r.num);\n};\n\nXNumber.prototype.plus = function (r) {\n  return new XNumber(this.num + r.num);\n};\n\nXNumber.prototype.minus = function (r) {\n  return new XNumber(this.num - r.num);\n};\n\nXNumber.prototype.multiply = function (r) {\n  return new XNumber(this.num * r.num);\n};\n\nXNumber.prototype.div = function (r) {\n  return new XNumber(this.num / r.num);\n};\n\nXNumber.prototype.mod = function (r) {\n  return new XNumber(this.num % r.num);\n}; // XBoolean //////////////////////////////////////////////////////////////////\n\n\nXBoolean.prototype = new Expression();\nXBoolean.prototype.constructor = XBoolean;\nXBoolean.superclass = Expression.prototype;\n\nfunction XBoolean(b) {\n  if (arguments.length > 0) {\n    this.init(b);\n  }\n}\n\nXBoolean.prototype.init = function (b) {\n  this.b = Boolean(b);\n};\n\nXBoolean.prototype.toString = function () {\n  return this.b.toString();\n};\n\nXBoolean.prototype.evaluate = function (c) {\n  return this;\n};\n\nXBoolean.prototype.string = function () {\n  return new XString(this.b);\n};\n\nXBoolean.prototype.number = function () {\n  return new XNumber(this.b);\n};\n\nXBoolean.prototype.bool = function () {\n  return this;\n};\n\nXBoolean.prototype.nodeset = function () {\n  throw new Error(\"Cannot convert boolean to nodeset\");\n};\n\nXBoolean.prototype.stringValue = function () {\n  return this.string().stringValue();\n};\n\nXBoolean.prototype.numberValue = function () {\n  return this.num().numberValue();\n};\n\nXBoolean.prototype.booleanValue = function () {\n  return this.b;\n};\n\nXBoolean.prototype.not = function () {\n  return new XBoolean(!this.b);\n};\n\nXBoolean.prototype.equals = function (r) {\n  if (Utilities.instance_of(r, XString) || Utilities.instance_of(r, XNumber)) {\n    return this.equals(r.bool());\n  }\n\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithBoolean(this, Operators.equals);\n  }\n\n  return new XBoolean(this.b == r.b);\n};\n\nXBoolean.prototype.notequal = function (r) {\n  if (Utilities.instance_of(r, XString) || Utilities.instance_of(r, XNumber)) {\n    return this.notequal(r.bool());\n  }\n\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithBoolean(this, Operators.notequal);\n  }\n\n  return new XBoolean(this.b != r.b);\n};\n\nXBoolean.prototype.lessthan = function (r) {\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithNumber(this.number(), Operators.greaterthanorequal);\n  }\n\n  return this.number().lessthan(r.number());\n};\n\nXBoolean.prototype.greaterthan = function (r) {\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithNumber(this.number(), Operators.lessthanorequal);\n  }\n\n  return this.number().greaterthan(r.number());\n};\n\nXBoolean.prototype.lessthanorequal = function (r) {\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithNumber(this.number(), Operators.greaterthan);\n  }\n\n  return this.number().lessthanorequal(r.number());\n};\n\nXBoolean.prototype.greaterthanorequal = function (r) {\n  if (Utilities.instance_of(r, XNodeSet)) {\n    return r.compareWithNumber(this.number(), Operators.lessthan);\n  }\n\n  return this.number().greaterthanorequal(r.number());\n}; // AVLTree ///////////////////////////////////////////////////////////////////\n\n\nAVLTree.prototype = new Object();\nAVLTree.prototype.constructor = AVLTree;\nAVLTree.superclass = Object.prototype;\n\nfunction AVLTree(n) {\n  this.init(n);\n}\n\nAVLTree.prototype.init = function (n) {\n  this.left = null;\n  this.right = null;\n  this.node = n;\n  this.depth = 1;\n};\n\nAVLTree.prototype.balance = function () {\n  var ldepth = this.left == null ? 0 : this.left.depth;\n  var rdepth = this.right == null ? 0 : this.right.depth;\n\n  if (ldepth > rdepth + 1) {\n    // LR or LL rotation\n    var lldepth = this.left.left == null ? 0 : this.left.left.depth;\n    var lrdepth = this.left.right == null ? 0 : this.left.right.depth;\n\n    if (lldepth < lrdepth) {\n      // LR rotation consists of a RR rotation of the left child\n      this.left.rotateRR(); // plus a LL rotation of this node, which happens anyway \n    }\n\n    this.rotateLL();\n  } else if (ldepth + 1 < rdepth) {\n    // RR or RL rorarion\n    var rrdepth = this.right.right == null ? 0 : this.right.right.depth;\n    var rldepth = this.right.left == null ? 0 : this.right.left.depth;\n\n    if (rldepth > rrdepth) {\n      // RR rotation consists of a LL rotation of the right child\n      this.right.rotateLL(); // plus a RR rotation of this node, which happens anyway \n    }\n\n    this.rotateRR();\n  }\n};\n\nAVLTree.prototype.rotateLL = function () {\n  // the left side is too long => rotate from the left (_not_ leftwards)\n  var nodeBefore = this.node;\n  var rightBefore = this.right;\n  this.node = this.left.node;\n  this.right = this.left;\n  this.left = this.left.left;\n  this.right.left = this.right.right;\n  this.right.right = rightBefore;\n  this.right.node = nodeBefore;\n  this.right.updateInNewLocation();\n  this.updateInNewLocation();\n};\n\nAVLTree.prototype.rotateRR = function () {\n  // the right side is too long => rotate from the right (_not_ rightwards)\n  var nodeBefore = this.node;\n  var leftBefore = this.left;\n  this.node = this.right.node;\n  this.left = this.right;\n  this.right = this.right.right;\n  this.left.right = this.left.left;\n  this.left.left = leftBefore;\n  this.left.node = nodeBefore;\n  this.left.updateInNewLocation();\n  this.updateInNewLocation();\n};\n\nAVLTree.prototype.updateInNewLocation = function () {\n  this.getDepthFromChildren();\n};\n\nAVLTree.prototype.getDepthFromChildren = function () {\n  this.depth = this.node == null ? 0 : 1;\n\n  if (this.left != null) {\n    this.depth = this.left.depth + 1;\n  }\n\n  if (this.right != null && this.depth <= this.right.depth) {\n    this.depth = this.right.depth + 1;\n  }\n};\n\nAVLTree.prototype.order = function (n1, n2) {\n  if (n1 === n2) {\n    return 0;\n  }\n\n  var d1 = 0;\n  var d2 = 0;\n\n  for (var m1 = n1; m1 != null; m1 = m1.parentNode) {\n    d1++;\n  }\n\n  for (var m2 = n2; m2 != null; m2 = m2.parentNode) {\n    d2++;\n  }\n\n  if (d1 > d2) {\n    while (d1 > d2) {\n      n1 = n1.parentNode;\n      d1--;\n    }\n\n    if (n1 == n2) {\n      return 1;\n    }\n  } else if (d2 > d1) {\n    while (d2 > d1) {\n      n2 = n2.parentNode;\n      d2--;\n    }\n\n    if (n1 == n2) {\n      return -1;\n    }\n  }\n\n  while (n1.parentNode != n2.parentNode) {\n    n1 = n1.parentNode;\n    n2 = n2.parentNode;\n  }\n\n  while (n1.previousSibling != null && n2.previousSibling != null) {\n    n1 = n1.previousSibling;\n    n2 = n2.previousSibling;\n  }\n\n  if (n1.previousSibling == null) {\n    return -1;\n  }\n\n  return 1;\n};\n\nAVLTree.prototype.add = function (n) {\n  if (n === this.node) {\n    return false;\n  }\n\n  var o = this.order(n, this.node);\n  var ret = false;\n\n  if (o == -1) {\n    if (this.left == null) {\n      this.left = new AVLTree(n);\n      ret = true;\n    } else {\n      ret = this.left.add(n);\n\n      if (ret) {\n        this.balance();\n      }\n    }\n  } else if (o == 1) {\n    if (this.right == null) {\n      this.right = new AVLTree(n);\n      ret = true;\n    } else {\n      ret = this.right.add(n);\n\n      if (ret) {\n        this.balance();\n      }\n    }\n  }\n\n  if (ret) {\n    this.getDepthFromChildren();\n  }\n\n  return ret;\n}; // XNodeSet //////////////////////////////////////////////////////////////////\n\n\nXNodeSet.prototype = new Expression();\nXNodeSet.prototype.constructor = XNodeSet;\nXNodeSet.superclass = Expression.prototype;\n\nfunction XNodeSet() {\n  this.init();\n}\n\nXNodeSet.prototype.init = function () {\n  this.tree = null;\n  this.size = 0;\n};\n\nXNodeSet.prototype.toString = function () {\n  var p = this.first();\n\n  if (p == null) {\n    return \"\";\n  }\n\n  return this.stringForNode(p);\n};\n\nXNodeSet.prototype.evaluate = function (c) {\n  return this;\n};\n\nXNodeSet.prototype.string = function () {\n  return new XString(this.toString());\n};\n\nXNodeSet.prototype.stringValue = function () {\n  return this.toString();\n};\n\nXNodeSet.prototype.number = function () {\n  return new XNumber(this.string());\n};\n\nXNodeSet.prototype.numberValue = function () {\n  return Number(this.string());\n};\n\nXNodeSet.prototype.bool = function () {\n  return new XBoolean(this.tree != null);\n};\n\nXNodeSet.prototype.booleanValue = function () {\n  return this.tree != null;\n};\n\nXNodeSet.prototype.nodeset = function () {\n  return this;\n};\n\nXNodeSet.prototype.stringForNode = function (n) {\n  if (n.nodeType == 9\n  /*Node.DOCUMENT_NODE*/\n  ) {\n      n = n.documentElement;\n    }\n\n  if (n.nodeType == 1\n  /*Node.ELEMENT_NODE*/\n  ) {\n      return this.stringForNodeRec(n);\n    }\n\n  if (n.isNamespaceNode) {\n    return n.namespace;\n  }\n\n  return n.nodeValue;\n};\n\nXNodeSet.prototype.stringForNodeRec = function (n) {\n  var s = \"\";\n\n  for (var n2 = n.firstChild; n2 != null; n2 = n2.nextSibling) {\n    if (n2.nodeType == 3\n    /*Node.TEXT_NODE*/\n    ) {\n        s += n2.nodeValue;\n      } else if (n2.nodeType == 1\n    /*Node.ELEMENT_NODE*/\n    ) {\n        s += this.stringForNodeRec(n2);\n      }\n  }\n\n  return s;\n};\n\nXNodeSet.prototype.first = function () {\n  var p = this.tree;\n\n  if (p == null) {\n    return null;\n  }\n\n  while (p.left != null) {\n    p = p.left;\n  }\n\n  return p.node;\n};\n\nXNodeSet.prototype.add = function (n) {\n  var added;\n\n  if (this.tree == null) {\n    this.tree = new AVLTree(n);\n    added = true;\n  } else {\n    added = this.tree.add(n);\n  }\n\n  if (added) {\n    this.size++;\n  }\n};\n\nXNodeSet.prototype.addArray = function (ns) {\n  for (var i = 0; i < ns.length; i++) {\n    this.add(ns[i]);\n  }\n};\n\nXNodeSet.prototype.toArray = function () {\n  var a = [];\n  this.toArrayRec(this.tree, a);\n  return a;\n};\n\nXNodeSet.prototype.toArrayRec = function (t, a) {\n  if (t != null) {\n    this.toArrayRec(t.left, a);\n    a.push(t.node);\n    this.toArrayRec(t.right, a);\n  }\n};\n\nXNodeSet.prototype.compareWithString = function (r, o) {\n  var a = this.toArray();\n\n  for (var i = 0; i < a.length; i++) {\n    var n = a[i];\n    var l = new XString(this.stringForNode(n));\n    var res = o(l, r);\n\n    if (res.booleanValue()) {\n      return res;\n    }\n  }\n\n  return new XBoolean(false);\n};\n\nXNodeSet.prototype.compareWithNumber = function (r, o) {\n  var a = this.toArray();\n\n  for (var i = 0; i < a.length; i++) {\n    var n = a[i];\n    var l = new XNumber(this.stringForNode(n));\n    var res = o(l, r);\n\n    if (res.booleanValue()) {\n      return res;\n    }\n  }\n\n  return new XBoolean(false);\n};\n\nXNodeSet.prototype.compareWithBoolean = function (r, o) {\n  return o(this.bool(), r);\n};\n\nXNodeSet.prototype.compareWithNodeSet = function (r, o) {\n  var a = this.toArray();\n\n  for (var i = 0; i < a.length; i++) {\n    var n = a[i];\n    var l = new XString(this.stringForNode(n));\n    var b = r.toArray();\n\n    for (var j = 0; j < b.length; j++) {\n      var n2 = b[j];\n      var r = new XString(this.stringForNode(n2));\n      var res = o(l, r);\n\n      if (res.booleanValue()) {\n        return res;\n      }\n    }\n  }\n\n  return new XBoolean(false);\n};\n\nXNodeSet.prototype.equals = function (r) {\n  if (Utilities.instance_of(r, XString)) {\n    return this.compareWithString(r, Operators.equals);\n  }\n\n  if (Utilities.instance_of(r, XNumber)) {\n    return this.compareWithNumber(r, Operators.equals);\n  }\n\n  if (Utilities.instance_of(r, XBoolean)) {\n    return this.compareWithBoolean(r, Operators.equals);\n  }\n\n  return this.compareWithNodeSet(r, Operators.equals);\n};\n\nXNodeSet.prototype.notequal = function (r) {\n  if (Utilities.instance_of(r, XString)) {\n    return this.compareWithString(r, Operators.notequal);\n  }\n\n  if (Utilities.instance_of(r, XNumber)) {\n    return this.compareWithNumber(r, Operators.notequal);\n  }\n\n  if (Utilities.instance_of(r, XBoolean)) {\n    return this.compareWithBoolean(r, Operators.notequal);\n  }\n\n  return this.compareWithNodeSet(r, Operators.notequal);\n};\n\nXNodeSet.prototype.lessthan = function (r) {\n  if (Utilities.instance_of(r, XString)) {\n    return this.compareWithNumber(r.number(), Operators.lessthan);\n  }\n\n  if (Utilities.instance_of(r, XNumber)) {\n    return this.compareWithNumber(r, Operators.lessthan);\n  }\n\n  if (Utilities.instance_of(r, XBoolean)) {\n    return this.compareWithBoolean(r, Operators.lessthan);\n  }\n\n  return this.compareWithNodeSet(r, Operators.lessthan);\n};\n\nXNodeSet.prototype.greaterthan = function (r) {\n  if (Utilities.instance_of(r, XString)) {\n    return this.compareWithNumber(r.number(), Operators.greaterthan);\n  }\n\n  if (Utilities.instance_of(r, XNumber)) {\n    return this.compareWithNumber(r, Operators.greaterthan);\n  }\n\n  if (Utilities.instance_of(r, XBoolean)) {\n    return this.compareWithBoolean(r, Operators.greaterthan);\n  }\n\n  return this.compareWithNodeSet(r, Operators.greaterthan);\n};\n\nXNodeSet.prototype.lessthanorequal = function (r) {\n  if (Utilities.instance_of(r, XString)) {\n    return this.compareWithNumber(r.number(), Operators.lessthanorequal);\n  }\n\n  if (Utilities.instance_of(r, XNumber)) {\n    return this.compareWithNumber(r, Operators.lessthanorequal);\n  }\n\n  if (Utilities.instance_of(r, XBoolean)) {\n    return this.compareWithBoolean(r, Operators.lessthanorequal);\n  }\n\n  return this.compareWithNodeSet(r, Operators.lessthanorequal);\n};\n\nXNodeSet.prototype.greaterthanorequal = function (r) {\n  if (Utilities.instance_of(r, XString)) {\n    return this.compareWithNumber(r.number(), Operators.greaterthanorequal);\n  }\n\n  if (Utilities.instance_of(r, XNumber)) {\n    return this.compareWithNumber(r, Operators.greaterthanorequal);\n  }\n\n  if (Utilities.instance_of(r, XBoolean)) {\n    return this.compareWithBoolean(r, Operators.greaterthanorequal);\n  }\n\n  return this.compareWithNodeSet(r, Operators.greaterthanorequal);\n};\n\nXNodeSet.prototype.union = function (r) {\n  var ns = new XNodeSet();\n  ns.tree = this.tree;\n  ns.size = this.size;\n  ns.addArray(r.toArray());\n  return ns;\n}; // XPathNamespace ////////////////////////////////////////////////////////////\n\n\nXPathNamespace.prototype = new Object();\nXPathNamespace.prototype.constructor = XPathNamespace;\nXPathNamespace.superclass = Object.prototype;\n\nfunction XPathNamespace(pre, ns, p) {\n  this.isXPathNamespace = true;\n  this.ownerDocument = p.ownerDocument;\n  this.nodeName = \"#namespace\";\n  this.prefix = pre;\n  this.localName = pre;\n  this.namespaceURI = ns;\n  this.nodeValue = ns;\n  this.ownerElement = p;\n  this.nodeType = XPathNamespace.XPATH_NAMESPACE_NODE;\n}\n\nXPathNamespace.prototype.toString = function () {\n  return \"{ \\\"\" + this.prefix + \"\\\", \\\"\" + this.namespaceURI + \"\\\" }\";\n}; // Operators /////////////////////////////////////////////////////////////////\n\n\nvar Operators = new Object();\n\nOperators.equals = function (l, r) {\n  return l.equals(r);\n};\n\nOperators.notequal = function (l, r) {\n  return l.notequal(r);\n};\n\nOperators.lessthan = function (l, r) {\n  return l.lessthan(r);\n};\n\nOperators.greaterthan = function (l, r) {\n  return l.greaterthan(r);\n};\n\nOperators.lessthanorequal = function (l, r) {\n  return l.lessthanorequal(r);\n};\n\nOperators.greaterthanorequal = function (l, r) {\n  return l.greaterthanorequal(r);\n}; // XPathContext //////////////////////////////////////////////////////////////\n\n\nXPathContext.prototype = new Object();\nXPathContext.prototype.constructor = XPathContext;\nXPathContext.superclass = Object.prototype;\n\nfunction XPathContext(vr, nr, fr) {\n  this.variableResolver = vr != null ? vr : new VariableResolver();\n  this.namespaceResolver = nr != null ? nr : new NamespaceResolver();\n  this.functionResolver = fr != null ? fr : new FunctionResolver();\n} // VariableResolver //////////////////////////////////////////////////////////\n\n\nVariableResolver.prototype = new Object();\nVariableResolver.prototype.constructor = VariableResolver;\nVariableResolver.superclass = Object.prototype;\n\nfunction VariableResolver() {}\n\nVariableResolver.prototype.getVariable = function (vn, c) {\n  var parts = Utilities.splitQName(vn);\n\n  if (parts[0] != null) {\n    parts[0] = c.namespaceResolver.getNamespace(parts[0], c.expressionContextNode);\n\n    if (parts[0] == null) {\n      throw new Error(\"Cannot resolve QName \" + fn);\n    }\n  }\n\n  return this.getVariableWithName(parts[0], parts[1], c.expressionContextNode);\n};\n\nVariableResolver.prototype.getVariableWithName = function (ns, ln, c) {\n  return null;\n}; // FunctionResolver //////////////////////////////////////////////////////////\n\n\nFunctionResolver.prototype = new Object();\nFunctionResolver.prototype.constructor = FunctionResolver;\nFunctionResolver.superclass = Object.prototype;\n\nfunction FunctionResolver(thisArg) {\n  this.thisArg = thisArg != null ? thisArg : Functions;\n  this.functions = new Object();\n  this.addStandardFunctions();\n}\n\nFunctionResolver.prototype.addStandardFunctions = function () {\n  this.functions[\"{}last\"] = Functions.last;\n  this.functions[\"{}position\"] = Functions.position;\n  this.functions[\"{}count\"] = Functions.count;\n  this.functions[\"{}id\"] = Functions.id;\n  this.functions[\"{}local-name\"] = Functions.localName;\n  this.functions[\"{}namespace-uri\"] = Functions.namespaceURI;\n  this.functions[\"{}name\"] = Functions.name;\n  this.functions[\"{}string\"] = Functions.string;\n  this.functions[\"{}concat\"] = Functions.concat;\n  this.functions[\"{}starts-with\"] = Functions.startsWith;\n  this.functions[\"{}contains\"] = Functions.contains;\n  this.functions[\"{}substring-before\"] = Functions.substringBefore;\n  this.functions[\"{}substring-after\"] = Functions.substringAfter;\n  this.functions[\"{}substring\"] = Functions.substring;\n  this.functions[\"{}string-length\"] = Functions.stringLength;\n  this.functions[\"{}normalize-space\"] = Functions.normalizeSpace;\n  this.functions[\"{}translate\"] = Functions.translate;\n  this.functions[\"{}boolean\"] = Functions.boolean_;\n  this.functions[\"{}not\"] = Functions.not;\n  this.functions[\"{}true\"] = Functions.true_;\n  this.functions[\"{}false\"] = Functions.false_;\n  this.functions[\"{}lang\"] = Functions.lang;\n  this.functions[\"{}number\"] = Functions.number;\n  this.functions[\"{}sum\"] = Functions.sum;\n  this.functions[\"{}floor\"] = Functions.floor;\n  this.functions[\"{}ceiling\"] = Functions.ceiling;\n  this.functions[\"{}round\"] = Functions.round;\n};\n\nFunctionResolver.prototype.addFunction = function (ns, ln, f) {\n  this.functions[\"{\" + ns + \"}\" + ln] = f;\n};\n\nFunctionResolver.prototype.getFunction = function (fn, c) {\n  var parts = Utilities.resolveQName(fn, c.namespaceResolver, c.contextNode, false);\n\n  if (parts[0] == null) {\n    throw new Error(\"Cannot resolve QName \" + fn);\n  }\n\n  return this.getFunctionWithName(parts[0], parts[1], c.contextNode);\n};\n\nFunctionResolver.prototype.getFunctionWithName = function (ns, ln, c) {\n  return this.functions[\"{\" + ns + \"}\" + ln];\n}; // NamespaceResolver /////////////////////////////////////////////////////////\n\n\nNamespaceResolver.prototype = new Object();\nNamespaceResolver.prototype.constructor = NamespaceResolver;\nNamespaceResolver.superclass = Object.prototype;\n\nfunction NamespaceResolver() {}\n\nNamespaceResolver.prototype.getNamespace = function (prefix, n) {\n  if (prefix == \"xml\") {\n    return XPath.XML_NAMESPACE_URI;\n  } else if (prefix == \"xmlns\") {\n    return XPath.XMLNS_NAMESPACE_URI;\n  }\n\n  if (n.nodeType == 9\n  /*Node.DOCUMENT_NODE*/\n  ) {\n      n = n.documentElement;\n    } else if (n.nodeType == 2\n  /*Node.ATTRIBUTE_NODE*/\n  ) {\n      n = PathExpr.prototype.getOwnerElement(n);\n    } else if (n.nodeType != 1\n  /*Node.ELEMENT_NODE*/\n  ) {\n      n = n.parentNode;\n    }\n\n  while (n != null && n.nodeType == 1\n  /*Node.ELEMENT_NODE*/\n  ) {\n    var nnm = n.attributes;\n\n    for (var i = 0; i < nnm.length; i++) {\n      var a = nnm.item(i);\n      var aname = a.nodeName;\n\n      if (aname == \"xmlns\" && prefix == \"\" || aname == \"xmlns:\" + prefix) {\n        return String(a.nodeValue);\n      }\n    }\n\n    n = n.parentNode;\n  }\n\n  return null;\n}; // Functions /////////////////////////////////////////////////////////////////\n\n\nvar Functions = new Object();\n\nFunctions.last = function () {\n  var c = arguments[0];\n\n  if (arguments.length != 1) {\n    throw new Error(\"Function last expects ()\");\n  }\n\n  return new XNumber(c.contextSize);\n};\n\nFunctions.position = function () {\n  var c = arguments[0];\n\n  if (arguments.length != 1) {\n    throw new Error(\"Function position expects ()\");\n  }\n\n  return new XNumber(c.contextPosition);\n};\n\nFunctions.count = function () {\n  var c = arguments[0];\n  var ns;\n\n  if (arguments.length != 2 || !Utilities.instance_of(ns = arguments[1].evaluate(c), XNodeSet)) {\n    throw new Error(\"Function count expects (node-set)\");\n  }\n\n  return new XNumber(ns.size);\n};\n\nFunctions.id = function () {\n  var c = arguments[0];\n  var id;\n\n  if (arguments.length != 2) {\n    throw new Error(\"Function id expects (object)\");\n  }\n\n  id = arguments[1].evaluate(c);\n\n  if (Utilities.instance_of(id, XNodeSet)) {\n    id = id.toArray().join(\" \");\n  } else {\n    id = id.stringValue();\n  }\n\n  var ids = id.split(/[\\x0d\\x0a\\x09\\x20]+/);\n  var count = 0;\n  var ns = new XNodeSet();\n  var doc = c.contextNode.nodeType == 9\n  /*Node.DOCUMENT_NODE*/\n  ? c.contextNode : c.contextNode.ownerDocument;\n\n  for (var i = 0; i < ids.length; i++) {\n    var n;\n\n    if (doc.getElementById) {\n      n = doc.getElementById(ids[i]);\n    } else {\n      n = Utilities.getElementById(doc, ids[i]);\n    }\n\n    if (n != null) {\n      ns.add(n);\n      count++;\n    }\n  }\n\n  return ns;\n};\n\nFunctions.localName = function () {\n  var c = arguments[0];\n  var n;\n\n  if (arguments.length == 1) {\n    n = c.contextNode;\n  } else if (arguments.length == 2) {\n    n = arguments[1].evaluate(c).first();\n  } else {\n    throw new Error(\"Function local-name expects (node-set?)\");\n  }\n\n  if (n == null) {\n    return new XString(\"\");\n  }\n\n  return new XString(n.localName ? n.localName : n.baseName);\n};\n\nFunctions.namespaceURI = function () {\n  var c = arguments[0];\n  var n;\n\n  if (arguments.length == 1) {\n    n = c.contextNode;\n  } else if (arguments.length == 2) {\n    n = arguments[1].evaluate(c).first();\n  } else {\n    throw new Error(\"Function namespace-uri expects (node-set?)\");\n  }\n\n  if (n == null) {\n    return new XString(\"\");\n  }\n\n  return new XString(n.namespaceURI);\n};\n\nFunctions.name = function () {\n  var c = arguments[0];\n  var n;\n\n  if (arguments.length == 1) {\n    n = c.contextNode;\n  } else if (arguments.length == 2) {\n    n = arguments[1].evaluate(c).first();\n  } else {\n    throw new Error(\"Function name expects (node-set?)\");\n  }\n\n  if (n == null) {\n    return new XString(\"\");\n  }\n\n  if (n.nodeType == 1\n  /*Node.ELEMENT_NODE*/\n  || n.nodeType == 2\n  /*Node.ATTRIBUTE_NODE*/\n  ) {\n      return new XString(n.nodeName);\n    } else if (n.localName == null) {\n    return new XString(\"\");\n  } else {\n    return new XString(n.localName);\n  }\n};\n\nFunctions.string = function () {\n  var c = arguments[0];\n\n  if (arguments.length == 1) {\n    return XNodeSet.prototype.stringForNode(c.contextNode);\n  } else if (arguments.length == 2) {\n    return arguments[1].evaluate(c).string();\n  }\n\n  throw new Error(\"Function string expects (object?)\");\n};\n\nFunctions.concat = function () {\n  var c = arguments[0];\n\n  if (arguments.length < 3) {\n    throw new Error(\"Function concat expects (string, string, string*)\");\n  }\n\n  var s = \"\";\n\n  for (var i = 1; i < arguments.length; i++) {\n    s += arguments[i].evaluate(c).stringValue();\n  }\n\n  return new XString(s);\n};\n\nFunctions.startsWith = function () {\n  var c = arguments[0];\n\n  if (arguments.length != 3) {\n    throw new Error(\"Function startsWith expects (string, string)\");\n  }\n\n  var s1 = arguments[1].evaluate(c).stringValue();\n  var s2 = arguments[2].evaluate(c).stringValue();\n  return new XBoolean(s1.substring(0, s2.length) == s2);\n};\n\nFunctions.contains = function () {\n  var c = arguments[0];\n\n  if (arguments.length != 3) {\n    throw new Error(\"Function contains expects (string, string)\");\n  }\n\n  var s1 = arguments[1].evaluate(c).stringValue();\n  var s2 = arguments[2].evaluate(c).stringValue();\n  return new XBoolean(s1.indexOf(s2) != -1);\n};\n\nFunctions.substringBefore = function () {\n  var c = arguments[0];\n\n  if (arguments.length != 3) {\n    throw new Error(\"Function substring-before expects (string, string)\");\n  }\n\n  var s1 = arguments[1].evaluate(c).stringValue();\n  var s2 = arguments[2].evaluate(c).stringValue();\n  return new XString(s1.substring(0, s1.indexOf(s2)));\n};\n\nFunctions.substringAfter = function () {\n  var c = arguments[0];\n\n  if (arguments.length != 3) {\n    throw new Error(\"Function substring-after expects (string, string)\");\n  }\n\n  var s1 = arguments[1].evaluate(c).stringValue();\n  var s2 = arguments[2].evaluate(c).stringValue();\n\n  if (s2.length == 0) {\n    return new XString(s1);\n  }\n\n  var i = s1.indexOf(s2);\n\n  if (i == -1) {\n    return new XString(\"\");\n  }\n\n  return new XString(s1.substring(s1.indexOf(s2) + 1));\n};\n\nFunctions.substring = function () {\n  var c = arguments[0];\n\n  if (!(arguments.length == 3 || arguments.length == 4)) {\n    throw new Error(\"Function substring expects (string, number, number?)\");\n  }\n\n  var s = arguments[1].evaluate(c).stringValue();\n  var n1 = Math.round(arguments[2].evaluate(c).numberValue()) - 1;\n  var n2 = arguments.length == 4 ? n1 + Math.round(arguments[3].evaluate(c).numberValue()) : undefined;\n  return new XString(s.substring(n1, n2));\n};\n\nFunctions.stringLength = function () {\n  var c = arguments[0];\n  var s;\n\n  if (arguments.length == 1) {\n    s = XNodeSet.prototype.stringForNode(c.contextNode);\n  } else if (arguments.length == 2) {\n    s = arguments[1].evaluate(c).stringValue();\n  } else {\n    throw new Error(\"Function string-length expects (string?)\");\n  }\n\n  return new XNumber(s.length);\n};\n\nFunctions.normalizeSpace = function () {\n  var c = arguments[0];\n  var s;\n\n  if (arguments.length == 1) {\n    s = XNodeSet.prototype.stringForNode(c.contextNode);\n  } else if (arguments.length == 2) {\n    s = arguments[1].evaluate(c).stringValue();\n  } else {\n    throw new Error(\"Function normalize-space expects (string?)\");\n  }\n\n  var i = 0;\n  var j = s.length - 1;\n\n  while (Utilities.isSpace(s.charCodeAt(j))) {\n    j--;\n  }\n\n  var t = \"\";\n\n  while (i <= j && Utilities.isSpace(s.charCodeAt(i))) {\n    i++;\n  }\n\n  while (i <= j) {\n    if (Utilities.isSpace(s.charCodeAt(i))) {\n      t += \" \";\n\n      while (i <= j && Utilities.isSpace(s.charCodeAt(i))) {\n        i++;\n      }\n    } else {\n      t += s.charAt(i);\n      i++;\n    }\n  }\n\n  return new XString(t);\n};\n\nFunctions.translate = function () {\n  var c = arguments[0];\n\n  if (arguments.length != 4) {\n    throw new Error(\"Function translate expects (string, string, string)\");\n  }\n\n  var s1 = arguments[1].evaluate(c).stringValue();\n  var s2 = arguments[2].evaluate(c).stringValue();\n  var s3 = arguments[3].evaluate(c).stringValue();\n  var map = [];\n\n  for (var i = 0; i < s2.length; i++) {\n    var j = s2.charCodeAt(i);\n\n    if (map[j] == undefined) {\n      var k = i > s3.length ? \"\" : s3.charAt(i);\n      map[j] = k;\n    }\n  }\n\n  var t = \"\";\n\n  for (var i = 0; i < s1.length; i++) {\n    var c = s1.charCodeAt(i);\n    var r = map[c];\n\n    if (r == undefined) {\n      t += s1.charAt(i);\n    } else {\n      t += r;\n    }\n  }\n\n  return new XString(t);\n};\n\nFunctions.boolean_ = function () {\n  var c = arguments[0];\n\n  if (arguments.length != 2) {\n    throw new Error(\"Function boolean expects (object)\");\n  }\n\n  return arguments[1].evaluate(c).bool();\n};\n\nFunctions.not = function () {\n  var c = arguments[0];\n\n  if (arguments.length != 2) {\n    throw new Error(\"Function not expects (object)\");\n  }\n\n  return arguments[1].evaluate(c).bool().not();\n};\n\nFunctions.true_ = function () {\n  if (arguments.length != 1) {\n    throw new Error(\"Function true expects ()\");\n  }\n\n  return new XBoolean(true);\n};\n\nFunctions.false_ = function () {\n  if (arguments.length != 1) {\n    throw new Error(\"Function false expects ()\");\n  }\n\n  return new XBoolean(false);\n};\n\nFunctions.lang = function () {\n  var c = arguments[0];\n\n  if (arguments.length != 2) {\n    throw new Error(\"Function lang expects (string)\");\n  }\n\n  var lang;\n\n  for (var n = c.contextNode; n != null && n.nodeType != 9\n  /*Node.DOCUMENT_NODE*/\n  ; n = n.parentNode) {\n    var a = n.getAttributeNS(XPath.XML_NAMESPACE_URI, \"lang\");\n\n    if (a != null) {\n      lang = String(a);\n      break;\n    }\n  }\n\n  if (lang == null) {\n    return new XBoolean(false);\n  }\n\n  var s = arguments[1].evaluate(c).stringValue();\n  return new XBoolean(lang.substring(0, s.length) == s && (lang.length == s.length || lang.charAt(s.length) == '-'));\n};\n\nFunctions.number = function () {\n  var c = arguments[0];\n\n  if (!(arguments.length == 1 || arguments.length == 2)) {\n    throw new Error(\"Function number expects (object?)\");\n  }\n\n  if (arguments.length == 1) {\n    return new XNumber(XNodeSet.prototype.stringForNode(c.contextNode));\n  }\n\n  return arguments[1].evaluate(c).number();\n};\n\nFunctions.sum = function () {\n  var c = arguments[0];\n  var ns;\n\n  if (arguments.length != 2 || !Utilities.instance_of(ns = arguments[1].evaluate(c), XNodeSet)) {\n    throw new Error(\"Function sum expects (node-set)\");\n  }\n\n  ns = ns.toArray();\n  var n = 0;\n\n  for (var i = 0; i < ns.length; i++) {\n    n += new XNumber(XNodeSet.prototype.stringForNode(ns[i])).numberValue();\n  }\n\n  return new XNumber(n);\n};\n\nFunctions.floor = function () {\n  var c = arguments[0];\n\n  if (arguments.length != 2) {\n    throw new Error(\"Function floor expects (number)\");\n  }\n\n  return new XNumber(Math.floor(arguments[1].evaluate(c).numberValue()));\n};\n\nFunctions.ceiling = function () {\n  var c = arguments[0];\n\n  if (arguments.length != 2) {\n    throw new Error(\"Function ceiling expects (number)\");\n  }\n\n  return new XNumber(Math.ceil(arguments[1].evaluate(c).numberValue()));\n};\n\nFunctions.round = function () {\n  var c = arguments[0];\n\n  if (arguments.length != 2) {\n    throw new Error(\"Function round expects (number)\");\n  }\n\n  return new XNumber(Math.round(arguments[1].evaluate(c).numberValue()));\n}; // Utilities /////////////////////////////////////////////////////////////////\n\n\nvar Utilities = new Object();\n\nUtilities.splitQName = function (qn) {\n  var i = qn.indexOf(\":\");\n\n  if (i == -1) {\n    return [null, qn];\n  }\n\n  return [qn.substring(0, i), qn.substring(i + 1)];\n};\n\nUtilities.resolveQName = function (qn, nr, n, useDefault) {\n  var parts = Utilities.splitQName(qn);\n\n  if (parts[0] != null) {\n    parts[0] = nr.getNamespace(parts[0], n);\n  } else {\n    if (useDefault) {\n      parts[0] = nr.getNamespace(\"\", n);\n\n      if (parts[0] == null) {\n        parts[0] = \"\";\n      }\n    } else {\n      parts[0] = \"\";\n    }\n  }\n\n  return parts;\n};\n\nUtilities.isSpace = function (c) {\n  return c == 0x9 || c == 0xd || c == 0xa || c == 0x20;\n};\n\nUtilities.isLetter = function (c) {\n  return c >= 0x0041 && c <= 0x005A || c >= 0x0061 && c <= 0x007A || c >= 0x00C0 && c <= 0x00D6 || c >= 0x00D8 && c <= 0x00F6 || c >= 0x00F8 && c <= 0x00FF || c >= 0x0100 && c <= 0x0131 || c >= 0x0134 && c <= 0x013E || c >= 0x0141 && c <= 0x0148 || c >= 0x014A && c <= 0x017E || c >= 0x0180 && c <= 0x01C3 || c >= 0x01CD && c <= 0x01F0 || c >= 0x01F4 && c <= 0x01F5 || c >= 0x01FA && c <= 0x0217 || c >= 0x0250 && c <= 0x02A8 || c >= 0x02BB && c <= 0x02C1 || c == 0x0386 || c >= 0x0388 && c <= 0x038A || c == 0x038C || c >= 0x038E && c <= 0x03A1 || c >= 0x03A3 && c <= 0x03CE || c >= 0x03D0 && c <= 0x03D6 || c == 0x03DA || c == 0x03DC || c == 0x03DE || c == 0x03E0 || c >= 0x03E2 && c <= 0x03F3 || c >= 0x0401 && c <= 0x040C || c >= 0x040E && c <= 0x044F || c >= 0x0451 && c <= 0x045C || c >= 0x045E && c <= 0x0481 || c >= 0x0490 && c <= 0x04C4 || c >= 0x04C7 && c <= 0x04C8 || c >= 0x04CB && c <= 0x04CC || c >= 0x04D0 && c <= 0x04EB || c >= 0x04EE && c <= 0x04F5 || c >= 0x04F8 && c <= 0x04F9 || c >= 0x0531 && c <= 0x0556 || c == 0x0559 || c >= 0x0561 && c <= 0x0586 || c >= 0x05D0 && c <= 0x05EA || c >= 0x05F0 && c <= 0x05F2 || c >= 0x0621 && c <= 0x063A || c >= 0x0641 && c <= 0x064A || c >= 0x0671 && c <= 0x06B7 || c >= 0x06BA && c <= 0x06BE || c >= 0x06C0 && c <= 0x06CE || c >= 0x06D0 && c <= 0x06D3 || c == 0x06D5 || c >= 0x06E5 && c <= 0x06E6 || c >= 0x0905 && c <= 0x0939 || c == 0x093D || c >= 0x0958 && c <= 0x0961 || c >= 0x0985 && c <= 0x098C || c >= 0x098F && c <= 0x0990 || c >= 0x0993 && c <= 0x09A8 || c >= 0x09AA && c <= 0x09B0 || c == 0x09B2 || c >= 0x09B6 && c <= 0x09B9 || c >= 0x09DC && c <= 0x09DD || c >= 0x09DF && c <= 0x09E1 || c >= 0x09F0 && c <= 0x09F1 || c >= 0x0A05 && c <= 0x0A0A || c >= 0x0A0F && c <= 0x0A10 || c >= 0x0A13 && c <= 0x0A28 || c >= 0x0A2A && c <= 0x0A30 || c >= 0x0A32 && c <= 0x0A33 || c >= 0x0A35 && c <= 0x0A36 || c >= 0x0A38 && c <= 0x0A39 || c >= 0x0A59 && c <= 0x0A5C || c == 0x0A5E || c >= 0x0A72 && c <= 0x0A74 || c >= 0x0A85 && c <= 0x0A8B || c == 0x0A8D || c >= 0x0A8F && c <= 0x0A91 || c >= 0x0A93 && c <= 0x0AA8 || c >= 0x0AAA && c <= 0x0AB0 || c >= 0x0AB2 && c <= 0x0AB3 || c >= 0x0AB5 && c <= 0x0AB9 || c == 0x0ABD || c == 0x0AE0 || c >= 0x0B05 && c <= 0x0B0C || c >= 0x0B0F && c <= 0x0B10 || c >= 0x0B13 && c <= 0x0B28 || c >= 0x0B2A && c <= 0x0B30 || c >= 0x0B32 && c <= 0x0B33 || c >= 0x0B36 && c <= 0x0B39 || c == 0x0B3D || c >= 0x0B5C && c <= 0x0B5D || c >= 0x0B5F && c <= 0x0B61 || c >= 0x0B85 && c <= 0x0B8A || c >= 0x0B8E && c <= 0x0B90 || c >= 0x0B92 && c <= 0x0B95 || c >= 0x0B99 && c <= 0x0B9A || c == 0x0B9C || c >= 0x0B9E && c <= 0x0B9F || c >= 0x0BA3 && c <= 0x0BA4 || c >= 0x0BA8 && c <= 0x0BAA || c >= 0x0BAE && c <= 0x0BB5 || c >= 0x0BB7 && c <= 0x0BB9 || c >= 0x0C05 && c <= 0x0C0C || c >= 0x0C0E && c <= 0x0C10 || c >= 0x0C12 && c <= 0x0C28 || c >= 0x0C2A && c <= 0x0C33 || c >= 0x0C35 && c <= 0x0C39 || c >= 0x0C60 && c <= 0x0C61 || c >= 0x0C85 && c <= 0x0C8C || c >= 0x0C8E && c <= 0x0C90 || c >= 0x0C92 && c <= 0x0CA8 || c >= 0x0CAA && c <= 0x0CB3 || c >= 0x0CB5 && c <= 0x0CB9 || c == 0x0CDE || c >= 0x0CE0 && c <= 0x0CE1 || c >= 0x0D05 && c <= 0x0D0C || c >= 0x0D0E && c <= 0x0D10 || c >= 0x0D12 && c <= 0x0D28 || c >= 0x0D2A && c <= 0x0D39 || c >= 0x0D60 && c <= 0x0D61 || c >= 0x0E01 && c <= 0x0E2E || c == 0x0E30 || c >= 0x0E32 && c <= 0x0E33 || c >= 0x0E40 && c <= 0x0E45 || c >= 0x0E81 && c <= 0x0E82 || c == 0x0E84 || c >= 0x0E87 && c <= 0x0E88 || c == 0x0E8A || c == 0x0E8D || c >= 0x0E94 && c <= 0x0E97 || c >= 0x0E99 && c <= 0x0E9F || c >= 0x0EA1 && c <= 0x0EA3 || c == 0x0EA5 || c == 0x0EA7 || c >= 0x0EAA && c <= 0x0EAB || c >= 0x0EAD && c <= 0x0EAE || c == 0x0EB0 || c >= 0x0EB2 && c <= 0x0EB3 || c == 0x0EBD || c >= 0x0EC0 && c <= 0x0EC4 || c >= 0x0F40 && c <= 0x0F47 || c >= 0x0F49 && c <= 0x0F69 || c >= 0x10A0 && c <= 0x10C5 || c >= 0x10D0 && c <= 0x10F6 || c == 0x1100 || c >= 0x1102 && c <= 0x1103 || c >= 0x1105 && c <= 0x1107 || c == 0x1109 || c >= 0x110B && c <= 0x110C || c >= 0x110E && c <= 0x1112 || c == 0x113C || c == 0x113E || c == 0x1140 || c == 0x114C || c == 0x114E || c == 0x1150 || c >= 0x1154 && c <= 0x1155 || c == 0x1159 || c >= 0x115F && c <= 0x1161 || c == 0x1163 || c == 0x1165 || c == 0x1167 || c == 0x1169 || c >= 0x116D && c <= 0x116E || c >= 0x1172 && c <= 0x1173 || c == 0x1175 || c == 0x119E || c == 0x11A8 || c == 0x11AB || c >= 0x11AE && c <= 0x11AF || c >= 0x11B7 && c <= 0x11B8 || c == 0x11BA || c >= 0x11BC && c <= 0x11C2 || c == 0x11EB || c == 0x11F0 || c == 0x11F9 || c >= 0x1E00 && c <= 0x1E9B || c >= 0x1EA0 && c <= 0x1EF9 || c >= 0x1F00 && c <= 0x1F15 || c >= 0x1F18 && c <= 0x1F1D || c >= 0x1F20 && c <= 0x1F45 || c >= 0x1F48 && c <= 0x1F4D || c >= 0x1F50 && c <= 0x1F57 || c == 0x1F59 || c == 0x1F5B || c == 0x1F5D || c >= 0x1F5F && c <= 0x1F7D || c >= 0x1F80 && c <= 0x1FB4 || c >= 0x1FB6 && c <= 0x1FBC || c == 0x1FBE || c >= 0x1FC2 && c <= 0x1FC4 || c >= 0x1FC6 && c <= 0x1FCC || c >= 0x1FD0 && c <= 0x1FD3 || c >= 0x1FD6 && c <= 0x1FDB || c >= 0x1FE0 && c <= 0x1FEC || c >= 0x1FF2 && c <= 0x1FF4 || c >= 0x1FF6 && c <= 0x1FFC || c == 0x2126 || c >= 0x212A && c <= 0x212B || c == 0x212E || c >= 0x2180 && c <= 0x2182 || c >= 0x3041 && c <= 0x3094 || c >= 0x30A1 && c <= 0x30FA || c >= 0x3105 && c <= 0x312C || c >= 0xAC00 && c <= 0xD7A3 || c >= 0x4E00 && c <= 0x9FA5 || c == 0x3007 || c >= 0x3021 && c <= 0x3029;\n};\n\nUtilities.isNCNameChar = function (c) {\n  return c >= 0x0030 && c <= 0x0039 || c >= 0x0660 && c <= 0x0669 || c >= 0x06F0 && c <= 0x06F9 || c >= 0x0966 && c <= 0x096F || c >= 0x09E6 && c <= 0x09EF || c >= 0x0A66 && c <= 0x0A6F || c >= 0x0AE6 && c <= 0x0AEF || c >= 0x0B66 && c <= 0x0B6F || c >= 0x0BE7 && c <= 0x0BEF || c >= 0x0C66 && c <= 0x0C6F || c >= 0x0CE6 && c <= 0x0CEF || c >= 0x0D66 && c <= 0x0D6F || c >= 0x0E50 && c <= 0x0E59 || c >= 0x0ED0 && c <= 0x0ED9 || c >= 0x0F20 && c <= 0x0F29 || c == 0x002E || c == 0x002D || c == 0x005F || Utilities.isLetter(c) || c >= 0x0300 && c <= 0x0345 || c >= 0x0360 && c <= 0x0361 || c >= 0x0483 && c <= 0x0486 || c >= 0x0591 && c <= 0x05A1 || c >= 0x05A3 && c <= 0x05B9 || c >= 0x05BB && c <= 0x05BD || c == 0x05BF || c >= 0x05C1 && c <= 0x05C2 || c == 0x05C4 || c >= 0x064B && c <= 0x0652 || c == 0x0670 || c >= 0x06D6 && c <= 0x06DC || c >= 0x06DD && c <= 0x06DF || c >= 0x06E0 && c <= 0x06E4 || c >= 0x06E7 && c <= 0x06E8 || c >= 0x06EA && c <= 0x06ED || c >= 0x0901 && c <= 0x0903 || c == 0x093C || c >= 0x093E && c <= 0x094C || c == 0x094D || c >= 0x0951 && c <= 0x0954 || c >= 0x0962 && c <= 0x0963 || c >= 0x0981 && c <= 0x0983 || c == 0x09BC || c == 0x09BE || c == 0x09BF || c >= 0x09C0 && c <= 0x09C4 || c >= 0x09C7 && c <= 0x09C8 || c >= 0x09CB && c <= 0x09CD || c == 0x09D7 || c >= 0x09E2 && c <= 0x09E3 || c == 0x0A02 || c == 0x0A3C || c == 0x0A3E || c == 0x0A3F || c >= 0x0A40 && c <= 0x0A42 || c >= 0x0A47 && c <= 0x0A48 || c >= 0x0A4B && c <= 0x0A4D || c >= 0x0A70 && c <= 0x0A71 || c >= 0x0A81 && c <= 0x0A83 || c == 0x0ABC || c >= 0x0ABE && c <= 0x0AC5 || c >= 0x0AC7 && c <= 0x0AC9 || c >= 0x0ACB && c <= 0x0ACD || c >= 0x0B01 && c <= 0x0B03 || c == 0x0B3C || c >= 0x0B3E && c <= 0x0B43 || c >= 0x0B47 && c <= 0x0B48 || c >= 0x0B4B && c <= 0x0B4D || c >= 0x0B56 && c <= 0x0B57 || c >= 0x0B82 && c <= 0x0B83 || c >= 0x0BBE && c <= 0x0BC2 || c >= 0x0BC6 && c <= 0x0BC8 || c >= 0x0BCA && c <= 0x0BCD || c == 0x0BD7 || c >= 0x0C01 && c <= 0x0C03 || c >= 0x0C3E && c <= 0x0C44 || c >= 0x0C46 && c <= 0x0C48 || c >= 0x0C4A && c <= 0x0C4D || c >= 0x0C55 && c <= 0x0C56 || c >= 0x0C82 && c <= 0x0C83 || c >= 0x0CBE && c <= 0x0CC4 || c >= 0x0CC6 && c <= 0x0CC8 || c >= 0x0CCA && c <= 0x0CCD || c >= 0x0CD5 && c <= 0x0CD6 || c >= 0x0D02 && c <= 0x0D03 || c >= 0x0D3E && c <= 0x0D43 || c >= 0x0D46 && c <= 0x0D48 || c >= 0x0D4A && c <= 0x0D4D || c == 0x0D57 || c == 0x0E31 || c >= 0x0E34 && c <= 0x0E3A || c >= 0x0E47 && c <= 0x0E4E || c == 0x0EB1 || c >= 0x0EB4 && c <= 0x0EB9 || c >= 0x0EBB && c <= 0x0EBC || c >= 0x0EC8 && c <= 0x0ECD || c >= 0x0F18 && c <= 0x0F19 || c == 0x0F35 || c == 0x0F37 || c == 0x0F39 || c == 0x0F3E || c == 0x0F3F || c >= 0x0F71 && c <= 0x0F84 || c >= 0x0F86 && c <= 0x0F8B || c >= 0x0F90 && c <= 0x0F95 || c == 0x0F97 || c >= 0x0F99 && c <= 0x0FAD || c >= 0x0FB1 && c <= 0x0FB7 || c == 0x0FB9 || c >= 0x20D0 && c <= 0x20DC || c == 0x20E1 || c >= 0x302A && c <= 0x302F || c == 0x3099 || c == 0x309A || c == 0x00B7 || c == 0x02D0 || c == 0x02D1 || c == 0x0387 || c == 0x0640 || c == 0x0E46 || c == 0x0EC6 || c == 0x3005 || c >= 0x3031 && c <= 0x3035 || c >= 0x309D && c <= 0x309E || c >= 0x30FC && c <= 0x30FE;\n};\n\nUtilities.coalesceText = function (n) {\n  for (var m = n.firstChild; m != null; m = m.nextSibling) {\n    if (m.nodeType == 3\n    /*Node.TEXT_NODE*/\n    || m.nodeType == 4\n    /*Node.CDATA_SECTION_NODE*/\n    ) {\n        var s = m.nodeValue;\n        var first = m;\n        m = m.nextSibling;\n\n        while (m != null && (m.nodeType == 3\n        /*Node.TEXT_NODE*/\n        || m.nodeType == 4\n        /*Node.CDATA_SECTION_NODE*/\n        )) {\n          s += m.nodeValue;\n          var del = m;\n          m = m.nextSibling;\n          del.parentNode.removeChild(del);\n        }\n\n        if (first.nodeType == 4\n        /*Node.CDATA_SECTION_NODE*/\n        ) {\n            var p = first.parentNode;\n\n            if (first.nextSibling == null) {\n              p.removeChild(first);\n              p.appendChild(p.ownerDocument.createTextNode(s));\n            } else {\n              var next = first.nextSibling;\n              p.removeChild(first);\n              p.insertBefore(p.ownerDocument.createTextNode(s), next);\n            }\n          } else {\n          first.nodeValue = s;\n        }\n\n        if (m == null) {\n          break;\n        }\n      } else if (m.nodeType == 1\n    /*Node.ELEMENT_NODE*/\n    ) {\n        Utilities.coalesceText(m);\n      }\n  }\n};\n\nUtilities.instance_of = function (o, c) {\n  while (o != null) {\n    if (o.constructor === c) {\n      return true;\n    }\n\n    if (o === Object) {\n      return false;\n    }\n\n    o = o.constructor.superclass;\n  }\n\n  return false;\n};\n\nUtilities.getElementById = function (n, id) {\n  // Note that this does not check the DTD to check for actual\n  // attributes of type ID, so this may be a bit wrong.\n  if (n.nodeType == 1\n  /*Node.ELEMENT_NODE*/\n  ) {\n      if (n.getAttribute(\"id\") == id || n.getAttributeNS(null, \"id\") == id) {\n        return n;\n      }\n    }\n\n  for (var m = n.firstChild; m != null; m = m.nextSibling) {\n    var res = Utilities.getElementById(m, id);\n\n    if (res != null) {\n      return res;\n    }\n  }\n\n  return null;\n}; // XPathException ////////////////////////////////////////////////////////////\n\n\nXPathException.prototype = {};\nXPathException.prototype.constructor = XPathException;\nXPathException.superclass = Object.prototype;\n\nfunction XPathException(c, e) {\n  this.code = c;\n  this.exception = e;\n}\n\nXPathException.prototype.toString = function () {\n  var msg = this.exception ? \": \" + this.exception.toString() : \"\";\n\n  switch (this.code) {\n    case XPathException.INVALID_EXPRESSION_ERR:\n      return \"Invalid expression\" + msg;\n\n    case XPathException.TYPE_ERR:\n      return \"Type error\" + msg;\n  }\n};\n\nXPathException.INVALID_EXPRESSION_ERR = 51;\nXPathException.TYPE_ERR = 52; // XPathExpression ///////////////////////////////////////////////////////////\n\nXPathExpression.prototype = {};\nXPathExpression.prototype.constructor = XPathExpression;\nXPathExpression.superclass = Object.prototype;\n\nfunction XPathExpression(e, r, p) {\n  this.xpath = p.parse(e);\n  this.context = new XPathContext();\n  this.context.namespaceResolver = new XPathNSResolverWrapper(r);\n}\n\nXPathExpression.prototype.evaluate = function (n, t, res) {\n  this.context.expressionContextNode = n;\n  var result = this.xpath.evaluate(this.context);\n  return new XPathResult(result, t);\n}; // XPathNSResolverWrapper ////////////////////////////////////////////////////\n\n\nXPathNSResolverWrapper.prototype = {};\nXPathNSResolverWrapper.prototype.constructor = XPathNSResolverWrapper;\nXPathNSResolverWrapper.superclass = Object.prototype;\n\nfunction XPathNSResolverWrapper(r) {\n  this.xpathNSResolver = r;\n}\n\nXPathNSResolverWrapper.prototype.getNamespace = function (prefix, n) {\n  if (this.xpathNSResolver == null) {\n    return null;\n  }\n\n  return this.xpathNSResolver.lookupNamespaceURI(prefix);\n}; // NodeXPathNSResolver ///////////////////////////////////////////////////////\n\n\nNodeXPathNSResolver.prototype = {};\nNodeXPathNSResolver.prototype.constructor = NodeXPathNSResolver;\nNodeXPathNSResolver.superclass = Object.prototype;\n\nfunction NodeXPathNSResolver(n) {\n  this.node = n;\n  this.namespaceResolver = new NamespaceResolver();\n}\n\nNodeXPathNSResolver.prototype.lookupNamespaceURI = function (prefix) {\n  return this.namespaceResolver.getNamespace(prefix, this.node);\n}; // XPathResult ///////////////////////////////////////////////////////////////\n\n\nXPathResult.prototype = {};\nXPathResult.prototype.constructor = XPathResult;\nXPathResult.superclass = Object.prototype;\n\nfunction XPathResult(v, t) {\n  if (t == XPathResult.ANY_TYPE) {\n    if (v.constructor === XString) {\n      t = XPathResult.STRING_TYPE;\n    } else if (v.constructor === XNumber) {\n      t = XPathResult.NUMBER_TYPE;\n    } else if (v.constructor === XBoolean) {\n      t = XPathResult.BOOLEAN_TYPE;\n    } else if (v.constructor === XNodeSet) {\n      t = XPathResult.UNORDERED_NODE_ITERATOR_TYPE;\n    }\n  }\n\n  this.resultType = t;\n\n  switch (t) {\n    case XPathResult.NUMBER_TYPE:\n      this.numberValue = v.numberValue();\n      return;\n\n    case XPathResult.STRING_TYPE:\n      this.stringValue = v.stringValue();\n      return;\n\n    case XPathResult.BOOLEAN_TYPE:\n      this.booleanValue = v.booleanValue();\n      return;\n\n    case XPathResult.ANY_UNORDERED_NODE_TYPE:\n    case XPathResult.FIRST_ORDERED_NODE_TYPE:\n      if (v.constructor === XNodeSet) {\n        this.singleNodeValue = v.first();\n        return;\n      }\n\n      break;\n\n    case XPathResult.UNORDERED_NODE_ITERATOR_TYPE:\n    case XPathResult.ORDERED_NODE_ITERATOR_TYPE:\n      if (v.constructor === XNodeSet) {\n        this.invalidIteratorState = false;\n        this.nodes = v.toArray();\n        this.iteratorIndex = 0;\n        return;\n      }\n\n      break;\n\n    case XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE:\n    case XPathResult.ORDERED_NODE_SNAPSHOT_TYPE:\n      if (v.constructor === XNodeSet) {\n        this.nodes = v.toArray();\n        this.snapshotLength = this.nodes.length;\n        return;\n      }\n\n      break;\n  }\n\n  throw new XPathException(XPathException.TYPE_ERR);\n}\n\n;\n\nXPathResult.prototype.iterateNext = function () {\n  if (this.resultType != XPathResult.UNORDERED_NODE_ITERATOR_TYPE && this.resultType != XPathResult.ORDERED_NODE_ITERATOR_TYPE) {\n    throw new XPathException(XPathException.TYPE_ERR);\n  }\n\n  return this.nodes[this.iteratorIndex++];\n};\n\nXPathResult.prototype.snapshotItem = function (i) {\n  if (this.resultType != XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE && this.resultType != XPathResult.ORDERED_NODE_SNAPSHOT_TYPE) {\n    throw new XPathException(XPathException.TYPE_ERR);\n  }\n\n  return this.nodes[i];\n};\n\nXPathResult.ANY_TYPE = 0;\nXPathResult.NUMBER_TYPE = 1;\nXPathResult.STRING_TYPE = 2;\nXPathResult.BOOLEAN_TYPE = 3;\nXPathResult.UNORDERED_NODE_ITERATOR_TYPE = 4;\nXPathResult.ORDERED_NODE_ITERATOR_TYPE = 5;\nXPathResult.UNORDERED_NODE_SNAPSHOT_TYPE = 6;\nXPathResult.ORDERED_NODE_SNAPSHOT_TYPE = 7;\nXPathResult.ANY_UNORDERED_NODE_TYPE = 8;\nXPathResult.FIRST_ORDERED_NODE_TYPE = 9; // DOM 3 XPath support ///////////////////////////////////////////////////////\n\nfunction installDOM3XPathSupport(doc, p) {\n  doc.createExpression = function (e, r) {\n    try {\n      return new XPathExpression(e, r, p);\n    } catch (e) {\n      throw new XPathException(XPathException.INVALID_EXPRESSION_ERR, e);\n    }\n  };\n\n  doc.createNSResolver = function (n) {\n    return new NodeXPathNSResolver(n);\n  };\n\n  doc.evaluate = function (e, cn, r, t, res) {\n    if (t < 0 || t > 9) {\n      throw {\n        code: 0,\n        toString: function () {\n          return \"Request type not supported\";\n        }\n      };\n    }\n\n    return doc.createExpression(e, r, p).evaluate(cn, t, res);\n  };\n}\n\n; // ---------------------------------------------------------------------------\n// Install DOM 3 XPath support for the current document.\n\ntry {\n  var shouldInstall = true;\n\n  try {\n    if (document.implementation && document.implementation.hasFeature && document.implementation.hasFeature(\"XPath\", null)) {\n      shouldInstall = false;\n    }\n  } catch (e) {}\n\n  if (shouldInstall) {\n    installDOM3XPathSupport(document, new XPathParser());\n  }\n} catch (e) {}\n\nfunction SelectNodes(doc, xpath) {\n  var parser = new XPathParser();\n  var xpath = parser.parse(xpath);\n  var context = new XPathContext();\n\n  if (doc.documentElement) {\n    context.expressionContextNode = doc.documentElement;\n  } else {\n    context.expressionContextNode = doc;\n  }\n\n  var res = xpath.evaluate(context);\n  return res.toArray();\n}\n\nmodule.exports = SelectNodes;","map":{"version":3,"sources":["/Users/ryandavis/Development/reactapp/expresstimes/node_modules/xpath.js/xpath.js"],"names":["XPathParser","prototype","Object","constructor","superclass","init","reduceActions","rhs","OrOperation","AndOperation","EqualsOperation","NotEqualOperation","LessThanOperation","GreaterThanOperation","LessThanOrEqualOperation","GreaterThanOrEqualOperation","PlusOperation","MinusOperation","MultiplyOperation","DivOperation","ModOperation","UnaryMinusOperation","BarOperation","PathExpr","undefined","locationPath","steps","unshift","Step","DESCENDANTORSELF","NodeTest","NODE","Utilities","instance_of","filterPredicates","push","XString","XNumber","FunctionCall","LocationPath","absolute","CHILD","ANCESTOR","ANCESTORORSELF","ATTRIBUTE","DESCENDANT","FOLLOWING","FOLLOWINGSIBLING","NAMESPACE","PARENT","PRECEDING","PRECEDINGSIBLING","SELF","COMMENT","TEXT","PI","VariableReference","NAMETESTANY","prefix","substring","indexOf","NAMETESTPREFIXANY","NAMETESTQNAME","actionTable","actionTableNumber","gotoTable","productions","DOUBLEDOT","DOUBLECOLON","DOUBLESLASH","NOTEQUAL","LESSTHANOREQUAL","GREATERTHANOREQUAL","AND","OR","MOD","DIV","MULTIPLYOPERATOR","FUNCTIONNAME","AXISNAME","LITERAL","NUMBER","ASTERISKNAMETEST","QNAME","NCNAMECOLONASTERISK","NODETYPE","PROCESSINGINSTRUCTIONWITHLITERAL","EQUALS","LESSTHAN","GREATERTHAN","PLUS","MINUS","BAR","SLASH","LEFTPARENTHESIS","RIGHTPARENTHESIS","COMMA","AT","LEFTBRACKET","RIGHTBRACKET","DOT","DOLLAR","tokenize","s1","types","values","s","pos","c","charAt","length","number","delimiter","literal","last","isLetter","charCodeAt","name","isNCNameChar","Error","SHIFT","REDUCE","ACCEPT","parse","res","tokenPos","state","tokenType","tokenValue","a","t","num","i","pop","s_","XPath","e","expression","toString","evaluate","contextNode","expressionContextNode","contextSize","contextPosition","caseInsensitive","doc","nodeType","ownerDocument","implementation","hasFeature","XML_NAMESPACE_URI","XMLNS_NAMESPACE_URI","Expression","UnaryOperation","arguments","call","negate","BinaryOperation","lhs","b","bool","booleanValue","equals","notequal","lessthan","greaterthan","lessthanorequal","greaterthanorequal","plus","minus","multiply","div","mod","nodeset","union","filter","filterPreds","locpath","nodes","xpc","XPathContext","variableResolver","functionResolver","namespaceResolver","virtualRoot","ns","XNodeSet","toArray","j","pred","newNodes","predicateMatches","n","parentNode","step","newLocalContext","axis","m","getOwnerElement","nodeTest","matches","nnm","attributes","k","item","tmpContext","firstChild","nextSibling","st","attr","nm","String","value","pre","nsn","NamespaceNode","outer","previousSibling","predicates","localCtx","getLocalCtx","addArray","val","numberValue","ownerElement","selectSingleNode","elts","getElementsByTagName","elt","an","abs","nodetest","preds","type","NAMETESTRESOLVEDANY","NAMETESTRESOLVEDNAME","namespaceURI","XPathNamespace","XPATH_NAMESPACE_NODE","getNamespace","test","resolveQName","node","nodeName","toLowerCase","v","variable","getVariable","fn","args","functionName","f","getFunction","concat","apply","thisArg","str","string","XBoolean","stringValue","r","compareWithString","Operators","compareWithNumber","Number","Boolean","not","compareWithBoolean","AVLTree","left","right","depth","balance","ldepth","rdepth","lldepth","lrdepth","rotateRR","rotateLL","rrdepth","rldepth","nodeBefore","rightBefore","updateInNewLocation","leftBefore","getDepthFromChildren","order","n1","n2","d1","d2","m1","m2","add","o","ret","tree","size","p","first","stringForNode","documentElement","stringForNodeRec","isNamespaceNode","namespace","nodeValue","added","toArrayRec","l","compareWithNodeSet","isXPathNamespace","localName","vr","nr","fr","VariableResolver","NamespaceResolver","FunctionResolver","vn","parts","splitQName","getVariableWithName","ln","Functions","functions","addStandardFunctions","position","count","id","startsWith","contains","substringBefore","substringAfter","stringLength","normalizeSpace","translate","boolean_","true_","false_","lang","sum","floor","ceiling","round","addFunction","getFunctionWithName","aname","join","ids","split","getElementById","baseName","s2","Math","isSpace","s3","map","getAttributeNS","ceil","qn","useDefault","coalesceText","del","removeChild","appendChild","createTextNode","next","insertBefore","getAttribute","XPathException","code","exception","msg","INVALID_EXPRESSION_ERR","TYPE_ERR","XPathExpression","xpath","context","XPathNSResolverWrapper","result","XPathResult","xpathNSResolver","lookupNamespaceURI","NodeXPathNSResolver","ANY_TYPE","STRING_TYPE","NUMBER_TYPE","BOOLEAN_TYPE","UNORDERED_NODE_ITERATOR_TYPE","resultType","ANY_UNORDERED_NODE_TYPE","FIRST_ORDERED_NODE_TYPE","singleNodeValue","ORDERED_NODE_ITERATOR_TYPE","invalidIteratorState","iteratorIndex","UNORDERED_NODE_SNAPSHOT_TYPE","ORDERED_NODE_SNAPSHOT_TYPE","snapshotLength","iterateNext","snapshotItem","installDOM3XPathSupport","createExpression","createNSResolver","cn","shouldInstall","document","SelectNodes","parser","module","exports"],"mappings":"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","sourcesContent":["/*\r\n * xpath.js\r\n *\r\n * An XPath 1.0 library for JavaScript.\r\n *\r\n * Cameron McCormack <cam (at) mcc.id.au>\r\n *\r\n *\r\n * Revision 20: April 26, 2011\r\n *   Fixed a typo resulting in FIRST_ORDERED_NODE_TYPE results being wrong,\r\n *   thanks to <shi_a009 (at) hotmail.com>.\r\n *\r\n * Revision 19: November 29, 2005\r\n *   Nodesets now store their nodes in a height balanced tree, increasing\r\n *   performance for the common case of selecting nodes in document order,\r\n *   thanks to Sébastien Cramatte <contact (at) zeninteractif.com>.\r\n *   AVL tree code adapted from Raimund Neumann <rnova (at) gmx.net>.\r\n *\r\n * Revision 18: October 27, 2005\r\n *   DOM 3 XPath support.  Caveats:\r\n *     - namespace prefixes aren't resolved in XPathEvaluator.createExpression,\r\n *       but in XPathExpression.evaluate.\r\n *     - XPathResult.invalidIteratorState is not implemented.\r\n *\r\n * Revision 17: October 25, 2005\r\n *   Some core XPath function fixes and a patch to avoid crashing certain\r\n *   versions of MSXML in PathExpr.prototype.getOwnerElement, thanks to\r\n *   Sébastien Cramatte <contact (at) zeninteractif.com>.\r\n *\r\n * Revision 16: September 22, 2005\r\n *   Workarounds for some IE 5.5 deficiencies.\r\n *   Fixed problem with prefix node tests on attribute nodes.\r\n *\r\n * Revision 15: May 21, 2005\r\n *   Fixed problem with QName node tests on elements with an xmlns=\"...\".\r\n *\r\n * Revision 14: May 19, 2005\r\n *   Fixed QName node tests on attribute node regression.\r\n *\r\n * Revision 13: May 3, 2005\r\n *   Node tests are case insensitive now if working in an HTML DOM.\r\n *\r\n * Revision 12: April 26, 2005\r\n *   Updated licence.  Slight code changes to enable use of Dean\r\n *   Edwards' script compression, http://dean.edwards.name/packer/ .\r\n *\r\n * Revision 11: April 23, 2005\r\n *   Fixed bug with 'and' and 'or' operators, fix thanks to\r\n *   Sandy McArthur <sandy (at) mcarthur.org>.\r\n *\r\n * Revision 10: April 15, 2005\r\n *   Added support for a virtual root node, supposedly helpful for\r\n *   implementing XForms.  Fixed problem with QName node tests and\r\n *   the parent axis.\r\n *\r\n * Revision 9: March 17, 2005\r\n *   Namespace resolver tweaked so using the document node as the context\r\n *   for namespace lookups is equivalent to using the document element.\r\n *\r\n * Revision 8: February 13, 2005\r\n *   Handle implicit declaration of 'xmlns' namespace prefix.\r\n *   Fixed bug when comparing nodesets.\r\n *   Instance data can now be associated with a FunctionResolver, and\r\n *     workaround for MSXML not supporting 'localName' and 'getElementById',\r\n *     thanks to Grant Gongaware.\r\n *   Fix a few problems when the context node is the root node.\r\n *   \r\n * Revision 7: February 11, 2005\r\n *   Default namespace resolver fix from Grant Gongaware\r\n *   <grant (at) gongaware.com>.\r\n *\r\n * Revision 6: February 10, 2005\r\n *   Fixed bug in 'number' function.\r\n *\r\n * Revision 5: February 9, 2005\r\n *   Fixed bug where text nodes not getting converted to string values.\r\n *\r\n * Revision 4: January 21, 2005\r\n *   Bug in 'name' function, fix thanks to Bill Edney.\r\n *   Fixed incorrect processing of namespace nodes.\r\n *   Fixed NamespaceResolver to resolve 'xml' namespace.\r\n *   Implemented union '|' operator.\r\n *\r\n * Revision 3: January 14, 2005\r\n *   Fixed bug with nodeset comparisons, bug lexing < and >.\r\n *\r\n * Revision 2: October 26, 2004\r\n *   QName node test namespace handling fixed.  Few other bug fixes.\r\n *   \r\n * Revision 1: August 13, 2004\r\n *   Bug fixes from William J. Edney <bedney (at) technicalpursuit.com>.\r\n *   Added minimal licence.\r\n *\r\n * Initial version: June 14, 2004\r\n */\r\n\r\n// XPathParser ///////////////////////////////////////////////////////////////\r\n\r\nXPathParser.prototype = new Object();\r\nXPathParser.prototype.constructor = XPathParser;\r\nXPathParser.superclass = Object.prototype;\r\n\r\nfunction XPathParser() {\r\n\tthis.init();\r\n}\r\n\r\nXPathParser.prototype.init = function() {\r\n\tthis.reduceActions = [];\r\n\r\n\tthis.reduceActions[3] = function(rhs) {\r\n\t\treturn new OrOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[5] = function(rhs) {\r\n\t\treturn new AndOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[7] = function(rhs) {\r\n\t\treturn new EqualsOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[8] = function(rhs) {\r\n\t\treturn new NotEqualOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[10] = function(rhs) {\r\n\t\treturn new LessThanOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[11] = function(rhs) {\r\n\t\treturn new GreaterThanOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[12] = function(rhs) {\r\n\t\treturn new LessThanOrEqualOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[13] = function(rhs) {\r\n\t\treturn new GreaterThanOrEqualOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[15] = function(rhs) {\r\n\t\treturn new PlusOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[16] = function(rhs) {\r\n\t\treturn new MinusOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[18] = function(rhs) {\r\n\t\treturn new MultiplyOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[19] = function(rhs) {\r\n\t\treturn new DivOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[20] = function(rhs) {\r\n\t\treturn new ModOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[22] = function(rhs) {\r\n\t\treturn new UnaryMinusOperation(rhs[1]);\r\n\t};\r\n\tthis.reduceActions[24] = function(rhs) {\r\n\t\treturn new BarOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[25] = function(rhs) {\r\n\t\treturn new PathExpr(undefined, undefined, rhs[0]);\r\n\t};\r\n\tthis.reduceActions[27] = function(rhs) {\r\n\t\trhs[0].locationPath = rhs[2];\r\n\t\treturn rhs[0];\r\n\t};\r\n\tthis.reduceActions[28] = function(rhs) {\r\n\t\trhs[0].locationPath = rhs[2];\r\n\t\trhs[0].locationPath.steps.unshift(new Step(Step.DESCENDANTORSELF, new NodeTest(NodeTest.NODE, undefined), []));\r\n\t\treturn rhs[0];\r\n\t};\r\n\tthis.reduceActions[29] = function(rhs) {\r\n\t\treturn new PathExpr(rhs[0], [], undefined);\r\n\t};\r\n\tthis.reduceActions[30] = function(rhs) {\r\n\t\tif (Utilities.instance_of(rhs[0], PathExpr)) {\r\n\t\t\tif (rhs[0].filterPredicates == undefined) {\r\n\t\t\t\trhs[0].filterPredicates = [];\r\n\t\t\t}\r\n\t\t\trhs[0].filterPredicates.push(rhs[1]);\r\n\t\t\treturn rhs[0];\r\n\t\t} else {\r\n\t\t\treturn new PathExpr(rhs[0], [rhs[1]], undefined);\r\n\t\t}\r\n\t};\r\n\tthis.reduceActions[32] = function(rhs) {\r\n\t\treturn rhs[1];\r\n\t};\r\n\tthis.reduceActions[33] = function(rhs) {\r\n\t\treturn new XString(rhs[0]);\r\n\t};\r\n\tthis.reduceActions[34] = function(rhs) {\r\n\t\treturn new XNumber(rhs[0]);\r\n\t};\r\n\tthis.reduceActions[36] = function(rhs) {\r\n\t\treturn new FunctionCall(rhs[0], []);\r\n\t};\r\n\tthis.reduceActions[37] = function(rhs) {\r\n\t\treturn new FunctionCall(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[38] = function(rhs) {\r\n\t\treturn [ rhs[0] ];\r\n\t};\r\n\tthis.reduceActions[39] = function(rhs) {\r\n\t\trhs[2].unshift(rhs[0]);\r\n\t\treturn rhs[2];\r\n\t};\r\n\tthis.reduceActions[43] = function(rhs) {\r\n\t\treturn new LocationPath(true, []);\r\n\t};\r\n\tthis.reduceActions[44] = function(rhs) {\r\n\t\trhs[1].absolute = true;\r\n\t\treturn rhs[1];\r\n\t};\r\n\tthis.reduceActions[46] = function(rhs) {\r\n\t\treturn new LocationPath(false, [ rhs[0] ]);\r\n\t};\r\n\tthis.reduceActions[47] = function(rhs) {\r\n\t\trhs[0].steps.push(rhs[2]);\r\n\t\treturn rhs[0];\r\n\t};\r\n\tthis.reduceActions[49] = function(rhs) {\r\n\t\treturn new Step(rhs[0], rhs[1], []);\r\n\t};\r\n\tthis.reduceActions[50] = function(rhs) {\r\n\t\treturn new Step(Step.CHILD, rhs[0], []);\r\n\t};\r\n\tthis.reduceActions[51] = function(rhs) {\r\n\t\treturn new Step(rhs[0], rhs[1], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[52] = function(rhs) {\r\n\t\treturn new Step(Step.CHILD, rhs[0], rhs[1]);\r\n\t};\r\n\tthis.reduceActions[54] = function(rhs) {\r\n\t\treturn [ rhs[0] ];\r\n\t};\r\n\tthis.reduceActions[55] = function(rhs) {\r\n\t\trhs[1].unshift(rhs[0]);\r\n\t\treturn rhs[1];\r\n\t};\r\n\tthis.reduceActions[56] = function(rhs) {\r\n\t\tif (rhs[0] == \"ancestor\") {\r\n\t\t\treturn Step.ANCESTOR;\r\n\t\t} else if (rhs[0] == \"ancestor-or-self\") {\r\n\t\t\treturn Step.ANCESTORORSELF;\r\n\t\t} else if (rhs[0] == \"attribute\") {\r\n\t\t\treturn Step.ATTRIBUTE;\r\n\t\t} else if (rhs[0] == \"child\") {\r\n\t\t\treturn Step.CHILD;\r\n\t\t} else if (rhs[0] == \"descendant\") {\r\n\t\t\treturn Step.DESCENDANT;\r\n\t\t} else if (rhs[0] == \"descendant-or-self\") {\r\n\t\t\treturn Step.DESCENDANTORSELF;\r\n\t\t} else if (rhs[0] == \"following\") {\r\n\t\t\treturn Step.FOLLOWING;\r\n\t\t} else if (rhs[0] == \"following-sibling\") {\r\n\t\t\treturn Step.FOLLOWINGSIBLING;\r\n\t\t} else if (rhs[0] == \"namespace\") {\r\n\t\t\treturn Step.NAMESPACE;\r\n\t\t} else if (rhs[0] == \"parent\") {\r\n\t\t\treturn Step.PARENT;\r\n\t\t} else if (rhs[0] == \"preceding\") {\r\n\t\t\treturn Step.PRECEDING;\r\n\t\t} else if (rhs[0] == \"preceding-sibling\") {\r\n\t\t\treturn Step.PRECEDINGSIBLING;\r\n\t\t} else if (rhs[0] == \"self\") {\r\n\t\t\treturn Step.SELF;\r\n\t\t}\r\n\t\treturn -1;\r\n\t};\r\n\tthis.reduceActions[57] = function(rhs) {\r\n\t\treturn Step.ATTRIBUTE;\r\n\t};\r\n\tthis.reduceActions[59] = function(rhs) {\r\n\t\tif (rhs[0] == \"comment\") {\r\n\t\t\treturn new NodeTest(NodeTest.COMMENT, undefined);\r\n\t\t} else if (rhs[0] == \"text\") {\r\n\t\t\treturn new NodeTest(NodeTest.TEXT, undefined);\r\n\t\t} else if (rhs[0] == \"processing-instruction\") {\r\n\t\t\treturn new NodeTest(NodeTest.PI, undefined);\r\n\t\t} else if (rhs[0] == \"node\") {\r\n\t\t\treturn new NodeTest(NodeTest.NODE, undefined);\r\n\t\t}\r\n\t\treturn new NodeTest(-1, undefined);\r\n\t};\r\n\tthis.reduceActions[60] = function(rhs) {\r\n\t\treturn new NodeTest(NodeTest.PI, rhs[2]);\r\n\t};\r\n\tthis.reduceActions[61] = function(rhs) {\r\n\t\treturn rhs[1];\r\n\t};\r\n\tthis.reduceActions[63] = function(rhs) {\r\n\t\trhs[1].absolute = true;\r\n\t\trhs[1].steps.unshift(new Step(Step.DESCENDANTORSELF, new NodeTest(NodeTest.NODE, undefined), []));\r\n\t\treturn rhs[1];\r\n\t};\r\n\tthis.reduceActions[64] = function(rhs) {\r\n\t\trhs[0].steps.push(new Step(Step.DESCENDANTORSELF, new NodeTest(NodeTest.NODE, undefined), []));\r\n\t\trhs[0].steps.push(rhs[2]);\r\n\t\treturn rhs[0];\r\n\t};\r\n\tthis.reduceActions[65] = function(rhs) {\r\n\t\treturn new Step(Step.SELF, new NodeTest(NodeTest.NODE, undefined), []);\r\n\t};\r\n\tthis.reduceActions[66] = function(rhs) {\r\n\t\treturn new Step(Step.PARENT, new NodeTest(NodeTest.NODE, undefined), []);\r\n\t};\r\n\tthis.reduceActions[67] = function(rhs) {\r\n\t\treturn new VariableReference(rhs[1]);\r\n\t};\r\n\tthis.reduceActions[68] = function(rhs) {\r\n\t\treturn new NodeTest(NodeTest.NAMETESTANY, undefined);\r\n\t};\r\n\tthis.reduceActions[69] = function(rhs) {\r\n\t\tvar prefix = rhs[0].substring(0, rhs[0].indexOf(\":\"));\r\n\t\treturn new NodeTest(NodeTest.NAMETESTPREFIXANY, prefix);\r\n\t};\r\n\tthis.reduceActions[70] = function(rhs) {\r\n\t\treturn new NodeTest(NodeTest.NAMETESTQNAME, rhs[0]);\r\n\t};\r\n};\r\n\r\nXPathParser.actionTable = [\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\"                 s                  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"                rrrrr               \",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\"rs  rrrrrrrr s  sssssrrrrrr  rrs rs \",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\"                            s       \",\r\n\t\"                            s       \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"  s                                 \",\r\n\t\"                            s       \",\r\n\t\" s           s  sssss          s  s \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"a                                   \",\r\n\t\"r       s                    rr  r  \",\r\n\t\"r      sr                    rr  r  \",\r\n\t\"r   s  rr            s       rr  r  \",\r\n\t\"r   rssrr            rss     rr  r  \",\r\n\t\"r   rrrrr            rrrss   rr  r  \",\r\n\t\"r   rrrrrsss         rrrrr   rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrr   rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrrs  rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrrr  rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrrr  rr  r  \",\r\n\t\"r  srrrrrrrr         rrrrrrs rr sr  \",\r\n\t\"r  srrrrrrrr         rrrrrrs rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r   rrrrrrrr         rrrrrr  rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrrr  rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"                sssss               \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr sr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"                             s      \",\r\n\t\"r  srrrrrrrr         rrrrrrs rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrr   rr  r  \",\r\n\t\"              s                     \",\r\n\t\"                             s      \",\r\n\t\"                rrrrr               \",\r\n\t\" s s        sssssssss    s sss s  ss\",\r\n\t\"r  srrrrrrrr         rrrrrrs rr  r  \",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss      ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s           s  sssss          s  s \",\r\n\t\" s           s  sssss          s  s \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\" s           s  sssss          s  s \",\r\n\t\" s           s  sssss          s  s \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr sr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr sr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"                             s      \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"                             rr     \",\r\n\t\"                             s      \",\r\n\t\"                             rs     \",\r\n\t\"r      sr                    rr  r  \",\r\n\t\"r   s  rr            s       rr  r  \",\r\n\t\"r   rssrr            rss     rr  r  \",\r\n\t\"r   rssrr            rss     rr  r  \",\r\n\t\"r   rrrrr            rrrss   rr  r  \",\r\n\t\"r   rrrrr            rrrss   rr  r  \",\r\n\t\"r   rrrrr            rrrss   rr  r  \",\r\n\t\"r   rrrrr            rrrss   rr  r  \",\r\n\t\"r   rrrrrsss         rrrrr   rr  r  \",\r\n\t\"r   rrrrrsss         rrrrr   rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrr   rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrr   rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrr   rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrrr  rr  r  \",\r\n\t\"                                 r  \",\r\n\t\"                                 s  \",\r\n\t\"r  srrrrrrrr         rrrrrrs rr  r  \",\r\n\t\"r  srrrrrrrr         rrrrrrs rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"                             r      \"\r\n];\r\n\r\nXPathParser.actionTableNumber = [\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\"                 J                  \",\r\n\t\"a  aaaaaaaaa         aaaaaaa aa  a  \",\r\n\t\"                YYYYY               \",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\"K1  KKKKKKKK .  +*)('KKKKKK  KK# K\\\" \",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\"                            N       \",\r\n\t\"                            O       \",\r\n\t\"e  eeeeeeeee         eeeeeee ee ee  \",\r\n\t\"f  fffffffff         fffffff ff ff  \",\r\n\t\"d  ddddddddd         ddddddd dd dd  \",\r\n\t\"B  BBBBBBBBB         BBBBBBB BB BB  \",\r\n\t\"A  AAAAAAAAA         AAAAAAA AA AA  \",\r\n\t\"  P                                 \",\r\n\t\"                            Q       \",\r\n\t\" 1           .  +*)('          #  \\\" \",\r\n\t\"b  bbbbbbbbb         bbbbbbb bb  b  \",\r\n\t\"                                    \",\r\n\t\"!       S                    !!  !  \",\r\n\t\"\\\"      T\\\"                    \\\"\\\"  \\\"  \",\r\n\t\"$   V  $$            U       $$  $  \",\r\n\t\"&   &ZY&&            &XW     &&  &  \",\r\n\t\")   )))))            )))\\\\[   ))  )  \",\r\n\t\".   ....._^]         .....   ..  .  \",\r\n\t\"1   11111111         11111   11  1  \",\r\n\t\"5   55555555         55555`  55  5  \",\r\n\t\"7   77777777         777777  77  7  \",\r\n\t\"9   99999999         999999  99  9  \",\r\n\t\":  c::::::::         ::::::b :: a:  \",\r\n\t\"I  fIIIIIIII         IIIIIIe II  I  \",\r\n\t\"=  =========         ======= == ==  \",\r\n\t\"?  ?????????         ??????? ?? ??  \",\r\n\t\"C  CCCCCCCCC         CCCCCCC CC CC  \",\r\n\t\"J   JJJJJJJJ         JJJJJJ  JJ  J  \",\r\n\t\"M   MMMMMMMM         MMMMMM  MM  M  \",\r\n\t\"N  NNNNNNNNN         NNNNNNN NN  N  \",\r\n\t\"P  PPPPPPPPP         PPPPPPP PP  P  \",\r\n\t\"                +*)('               \",\r\n\t\"R  RRRRRRRRR         RRRRRRR RR aR  \",\r\n\t\"U  UUUUUUUUU         UUUUUUU UU  U  \",\r\n\t\"Z  ZZZZZZZZZ         ZZZZZZZ ZZ ZZ  \",\r\n\t\"c  ccccccccc         ccccccc cc cc  \",\r\n\t\"                             j      \",\r\n\t\"L  fLLLLLLLL         LLLLLLe LL  L  \",\r\n\t\"6   66666666         66666   66  6  \",\r\n\t\"              k                     \",\r\n\t\"                             l      \",\r\n\t\"                XXXXX               \",\r\n\t\" 1 0        /.-,+*)('    & %$m #  \\\"!\",\r\n\t\"_  f________         ______e __  _  \",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('      %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1           .  +*)('          #  \\\" \",\r\n\t\" 1           .  +*)('          #  \\\" \",\r\n\t\">  >>>>>>>>>         >>>>>>> >> >>  \",\r\n\t\" 1           .  +*)('          #  \\\" \",\r\n\t\" 1           .  +*)('          #  \\\" \",\r\n\t\"Q  QQQQQQQQQ         QQQQQQQ QQ aQ  \",\r\n\t\"V  VVVVVVVVV         VVVVVVV VV aV  \",\r\n\t\"T  TTTTTTTTT         TTTTTTT TT  T  \",\r\n\t\"@  @@@@@@@@@         @@@@@@@ @@ @@  \",\r\n\t\"                             \\x87      \",\r\n\t\"[  [[[[[[[[[         [[[[[[[ [[ [[  \",\r\n\t\"D  DDDDDDDDD         DDDDDDD DD DD  \",\r\n\t\"                             HH     \",\r\n\t\"                             \\x88      \",\r\n\t\"                             F\\x89     \",\r\n\t\"#      T#                    ##  #  \",\r\n\t\"%   V  %%            U       %%  %  \",\r\n\t\"'   'ZY''            'XW     ''  '  \",\r\n\t\"(   (ZY((            (XW     ((  (  \",\r\n\t\"+   +++++            +++\\\\[   ++  +  \",\r\n\t\"*   *****            ***\\\\[   **  *  \",\r\n\t\"-   -----            ---\\\\[   --  -  \",\r\n\t\",   ,,,,,            ,,,\\\\[   ,,  ,  \",\r\n\t\"0   00000_^]         00000   00  0  \",\r\n\t\"/   /////_^]         /////   //  /  \",\r\n\t\"2   22222222         22222   22  2  \",\r\n\t\"3   33333333         33333   33  3  \",\r\n\t\"4   44444444         44444   44  4  \",\r\n\t\"8   88888888         888888  88  8  \",\r\n\t\"                                 ^  \",\r\n\t\"                                 \\x8a  \",\r\n\t\";  f;;;;;;;;         ;;;;;;e ;;  ;  \",\r\n\t\"<  f<<<<<<<<         <<<<<<e <<  <  \",\r\n\t\"O  OOOOOOOOO         OOOOOOO OO  O  \",\r\n\t\"`  `````````         ``````` ``  `  \",\r\n\t\"S  SSSSSSSSS         SSSSSSS SS  S  \",\r\n\t\"W  WWWWWWWWW         WWWWWWW WW  W  \",\r\n\t\"\\\\  \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\         \\\\\\\\\\\\\\\\\\\\\\\\\\\\ \\\\\\\\ \\\\\\\\  \",\r\n\t\"E  EEEEEEEEE         EEEEEEE EE EE  \",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\"]  ]]]]]]]]]         ]]]]]]] ]] ]]  \",\r\n\t\"                             G      \"\r\n];\r\n\r\nXPathParser.gotoTable = [\r\n\t\"3456789:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"L456789:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"            M        EFGH IJ \",\r\n\t\"       N;<=>?@ AB  CDEFGH IJ \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"            S        EFGH IJ \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"              e              \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                        h  J \",\r\n\t\"              i          j   \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"o456789:;<=>?@ ABpqCDEFGH IJ \",\r\n\t\"                             \",\r\n\t\"  r6789:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"   s789:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"    t89:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"    u89:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"     v9:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"     w9:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"     x9:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"     y9:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"      z:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"      {:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"       |;<=>?@ AB  CDEFGH IJ \",\r\n\t\"       };<=>?@ AB  CDEFGH IJ \",\r\n\t\"       ~;<=>?@ AB  CDEFGH IJ \",\r\n\t\"         \\x7f=>?@ AB  CDEFGH IJ \",\r\n\t\"\\x80456789:;<=>?@ AB  CDEFGH IJ\\x81\",\r\n\t\"            \\x82        EFGH IJ \",\r\n\t\"            \\x83        EFGH IJ \",\r\n\t\"                             \",\r\n\t\"                     \\x84 GH IJ \",\r\n\t\"                     \\x85 GH IJ \",\r\n\t\"              i          \\x86   \",\r\n\t\"              i          \\x87   \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"o456789:;<=>?@ AB\\x8cqCDEFGH IJ \",\r\n\t\"                             \",\r\n\t\"                             \"\r\n];\r\n\r\nXPathParser.productions = [\r\n\t[1, 1, 2],\r\n\t[2, 1, 3],\r\n\t[3, 1, 4],\r\n\t[3, 3, 3, -9, 4],\r\n\t[4, 1, 5],\r\n\t[4, 3, 4, -8, 5],\r\n\t[5, 1, 6],\r\n\t[5, 3, 5, -22, 6],\r\n\t[5, 3, 5, -5, 6],\r\n\t[6, 1, 7],\r\n\t[6, 3, 6, -23, 7],\r\n\t[6, 3, 6, -24, 7],\r\n\t[6, 3, 6, -6, 7],\r\n\t[6, 3, 6, -7, 7],\r\n\t[7, 1, 8],\r\n\t[7, 3, 7, -25, 8],\r\n\t[7, 3, 7, -26, 8],\r\n\t[8, 1, 9],\r\n\t[8, 3, 8, -12, 9],\r\n\t[8, 3, 8, -11, 9],\r\n\t[8, 3, 8, -10, 9],\r\n\t[9, 1, 10],\r\n\t[9, 2, -26, 9],\r\n\t[10, 1, 11],\r\n\t[10, 3, 10, -27, 11],\r\n\t[11, 1, 12],\r\n\t[11, 1, 13],\r\n\t[11, 3, 13, -28, 14],\r\n\t[11, 3, 13, -4, 14],\r\n\t[13, 1, 15],\r\n\t[13, 2, 13, 16],\r\n\t[15, 1, 17],\r\n\t[15, 3, -29, 2, -30],\r\n\t[15, 1, -15],\r\n\t[15, 1, -16],\r\n\t[15, 1, 18],\r\n\t[18, 3, -13, -29, -30],\r\n\t[18, 4, -13, -29, 19, -30],\r\n\t[19, 1, 20],\r\n\t[19, 3, 20, -31, 19],\r\n\t[20, 1, 2],\r\n\t[12, 1, 14],\r\n\t[12, 1, 21],\r\n\t[21, 1, -28],\r\n\t[21, 2, -28, 14],\r\n\t[21, 1, 22],\r\n\t[14, 1, 23],\r\n\t[14, 3, 14, -28, 23],\r\n\t[14, 1, 24],\r\n\t[23, 2, 25, 26],\r\n\t[23, 1, 26],\r\n\t[23, 3, 25, 26, 27],\r\n\t[23, 2, 26, 27],\r\n\t[23, 1, 28],\r\n\t[27, 1, 16],\r\n\t[27, 2, 16, 27],\r\n\t[25, 2, -14, -3],\r\n\t[25, 1, -32],\r\n\t[26, 1, 29],\r\n\t[26, 3, -20, -29, -30],\r\n\t[26, 4, -21, -29, -15, -30],\r\n\t[16, 3, -33, 30, -34],\r\n\t[30, 1, 2],\r\n\t[22, 2, -4, 14],\r\n\t[24, 3, 14, -4, 23],\r\n\t[28, 1, -35],\r\n\t[28, 1, -2],\r\n\t[17, 2, -36, -18],\r\n\t[29, 1, -17],\r\n\t[29, 1, -19],\r\n\t[29, 1, -18]\r\n];\r\n\r\nXPathParser.DOUBLEDOT = 2;\r\nXPathParser.DOUBLECOLON = 3;\r\nXPathParser.DOUBLESLASH = 4;\r\nXPathParser.NOTEQUAL = 5;\r\nXPathParser.LESSTHANOREQUAL = 6;\r\nXPathParser.GREATERTHANOREQUAL = 7;\r\nXPathParser.AND = 8;\r\nXPathParser.OR = 9;\r\nXPathParser.MOD = 10;\r\nXPathParser.DIV = 11;\r\nXPathParser.MULTIPLYOPERATOR = 12;\r\nXPathParser.FUNCTIONNAME = 13;\r\nXPathParser.AXISNAME = 14;\r\nXPathParser.LITERAL = 15;\r\nXPathParser.NUMBER = 16;\r\nXPathParser.ASTERISKNAMETEST = 17;\r\nXPathParser.QNAME = 18;\r\nXPathParser.NCNAMECOLONASTERISK = 19;\r\nXPathParser.NODETYPE = 20;\r\nXPathParser.PROCESSINGINSTRUCTIONWITHLITERAL = 21;\r\nXPathParser.EQUALS = 22;\r\nXPathParser.LESSTHAN = 23;\r\nXPathParser.GREATERTHAN = 24;\r\nXPathParser.PLUS = 25;\r\nXPathParser.MINUS = 26;\r\nXPathParser.BAR = 27;\r\nXPathParser.SLASH = 28;\r\nXPathParser.LEFTPARENTHESIS = 29;\r\nXPathParser.RIGHTPARENTHESIS = 30;\r\nXPathParser.COMMA = 31;\r\nXPathParser.AT = 32;\r\nXPathParser.LEFTBRACKET = 33;\r\nXPathParser.RIGHTBRACKET = 34;\r\nXPathParser.DOT = 35;\r\nXPathParser.DOLLAR = 36;\r\n\r\nXPathParser.prototype.tokenize = function(s1) {\r\n\tvar types = [];\r\n\tvar values = [];\r\n\tvar s = s1 + '\\0';\r\n\r\n\tvar pos = 0;\r\n\tvar c = s.charAt(pos++);\r\n\twhile (1) {\r\n\t\twhile (c == ' ' || c == '\\t' || c == '\\r' || c == '\\n') {\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t}\r\n\t\tif (c == '\\0' || pos >= s.length) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif (c == '(') {\r\n\t\t\ttypes.push(XPathParser.LEFTPARENTHESIS);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == ')') {\r\n\t\t\ttypes.push(XPathParser.RIGHTPARENTHESIS);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == '[') {\r\n\t\t\ttypes.push(XPathParser.LEFTBRACKET);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == ']') {\r\n\t\t\ttypes.push(XPathParser.RIGHTBRACKET);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == '@') {\r\n\t\t\ttypes.push(XPathParser.AT);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == ',') {\r\n\t\t\ttypes.push(XPathParser.COMMA);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == '|') {\r\n\t\t\ttypes.push(XPathParser.BAR);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == '+') {\r\n\t\t\ttypes.push(XPathParser.PLUS);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == '-') {\r\n\t\t\ttypes.push(XPathParser.MINUS);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == '=') {\r\n\t\t\ttypes.push(XPathParser.EQUALS);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == '$') {\r\n\t\t\ttypes.push(XPathParser.DOLLAR);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\t\r\n\t\tif (c == '.') {\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tif (c == '.') {\r\n\t\t\t\ttypes.push(XPathParser.DOUBLEDOT);\r\n\t\t\t\tvalues.push(\"..\");\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (c >= '0' && c <= '9') {\r\n\t\t\t\tvar number = \".\" + c;\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\twhile (c >= '0' && c <= '9') {\r\n\t\t\t\t\tnumber += c;\r\n\t\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\t}\r\n\t\t\t\ttypes.push(XPathParser.NUMBER);\r\n\t\t\t\tvalues.push(number);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\ttypes.push(XPathParser.DOT);\r\n\t\t\tvalues.push('.');\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (c == '\\'' || c == '\"') {\r\n\t\t\tvar delimiter = c;\r\n\t\t\tvar literal = \"\";\r\n\t\t\twhile ((c = s.charAt(pos++)) != delimiter) {\r\n\t\t\t\tliteral += c;\r\n\t\t\t}\r\n\t\t\ttypes.push(XPathParser.LITERAL);\r\n\t\t\tvalues.push(literal);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (c >= '0' && c <= '9') {\r\n\t\t\tvar number = c;\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\twhile (c >= '0' && c <= '9') {\r\n\t\t\t\tnumber += c;\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t}\r\n\t\t\tif (c == '.') {\r\n\t\t\t\tif (s.charAt(pos) >= '0' && s.charAt(pos) <= '9') {\r\n\t\t\t\t\tnumber += c;\r\n\t\t\t\t\tnumber += s.charAt(pos++);\r\n\t\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\t\twhile (c >= '0' && c <= '9') {\r\n\t\t\t\t\t\tnumber += c;\r\n\t\t\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttypes.push(XPathParser.NUMBER);\r\n\t\t\tvalues.push(number);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (c == '*') {\r\n\t\t\tif (types.length > 0) {\r\n\t\t\t\tvar last = types[types.length - 1];\r\n\t\t\t\tif (last != XPathParser.AT\r\n\t\t\t\t\t\t&& last != XPathParser.DOUBLECOLON\r\n\t\t\t\t\t\t&& last != XPathParser.LEFTPARENTHESIS\r\n\t\t\t\t\t\t&& last != XPathParser.LEFTBRACKET\r\n\t\t\t\t\t\t&& last != XPathParser.AND\r\n\t\t\t\t\t\t&& last != XPathParser.OR\r\n\t\t\t\t\t\t&& last != XPathParser.MOD\r\n\t\t\t\t\t\t&& last != XPathParser.DIV\r\n\t\t\t\t\t\t&& last != XPathParser.MULTIPLYOPERATOR\r\n\t\t\t\t\t\t&& last != XPathParser.SLASH\r\n\t\t\t\t\t\t&& last != XPathParser.DOUBLESLASH\r\n\t\t\t\t\t\t&& last != XPathParser.BAR\r\n\t\t\t\t\t\t&& last != XPathParser.PLUS\r\n\t\t\t\t\t\t&& last != XPathParser.MINUS\r\n\t\t\t\t\t\t&& last != XPathParser.EQUALS\r\n\t\t\t\t\t\t&& last != XPathParser.NOTEQUAL\r\n\t\t\t\t\t\t&& last != XPathParser.LESSTHAN\r\n\t\t\t\t\t\t&& last != XPathParser.LESSTHANOREQUAL\r\n\t\t\t\t\t\t&& last != XPathParser.GREATERTHAN\r\n\t\t\t\t\t\t&& last != XPathParser.GREATERTHANOREQUAL) {\r\n\t\t\t\t\ttypes.push(XPathParser.MULTIPLYOPERATOR);\r\n\t\t\t\t\tvalues.push(c);\r\n\t\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttypes.push(XPathParser.ASTERISKNAMETEST);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (c == ':') {\r\n\t\t\tif (s.charAt(pos) == ':') {\r\n\t\t\t\ttypes.push(XPathParser.DOUBLECOLON);\r\n\t\t\t\tvalues.push(\"::\");\r\n\t\t\t\tpos++;\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (c == '/') {\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tif (c == '/') {\r\n\t\t\t\ttypes.push(XPathParser.DOUBLESLASH);\r\n\t\t\t\tvalues.push(\"//\");\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\ttypes.push(XPathParser.SLASH);\r\n\t\t\tvalues.push('/');\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (c == '!') {\r\n\t\t\tif (s.charAt(pos) == '=') {\r\n\t\t\t\ttypes.push(XPathParser.NOTEQUAL);\r\n\t\t\t\tvalues.push(\"!=\");\r\n\t\t\t\tpos++;\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (c == '<') {\r\n\t\t\tif (s.charAt(pos) == '=') {\r\n\t\t\t\ttypes.push(XPathParser.LESSTHANOREQUAL);\r\n\t\t\t\tvalues.push(\"<=\");\r\n\t\t\t\tpos++;\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\ttypes.push(XPathParser.LESSTHAN);\r\n\t\t\tvalues.push('<');\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (c == '>') {\r\n\t\t\tif (s.charAt(pos) == '=') {\r\n\t\t\t\ttypes.push(XPathParser.GREATERTHANOREQUAL);\r\n\t\t\t\tvalues.push(\">=\");\r\n\t\t\t\tpos++;\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\ttypes.push(XPathParser.GREATERTHAN);\r\n\t\t\tvalues.push('>');\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (c == '_' || Utilities.isLetter(c.charCodeAt(0))) {\r\n\t\t\tvar name = c;\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\twhile (Utilities.isNCNameChar(c.charCodeAt(0))) {\r\n\t\t\t\tname += c;\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t}\r\n\t\t\tif (types.length > 0) {\r\n\t\t\t\tvar last = types[types.length - 1];\r\n\t\t\t\tif (last != XPathParser.AT\r\n\t\t\t\t\t\t&& last != XPathParser.DOUBLECOLON\r\n\t\t\t\t\t\t&& last != XPathParser.LEFTPARENTHESIS\r\n\t\t\t\t\t\t&& last != XPathParser.LEFTBRACKET\r\n\t\t\t\t\t\t&& last != XPathParser.AND\r\n\t\t\t\t\t\t&& last != XPathParser.OR\r\n\t\t\t\t\t\t&& last != XPathParser.MOD\r\n\t\t\t\t\t\t&& last != XPathParser.DIV\r\n\t\t\t\t\t\t&& last != XPathParser.MULTIPLYOPERATOR\r\n\t\t\t\t\t\t&& last != XPathParser.SLASH\r\n\t\t\t\t\t\t&& last != XPathParser.DOUBLESLASH\r\n\t\t\t\t\t\t&& last != XPathParser.BAR\r\n\t\t\t\t\t\t&& last != XPathParser.PLUS\r\n\t\t\t\t\t\t&& last != XPathParser.MINUS\r\n\t\t\t\t\t\t&& last != XPathParser.EQUALS\r\n\t\t\t\t\t\t&& last != XPathParser.NOTEQUAL\r\n\t\t\t\t\t\t&& last != XPathParser.LESSTHAN\r\n\t\t\t\t\t\t&& last != XPathParser.LESSTHANOREQUAL\r\n\t\t\t\t\t\t&& last != XPathParser.GREATERTHAN\r\n\t\t\t\t\t\t&& last != XPathParser.GREATERTHANOREQUAL) {\r\n\t\t\t\t\tif (name == \"and\") {\r\n\t\t\t\t\t\ttypes.push(XPathParser.AND);\r\n\t\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (name == \"or\") {\r\n\t\t\t\t\t\ttypes.push(XPathParser.OR);\r\n\t\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (name == \"mod\") {\r\n\t\t\t\t\t\ttypes.push(XPathParser.MOD);\r\n\t\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (name == \"div\") {\r\n\t\t\t\t\t\ttypes.push(XPathParser.DIV);\r\n\t\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (c == ':') {\r\n\t\t\t\tif (s.charAt(pos) == '*') {\r\n\t\t\t\t\ttypes.push(XPathParser.NCNAMECOLONASTERISK);\r\n\t\t\t\t\tvalues.push(name + \":*\");\r\n\t\t\t\t\tpos++;\r\n\t\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (s.charAt(pos) == '_' || Utilities.isLetter(s.charCodeAt(pos))) {\r\n\t\t\t\t\tname += ':';\r\n\t\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\t\twhile (Utilities.isNCNameChar(c.charCodeAt(0))) {\r\n\t\t\t\t\t\tname += c;\r\n\t\t\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (c == '(') {\r\n\t\t\t\t\t\ttypes.push(XPathParser.FUNCTIONNAME);\r\n\t\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttypes.push(XPathParser.QNAME);\r\n\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (s.charAt(pos) == ':') {\r\n\t\t\t\t\ttypes.push(XPathParser.AXISNAME);\r\n\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (c == '(') {\r\n\t\t\t\tif (name == \"comment\" || name == \"text\" || name == \"node\") {\r\n\t\t\t\t\ttypes.push(XPathParser.NODETYPE);\r\n\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (name == \"processing-instruction\") {\r\n\t\t\t\t\tif (s.charAt(pos) == ')') {\r\n\t\t\t\t\t\ttypes.push(XPathParser.NODETYPE);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttypes.push(XPathParser.PROCESSINGINSTRUCTIONWITHLITERAL);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\ttypes.push(XPathParser.FUNCTIONNAME);\r\n\t\t\t\tvalues.push(name);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\ttypes.push(XPathParser.QNAME);\r\n\t\t\tvalues.push(name);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tthrow new Error(\"Unexpected character \" + c);\r\n\t}\r\n\ttypes.push(1);\r\n\tvalues.push(\"[EOF]\");\r\n\treturn [types, values];\r\n};\r\n\r\nXPathParser.SHIFT = 's';\r\nXPathParser.REDUCE = 'r';\r\nXPathParser.ACCEPT = 'a';\r\n\r\nXPathParser.prototype.parse = function(s) {\r\n\tvar types;\r\n\tvar values;\r\n\tvar res = this.tokenize(s);\r\n\tif (res == undefined) {\r\n\t\treturn undefined;\r\n\t}\r\n\ttypes = res[0];\r\n\tvalues = res[1];\r\n\tvar tokenPos = 0;\r\n\tvar state = [];\r\n\tvar tokenType = [];\r\n\tvar tokenValue = [];\r\n\tvar s;\r\n\tvar a;\r\n\tvar t;\r\n\r\n\tstate.push(0);\r\n\ttokenType.push(1);\r\n\ttokenValue.push(\"_S\");\r\n\r\n\ta = types[tokenPos];\r\n\tt = values[tokenPos++];\r\n\twhile (1) {\r\n\t\ts = state[state.length - 1];\r\n\t\tswitch (XPathParser.actionTable[s].charAt(a - 1)) {\r\n\t\t\tcase XPathParser.SHIFT:\r\n\t\t\t\ttokenType.push(-a);\r\n\t\t\t\ttokenValue.push(t);\r\n\t\t\t\tstate.push(XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32);\r\n\t\t\t\ta = types[tokenPos];\r\n\t\t\t\tt = values[tokenPos++];\r\n\t\t\t\tbreak;\r\n\t\t\tcase XPathParser.REDUCE:\r\n\t\t\t\tvar num = XPathParser.productions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32][1];\r\n\t\t\t\tvar rhs = [];\r\n\t\t\t\tfor (var i = 0; i < num; i++) {\r\n\t\t\t\t\ttokenType.pop();\r\n\t\t\t\t\trhs.unshift(tokenValue.pop());\r\n\t\t\t\t\tstate.pop();\r\n\t\t\t\t}\r\n\t\t\t\tvar s_ = state[state.length - 1];\r\n\t\t\t\ttokenType.push(XPathParser.productions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32][0]);\r\n\t\t\t\tif (this.reduceActions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32] == undefined) {\r\n\t\t\t\t\ttokenValue.push(rhs[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttokenValue.push(this.reduceActions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32](rhs));\r\n\t\t\t\t}\r\n\t\t\t\tstate.push(XPathParser.gotoTable[s_].charCodeAt(XPathParser.productions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32][0] - 2) - 33);\r\n\t\t\t\tbreak;\r\n\t\t\tcase XPathParser.ACCEPT:\r\n\t\t\t\treturn new XPath(tokenValue.pop());\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error(\"XPath parse error\");\r\n\t\t}\r\n\t}\r\n};\r\n\r\n// XPath /////////////////////////////////////////////////////////////////////\r\n\r\nXPath.prototype = new Object();\r\nXPath.prototype.constructor = XPath;\r\nXPath.superclass = Object.prototype;\r\n\r\nfunction XPath(e) {\r\n\tthis.expression = e;\r\n}\r\n\r\nXPath.prototype.toString = function() {\r\n\treturn this.expression.toString();\r\n};\r\n\r\nXPath.prototype.evaluate = function(c) {\r\n\tc.contextNode = c.expressionContextNode;\r\n\tc.contextSize = 1;\r\n\tc.contextPosition = 1;\r\n\tc.caseInsensitive = false;\r\n\tif (c.contextNode != null) {\r\n\t\tvar doc = c.contextNode;\r\n\t\tif (doc.nodeType != 9 /*Node.DOCUMENT_NODE*/) {\r\n\t\t\tdoc = doc.ownerDocument;\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tc.caseInsensitive = doc.implementation.hasFeature(\"HTML\", \"2.0\");\r\n\t\t} catch (e) {\r\n\t\t\tc.caseInsensitive = true;\r\n\t\t}\r\n\t}\r\n\treturn this.expression.evaluate(c);\r\n};\r\n\r\nXPath.XML_NAMESPACE_URI = \"http://www.w3.org/XML/1998/namespace\";\r\nXPath.XMLNS_NAMESPACE_URI = \"http://www.w3.org/2000/xmlns/\";\r\n\r\n// Expression ////////////////////////////////////////////////////////////////\r\n\r\nExpression.prototype = new Object();\r\nExpression.prototype.constructor = Expression;\r\nExpression.superclass = Object.prototype;\r\n\r\nfunction Expression() {\r\n}\r\n\r\nExpression.prototype.init = function() {\r\n};\r\n\r\nExpression.prototype.toString = function() {\r\n\treturn \"<Expression>\";\r\n};\r\n\r\nExpression.prototype.evaluate = function(c) {\r\n\tthrow new Error(\"Could not evaluate expression.\");\r\n};\r\n\r\n// UnaryOperation ////////////////////////////////////////////////////////////\r\n\r\nUnaryOperation.prototype = new Expression();\r\nUnaryOperation.prototype.constructor = UnaryOperation;\r\nUnaryOperation.superclass = Expression.prototype;\r\n\r\nfunction UnaryOperation(rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(rhs);\r\n\t}\r\n}\r\n\r\nUnaryOperation.prototype.init = function(rhs) {\r\n\tthis.rhs = rhs;\r\n};\r\n\r\n// UnaryMinusOperation ///////////////////////////////////////////////////////\r\n\r\nUnaryMinusOperation.prototype = new UnaryOperation();\r\nUnaryMinusOperation.prototype.constructor = UnaryMinusOperation;\r\nUnaryMinusOperation.superclass = UnaryOperation.prototype;\r\n\r\nfunction UnaryMinusOperation(rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(rhs);\r\n\t}\r\n}\r\n\r\nUnaryMinusOperation.prototype.init = function(rhs) {\r\n\tUnaryMinusOperation.superclass.init.call(this, rhs);\r\n};\r\n\r\nUnaryMinusOperation.prototype.evaluate = function(c) {\r\n\treturn this.rhs.evaluate(c).number().negate();\r\n};\r\n\r\nUnaryMinusOperation.prototype.toString = function() {\r\n\treturn \"-\" + this.rhs.toString();\r\n};\r\n\r\n// BinaryOperation ///////////////////////////////////////////////////////////\r\n\r\nBinaryOperation.prototype = new Expression();\r\nBinaryOperation.prototype.constructor = BinaryOperation;\r\nBinaryOperation.superclass = Expression.prototype;\r\n\r\nfunction BinaryOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nBinaryOperation.prototype.init = function(lhs, rhs) {\r\n\tthis.lhs = lhs;\r\n\tthis.rhs = rhs;\r\n};\r\n\r\n// OrOperation ///////////////////////////////////////////////////////////////\r\n\r\nOrOperation.prototype = new BinaryOperation();\r\nOrOperation.prototype.constructor = OrOperation;\r\nOrOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction OrOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nOrOperation.prototype.init = function(lhs, rhs) {\r\n\tOrOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nOrOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" or \" + this.rhs.toString() + \")\";\r\n};\r\n\r\nOrOperation.prototype.evaluate = function(c) {\r\n\tvar b = this.lhs.evaluate(c).bool();\r\n\tif (b.booleanValue()) {\r\n\t\treturn b;\r\n\t}\r\n\treturn this.rhs.evaluate(c).bool();\r\n};\r\n\r\n// AndOperation //////////////////////////////////////////////////////////////\r\n\r\nAndOperation.prototype = new BinaryOperation();\r\nAndOperation.prototype.constructor = AndOperation;\r\nAndOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction AndOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nAndOperation.prototype.init = function(lhs, rhs) {\r\n\tAndOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nAndOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" and \" + this.rhs.toString() + \")\";\r\n};\r\n\r\nAndOperation.prototype.evaluate = function(c) {\r\n\tvar b = this.lhs.evaluate(c).bool();\r\n\tif (!b.booleanValue()) {\r\n\t\treturn b;\r\n\t}\r\n\treturn this.rhs.evaluate(c).bool();\r\n};\r\n\r\n// EqualsOperation ///////////////////////////////////////////////////////////\r\n\r\nEqualsOperation.prototype = new BinaryOperation();\r\nEqualsOperation.prototype.constructor = EqualsOperation;\r\nEqualsOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction EqualsOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nEqualsOperation.prototype.init = function(lhs, rhs) {\r\n\tEqualsOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nEqualsOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" = \" + this.rhs.toString() + \")\";\r\n};\r\n\r\nEqualsOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).equals(this.rhs.evaluate(c));\r\n};\r\n\r\n// NotEqualOperation /////////////////////////////////////////////////////////\r\n\r\nNotEqualOperation.prototype = new BinaryOperation();\r\nNotEqualOperation.prototype.constructor = NotEqualOperation;\r\nNotEqualOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction NotEqualOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nNotEqualOperation.prototype.init = function(lhs, rhs) {\r\n\tNotEqualOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nNotEqualOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" != \" + this.rhs.toString() + \")\";\r\n};\r\n\r\nNotEqualOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).notequal(this.rhs.evaluate(c));\r\n};\r\n\r\n// LessThanOperation /////////////////////////////////////////////////////////\r\n\r\nLessThanOperation.prototype = new BinaryOperation();\r\nLessThanOperation.prototype.constructor = LessThanOperation;\r\nLessThanOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction LessThanOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nLessThanOperation.prototype.init = function(lhs, rhs) {\r\n\tLessThanOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nLessThanOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).lessthan(this.rhs.evaluate(c));\r\n};\r\n\r\nLessThanOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" < \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// GreaterThanOperation //////////////////////////////////////////////////////\r\n\r\nGreaterThanOperation.prototype = new BinaryOperation();\r\nGreaterThanOperation.prototype.constructor = GreaterThanOperation;\r\nGreaterThanOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction GreaterThanOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nGreaterThanOperation.prototype.init = function(lhs, rhs) {\r\n\tGreaterThanOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nGreaterThanOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).greaterthan(this.rhs.evaluate(c));\r\n};\r\n\r\nGreaterThanOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" > \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// LessThanOrEqualOperation //////////////////////////////////////////////////\r\n\r\nLessThanOrEqualOperation.prototype = new BinaryOperation();\r\nLessThanOrEqualOperation.prototype.constructor = LessThanOrEqualOperation;\r\nLessThanOrEqualOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction LessThanOrEqualOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nLessThanOrEqualOperation.prototype.init = function(lhs, rhs) {\r\n\tLessThanOrEqualOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nLessThanOrEqualOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).lessthanorequal(this.rhs.evaluate(c));\r\n};\r\n\r\nLessThanOrEqualOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" <= \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// GreaterThanOrEqualOperation ///////////////////////////////////////////////\r\n\r\nGreaterThanOrEqualOperation.prototype = new BinaryOperation();\r\nGreaterThanOrEqualOperation.prototype.constructor = GreaterThanOrEqualOperation;\r\nGreaterThanOrEqualOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction GreaterThanOrEqualOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nGreaterThanOrEqualOperation.prototype.init = function(lhs, rhs) {\r\n\tGreaterThanOrEqualOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nGreaterThanOrEqualOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).greaterthanorequal(this.rhs.evaluate(c));\r\n};\r\n\r\nGreaterThanOrEqualOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" >= \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// PlusOperation /////////////////////////////////////////////////////////////\r\n\r\nPlusOperation.prototype = new BinaryOperation();\r\nPlusOperation.prototype.constructor = PlusOperation;\r\nPlusOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction PlusOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nPlusOperation.prototype.init = function(lhs, rhs) {\r\n\tPlusOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nPlusOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).number().plus(this.rhs.evaluate(c).number());\r\n};\r\n\r\nPlusOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" + \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// MinusOperation ////////////////////////////////////////////////////////////\r\n\r\nMinusOperation.prototype = new BinaryOperation();\r\nMinusOperation.prototype.constructor = MinusOperation;\r\nMinusOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction MinusOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nMinusOperation.prototype.init = function(lhs, rhs) {\r\n\tMinusOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nMinusOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).number().minus(this.rhs.evaluate(c).number());\r\n};\r\n\r\nMinusOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" - \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// MultiplyOperation /////////////////////////////////////////////////////////\r\n\r\nMultiplyOperation.prototype = new BinaryOperation();\r\nMultiplyOperation.prototype.constructor = MultiplyOperation;\r\nMultiplyOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction MultiplyOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nMultiplyOperation.prototype.init = function(lhs, rhs) {\r\n\tMultiplyOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nMultiplyOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).number().multiply(this.rhs.evaluate(c).number());\r\n};\r\n\r\nMultiplyOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" * \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// DivOperation //////////////////////////////////////////////////////////////\r\n\r\nDivOperation.prototype = new BinaryOperation();\r\nDivOperation.prototype.constructor = DivOperation;\r\nDivOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction DivOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nDivOperation.prototype.init = function(lhs, rhs) {\r\n\tDivOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nDivOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).number().div(this.rhs.evaluate(c).number());\r\n};\r\n\r\nDivOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" div \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// ModOperation //////////////////////////////////////////////////////////////\r\n\r\nModOperation.prototype = new BinaryOperation();\r\nModOperation.prototype.constructor = ModOperation;\r\nModOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction ModOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nModOperation.prototype.init = function(lhs, rhs) {\r\n\tModOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nModOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).number().mod(this.rhs.evaluate(c).number());\r\n};\r\n\r\nModOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" mod \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// BarOperation //////////////////////////////////////////////////////////////\r\n\r\nBarOperation.prototype = new BinaryOperation();\r\nBarOperation.prototype.constructor = BarOperation;\r\nBarOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction BarOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nBarOperation.prototype.init = function(lhs, rhs) {\r\n\tBarOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nBarOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).nodeset().union(this.rhs.evaluate(c).nodeset());\r\n};\r\n\r\nBarOperation.prototype.toString = function() {\r\n\treturn this.lhs.toString() + \" | \" + this.rhs.toString();\r\n};\r\n\r\n// PathExpr //////////////////////////////////////////////////////////////////\r\n\r\nPathExpr.prototype = new Expression();\r\nPathExpr.prototype.constructor = PathExpr;\r\nPathExpr.superclass = Expression.prototype;\r\n\r\nfunction PathExpr(filter, filterPreds, locpath) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(filter, filterPreds, locpath);\r\n\t}\r\n}\r\n\r\nPathExpr.prototype.init = function(filter, filterPreds, locpath) {\r\n\tPathExpr.superclass.init.call(this);\r\n\tthis.filter = filter;\r\n\tthis.filterPredicates = filterPreds;\r\n\tthis.locationPath = locpath;\r\n};\r\n\r\nPathExpr.prototype.evaluate = function(c) {\r\n\tvar nodes;\r\n\tvar xpc = new XPathContext();\r\n\txpc.variableResolver = c.variableResolver;\r\n\txpc.functionResolver = c.functionResolver;\r\n\txpc.namespaceResolver = c.namespaceResolver;\r\n\txpc.expressionContextNode = c.expressionContextNode;\r\n\txpc.virtualRoot = c.virtualRoot;\r\n\txpc.caseInsensitive = c.caseInsensitive;\r\n\tif (this.filter == null) {\r\n\t\tnodes = [ c.contextNode ];\r\n\t} else {\r\n\t\tvar ns = this.filter.evaluate(c);\r\n\t\tif (!Utilities.instance_of(ns, XNodeSet)) {\r\n\t\t\tif (this.filterPredicates != null && this.filterPredicates.length > 0 || this.locationPath != null) {\r\n\t\t\t\tthrow new Error(\"Path expression filter must evaluate to a nodset if predicates or location path are used\");\r\n\t\t\t}\r\n\t\t\treturn ns;\r\n\t\t}\r\n\t\tnodes = ns.toArray();\r\n\t\tif (this.filterPredicates != null) {\r\n\t\t\t// apply each of the predicates in turn\r\n\t\t\tfor (var j = 0; j < this.filterPredicates.length; j++) {\r\n\t\t\t\tvar pred = this.filterPredicates[j];\r\n\t\t\t\tvar newNodes = [];\r\n\t\t\t\txpc.contextSize = nodes.length;\r\n\t\t\t\tfor (xpc.contextPosition = 1; xpc.contextPosition <= xpc.contextSize; xpc.contextPosition++) {\r\n\t\t\t\t\txpc.contextNode = nodes[xpc.contextPosition - 1];\r\n\t\t\t\t\tif (this.predicateMatches(pred, xpc)) {\r\n\t\t\t\t\t\tnewNodes.push(xpc.contextNode);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tnodes = newNodes;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (this.locationPath != null) {\r\n\t\tif (this.locationPath.absolute) {\r\n\t\t\tif (nodes[0].nodeType != 9 /*Node.DOCUMENT_NODE*/) {\r\n\t\t\t\tif (xpc.virtualRoot != null) {\r\n\t\t\t\t\tnodes = [ xpc.virtualRoot ];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (nodes[0].ownerDocument == null) {\r\n\t\t\t\t\t\t// IE 5.5 doesn't have ownerDocument?\r\n\t\t\t\t\t\tvar n = nodes[0];\r\n\t\t\t\t\t\twhile (n.parentNode != null) {\r\n\t\t\t\t\t\t\tn = n.parentNode;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnodes = [ n ];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnodes = [ nodes[0].ownerDocument ];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tnodes = [ nodes[0] ];\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (var i = 0; i < this.locationPath.steps.length; i++) {\r\n\t\t\tvar step = this.locationPath.steps[i];\r\n\t\t\tvar newNodes = [];\r\n\t\t\tvar newLocalContext = [];\r\n\t\t\tfor (var j = 0; j < nodes.length; j++) {\r\n\t\t\t\txpc.contextNode = nodes[j];\r\n\t\t\t\tswitch (step.axis) {\r\n\t\t\t\t\tcase Step.ANCESTOR:\r\n\t\t\t\t\t\t// look at all the ancestor nodes\r\n\t\t\t\t\t\tif (xpc.contextNode === xpc.virtualRoot) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar m;\r\n\t\t\t\t\t\tif (xpc.contextNode.nodeType == 2 /*Node.ATTRIBUTE_NODE*/) {\r\n\t\t\t\t\t\t\tm = this.getOwnerElement(xpc.contextNode);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tm = xpc.contextNode.parentNode;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\twhile (m != null) {\r\n\t\t\t\t\t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n\t\t\t\t\t\t\t\tnewNodes.push(m);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (m === xpc.virtualRoot) {\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tm = m.parentNode;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase Step.ANCESTORORSELF:\r\n\t\t\t\t\t\t// look at all the ancestor nodes and the current node\r\n\t\t\t\t\t\tfor (var m = xpc.contextNode; m != null; m = m.nodeType == 2 /*Node.ATTRIBUTE_NODE*/ ? this.getOwnerElement(m) : m.parentNode) {\r\n\t\t\t\t\t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n\t\t\t\t\t\t\t\tnewNodes.push(m);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (m === xpc.virtualRoot) {\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase Step.ATTRIBUTE:\r\n\t\t\t\t\t\t// look at the attributes\r\n\t\t\t\t\t\tvar nnm = xpc.contextNode.attributes;\r\n\t\t\t\t\t\tif (nnm != null) {\r\n\t\t\t\t\t\t\tfor (var k = 0; k < nnm.length; k++) {\r\n\t\t\t\t\t\t\t\tvar m = nnm.item(k);\r\n\t\t\t\t\t\t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n\t\t\t\t\t\t\t\t\tnewNodes.push(m);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase Step.CHILD:\r\n\t\t\t\t\t\t// look at all child elements\r\n\t\t\t\t\t\tvar pos = 0\r\n\t\t\t\t\t\tvar tmpContext = []\t\t\t\t\t\t\r\n\t\t\t\t\t\tfor (var m = xpc.contextNode.firstChild; m != null; m = m.nextSibling) {\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n\t\t\t\t\t\t\t\tnewNodes.push(m);\r\n\t\t\t\t\t\t\t\t//keep track of the element position between other matching siblings\r\n\t\t\t\t\t\t\t\ttmpContext.push({contextPosition: ++pos});\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\t\r\n\r\n\t\t\t\t\t\tfor (var k=0; k<tmpContext.length; k++) {\r\n\t\t\t\t\t\t\t//track size of matching siblings\r\n\t\t\t\t\t\t\ttmpContext[k].contextSize = pos\r\n\t\t\t\t\t\t\tnewLocalContext.push(tmpContext[k])\r\n\t\t\t\t\t\t}\t\t\t\t\t\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase Step.DESCENDANT:\r\n\t\t\t\t\t\t// look at all descendant nodes\r\n\t\t\t\t\t\tvar st = [ xpc.contextNode.firstChild ];\r\n\t\t\t\t\t\twhile (st.length > 0) {\r\n\t\t\t\t\t\t\tfor (var m = st.pop(); m != null; ) {\r\n\t\t\t\t\t\t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n\t\t\t\t\t\t\t\t\tnewNodes.push(m);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (m.firstChild != null) {\r\n\t\t\t\t\t\t\t\t\tst.push(m.nextSibling);\r\n\t\t\t\t\t\t\t\t\tm = m.firstChild;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tm = m.nextSibling;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase Step.DESCENDANTORSELF:\r\n\t\t\t\t\t\t// look at self\r\n\t\t\t\t\t\tif (step.nodeTest.matches(xpc.contextNode, xpc)) {\r\n\t\t\t\t\t\t\tnewNodes.push(xpc.contextNode);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// look at all descendant nodes\r\n\t\t\t\t\t\tvar st = [ xpc.contextNode.firstChild ];\r\n\t\t\t\t\t\twhile (st.length > 0) {\r\n\t\t\t\t\t\t\tfor (var m = st.pop(); m != null; ) {\r\n\t\t\t\t\t\t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n\t\t\t\t\t\t\t\t\tnewNodes.push(m);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (m.firstChild != null) {\r\n\t\t\t\t\t\t\t\t\tst.push(m.nextSibling);\r\n\t\t\t\t\t\t\t\t\tm = m.firstChild;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tm = m.nextSibling;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase Step.FOLLOWING:\r\n\t\t\t\t\t\tif (xpc.contextNode === xpc.virtualRoot) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar st = [];\r\n\t\t\t\t\t\tif (xpc.contextNode.firstChild != null) {\r\n\t\t\t\t\t\t\tst.unshift(xpc.contextNode.firstChild);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tst.unshift(xpc.contextNode.nextSibling);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (var m = xpc.contextNode; m != null && m.nodeType != 9 /*Node.DOCUMENT_NODE*/ && m !== xpc.virtualRoot; m = m.parentNode) {\r\n\t\t\t\t\t\t\tst.unshift(m.nextSibling);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdo {\r\n\t\t\t\t\t\t\tfor (var m = st.pop(); m != null; ) {\r\n\t\t\t\t\t\t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n\t\t\t\t\t\t\t\t\tnewNodes.push(m);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (m.firstChild != null) {\r\n\t\t\t\t\t\t\t\t\tst.push(m.nextSibling);\r\n\t\t\t\t\t\t\t\t\tm = m.firstChild;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tm = m.nextSibling;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} while (st.length > 0);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tcase Step.FOLLOWINGSIBLING:\r\n\t\t\t\t\t\tif (xpc.contextNode === xpc.virtualRoot) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (var m = xpc.contextNode.nextSibling; m != null; m = m.nextSibling) {\r\n\t\t\t\t\t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n\t\t\t\t\t\t\t\tnewNodes.push(m);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase Step.NAMESPACE:\r\n\t\t\t\t\t\tvar n = {};\r\n\t\t\t\t\t\tif (xpc.contextNode.nodeType == 1 /*Node.ELEMENT_NODE*/) {\r\n\t\t\t\t\t\t\tn[\"xml\"] = XPath.XML_NAMESPACE_URI;\r\n\t\t\t\t\t\t\tn[\"xmlns\"] = XPath.XMLNS_NAMESPACE_URI;\r\n\t\t\t\t\t\t\tfor (var m = xpc.contextNode; m != null && m.nodeType == 1 /*Node.ELEMENT_NODE*/; m = m.parentNode) {\r\n\t\t\t\t\t\t\t\tfor (var k = 0; k < m.attributes.length; k++) {\r\n\t\t\t\t\t\t\t\t\tvar attr = m.attributes.item(k);\r\n\t\t\t\t\t\t\t\t\tvar nm = String(attr.name);\r\n\t\t\t\t\t\t\t\t\tif (nm == \"xmlns\") {\r\n\t\t\t\t\t\t\t\t\t\tif (n[\"\"] == undefined) {\r\n\t\t\t\t\t\t\t\t\t\t\tn[\"\"] = attr.value;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else if (nm.length > 6 && nm.substring(0, 6) == \"xmlns:\") {\r\n\t\t\t\t\t\t\t\t\t\tvar pre = nm.substring(6, nm.length);\r\n\t\t\t\t\t\t\t\t\t\tif (n[pre] == undefined) {\r\n\t\t\t\t\t\t\t\t\t\t\tn[pre] = attr.value;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor (var pre in n) {\r\n\t\t\t\t\t\t\t\tvar nsn = new NamespaceNode(pre, n[pre], xpc.contextNode);\r\n\t\t\t\t\t\t\t\tif (step.nodeTest.matches(nsn, xpc)) {\r\n\t\t\t\t\t\t\t\t\tnewNodes.push(nsn);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase Step.PARENT:\r\n\t\t\t\t\t\tm = null;\r\n\t\t\t\t\t\tif (xpc.contextNode !== xpc.virtualRoot) {\r\n\t\t\t\t\t\t\tif (xpc.contextNode.nodeType == 2 /*Node.ATTRIBUTE_NODE*/) {\r\n\t\t\t\t\t\t\t\tm = this.getOwnerElement(xpc.contextNode);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tm = xpc.contextNode.parentNode;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (m != null && step.nodeTest.matches(m, xpc)) {\r\n\t\t\t\t\t\t\tnewNodes.push(m);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase Step.PRECEDING:\r\n\t\t\t\t\t\tvar st;\r\n\t\t\t\t\t\tif (xpc.virtualRoot != null) {\r\n\t\t\t\t\t\t\tst = [ xpc.virtualRoot ];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tst = xpc.contextNode.nodeType == 9 /*Node.DOCUMENT_NODE*/\r\n\t\t\t\t\t\t\t\t? [ xpc.contextNode ]\r\n\t\t\t\t\t\t\t\t: [ xpc.contextNode.ownerDocument ];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\touter: while (st.length > 0) {\r\n\t\t\t\t\t\t\tfor (var m = st.pop(); m != null; ) {\r\n\t\t\t\t\t\t\t\tif (m == xpc.contextNode) {\r\n\t\t\t\t\t\t\t\t\tbreak outer;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n\t\t\t\t\t\t\t\t\tnewNodes.unshift(m);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (m.firstChild != null) {\r\n\t\t\t\t\t\t\t\t\tst.push(m.nextSibling);\r\n\t\t\t\t\t\t\t\t\tm = m.firstChild;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tm = m.nextSibling;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase Step.PRECEDINGSIBLING:\r\n\t\t\t\t\t\tif (xpc.contextNode === xpc.virtualRoot) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (var m = xpc.contextNode.previousSibling; m != null; m = m.previousSibling) {\r\n\t\t\t\t\t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n\t\t\t\t\t\t\t\tnewNodes.push(m);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase Step.SELF:\r\n\t\t\t\t\t\tif (step.nodeTest.matches(xpc.contextNode, xpc)) {\r\n\t\t\t\t\t\t\tnewNodes.push(xpc.contextNode);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnodes = newNodes;\r\n\t\t\t// apply each of the predicates in turn\t\t\t\r\n\t\t\tfor (var j = 0; j < step.predicates.length; j++) {\r\n\t\t\t\tvar pred = step.predicates[j];\r\n\t\t\t\tvar newNodes = [];\r\n\t\t\t\txpc.contextSize = nodes.length;\r\n\t\t\t\tfor (xpc.contextPosition = 1; xpc.contextPosition <= xpc.contextSize; xpc.contextPosition++) {\r\n\t\t\t\t\txpc.contextNode = nodes[xpc.contextPosition - 1];\r\n\t\t\t\t\t//if we keep track of the node original context then use it\r\n\t\t\t\t\t//end goal is to always use original cotnext, now implemented just for CHILD axis\r\n\t\t\t\t\tvar localCtx = newLocalContext.length>0?this.getLocalCtx(xpc, newLocalContext[xpc.contextPosition-1]):xpc\r\n\t\t\t\t\tif (this.predicateMatches(pred, localCtx)) {\t\t\t\t\t\t\r\n\t\t\t\t\t\tnewNodes.push(xpc.contextNode);\t\t\t\t\t\t\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tnodes = newNodes;\r\n\t\t\t\t//console.log(nodes.length)\r\n\t\t\t}\r\n\t\t}\r\n\t}\t\r\n\tvar ns = new XNodeSet();\r\n\tns.addArray(nodes);\r\n\treturn ns;\r\n};\r\n\r\nPathExpr.prototype.getLocalCtx = function(xpc, localCtx, length) {\r\n\tvar res = new XPathContext();\r\n\tres.variableResolver = xpc.variableResolver;\r\n\tres.functionResolver = xpc.functionResolver;\r\n\tres.namespaceResolver = xpc.namespaceResolver;\r\n\tres.expressionContextNode = xpc.expressionContextNode;\r\n\tres.virtualRoot = xpc.virtualRoot;\r\n\tres.caseInsensitive = xpc.caseInsensitive;\r\n\tres.contextNode = xpc.contextNode;\r\n\tres.contextPosition = localCtx.contextPosition;\r\n\tres.contextSize = localCtx.contextSize;\t\r\n\treturn res;\r\n};\r\n\r\nPathExpr.prototype.predicateMatches = function(pred, c) {\r\n\tvar res = pred.evaluate(c);\r\n\tif (Utilities.instance_of(res, XNumber)) {\t\t\r\n\t\tvar val = c.contextPosition == res.numberValue()\t\t\r\n\t\treturn val;\r\n\t}\r\n\treturn res.booleanValue();\r\n};\r\n\r\nPathExpr.prototype.toString = function() {\r\n\tif (this.filter != undefined) {\r\n\t\tvar s = this.filter.toString();\r\n\t\tif (Utilities.instance_of(this.filter, XString)) {\r\n\t\t\ts = \"'\" + s + \"'\";\r\n\t\t}\r\n\t\tif (this.filterPredicates != undefined) {\r\n\t\t\tfor (var i = 0; i < this.filterPredicates.length; i++) {\r\n\t\t\t\ts = s + \"[\" + this.filterPredicates[i].toString() + \"]\";\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.locationPath != undefined) {\r\n\t\t\tif (!this.locationPath.absolute) {\r\n\t\t\t\ts += \"/\";\r\n\t\t\t}\r\n\t\t\ts += this.locationPath.toString();\r\n\t\t}\r\n\t\treturn s;\r\n\t}\r\n\treturn this.locationPath.toString();\r\n};\r\n\r\nPathExpr.prototype.getOwnerElement = function(n) {\r\n\t// DOM 2 has ownerElement\r\n\tif (n.ownerElement) {\r\n\t\treturn n.ownerElement;\r\n\t}\r\n\t// DOM 1 Internet Explorer can use selectSingleNode (ironically)\r\n\ttry {\r\n\t\tif (n.selectSingleNode) {\r\n\t\t\treturn n.selectSingleNode(\"..\");\r\n\t\t}\r\n\t} catch (e) {\r\n\t}\r\n\t// Other DOM 1 implementations must use this egregious search\r\n\tvar doc = n.nodeType == 9 /*Node.DOCUMENT_NODE*/\r\n\t\t\t? n\r\n\t\t\t: n.ownerDocument;\r\n\tvar elts = doc.getElementsByTagName(\"*\");\r\n\tfor (var i = 0; i < elts.length; i++) {\r\n\t\tvar elt = elts.item(i);\r\n\t\tvar nnm = elt.attributes;\r\n\t\tfor (var j = 0; j < nnm.length; j++) {\r\n\t\t\tvar an = nnm.item(j);\r\n\t\t\tif (an === n) {\r\n\t\t\t\treturn elt;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\n// LocationPath //////////////////////////////////////////////////////////////\r\n\r\nLocationPath.prototype = new Object();\r\nLocationPath.prototype.constructor = LocationPath;\r\nLocationPath.superclass = Object.prototype;\r\n\r\nfunction LocationPath(abs, steps) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(abs, steps);\r\n\t}\r\n}\r\n\r\nLocationPath.prototype.init = function(abs, steps) {\r\n\tthis.absolute = abs;\r\n\tthis.steps = steps;\r\n};\r\n\r\nLocationPath.prototype.toString = function() {\r\n\tvar s;\r\n\tif (this.absolute) {\r\n\t\ts = \"/\";\r\n\t} else {\r\n\t\ts = \"\";\r\n\t}\r\n\tfor (var i = 0; i < this.steps.length; i++) {\r\n\t\tif (i != 0) {\r\n\t\t\ts += \"/\";\r\n\t\t}\r\n\t\ts += this.steps[i].toString();\r\n\t}\r\n\treturn s;\r\n};\r\n\r\n// Step //////////////////////////////////////////////////////////////////////\r\n\r\nStep.prototype = new Object();\r\nStep.prototype.constructor = Step;\r\nStep.superclass = Object.prototype;\r\n\r\nfunction Step(axis, nodetest, preds) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(axis, nodetest, preds);\r\n\t}\r\n}\r\n\r\nStep.prototype.init = function(axis, nodetest, preds) {\r\n\tthis.axis = axis;\r\n\tthis.nodeTest = nodetest;\r\n\tthis.predicates = preds;\r\n};\r\n\r\nStep.prototype.toString = function() {\r\n\tvar s;\r\n\tswitch (this.axis) {\r\n\t\tcase Step.ANCESTOR:\r\n\t\t\ts = \"ancestor\";\r\n\t\t\tbreak;\r\n\t\tcase Step.ANCESTORORSELF:\r\n\t\t\ts = \"ancestor-or-self\";\r\n\t\t\tbreak;\r\n\t\tcase Step.ATTRIBUTE:\r\n\t\t\ts = \"attribute\";\r\n\t\t\tbreak;\r\n\t\tcase Step.CHILD:\r\n\t\t\ts = \"child\";\r\n\t\t\tbreak;\r\n\t\tcase Step.DESCENDANT:\r\n\t\t\ts = \"descendant\";\r\n\t\t\tbreak;\r\n\t\tcase Step.DESCENDANTORSELF:\r\n\t\t\ts = \"descendant-or-self\";\r\n\t\t\tbreak;\r\n\t\tcase Step.FOLLOWING:\r\n\t\t\ts = \"following\";\r\n\t\t\tbreak;\r\n\t\tcase Step.FOLLOWINGSIBLING:\r\n\t\t\ts = \"following-sibling\";\r\n\t\t\tbreak;\r\n\t\tcase Step.NAMESPACE:\r\n\t\t\ts = \"namespace\";\r\n\t\t\tbreak;\r\n\t\tcase Step.PARENT:\r\n\t\t\ts = \"parent\";\r\n\t\t\tbreak;\r\n\t\tcase Step.PRECEDING:\r\n\t\t\ts = \"preceding\";\r\n\t\t\tbreak;\r\n\t\tcase Step.PRECEDINGSIBLING:\r\n\t\t\ts = \"preceding-sibling\";\r\n\t\t\tbreak;\r\n\t\tcase Step.SELF:\r\n\t\t\ts = \"self\";\r\n\t\t\tbreak;\r\n\t}\r\n\ts += \"::\";\r\n\ts += this.nodeTest.toString();\r\n\tfor (var i = 0; i < this.predicates.length; i++) {\r\n\t\ts += \"[\" + this.predicates[i].toString() + \"]\";\r\n\t}\r\n\treturn s;\r\n};\r\n\r\nStep.ANCESTOR = 0;\r\nStep.ANCESTORORSELF = 1;\r\nStep.ATTRIBUTE = 2;\r\nStep.CHILD = 3;\r\nStep.DESCENDANT = 4;\r\nStep.DESCENDANTORSELF = 5;\r\nStep.FOLLOWING = 6;\r\nStep.FOLLOWINGSIBLING = 7;\r\nStep.NAMESPACE = 8;\r\nStep.PARENT = 9;\r\nStep.PRECEDING = 10;\r\nStep.PRECEDINGSIBLING = 11;\r\nStep.SELF = 12;\r\n\r\n// NodeTest //////////////////////////////////////////////////////////////////\r\n\r\nNodeTest.prototype = new Object();\r\nNodeTest.prototype.constructor = NodeTest;\r\nNodeTest.superclass = Object.prototype;\r\n\r\nfunction NodeTest(type, value) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(type, value);\r\n\t}\r\n}\r\n\r\nNodeTest.prototype.init = function(type, value) {\r\n\tthis.type = type;\r\n\tthis.value = value;\r\n};\r\n\r\nNodeTest.prototype.toString = function() {\r\n\tswitch (this.type) {\r\n\t\tcase NodeTest.NAMETESTANY:\r\n\t\t\treturn \"*\";\r\n\t\tcase NodeTest.NAMETESTPREFIXANY:\r\n\t\t\treturn this.value + \":*\";\r\n\t\tcase NodeTest.NAMETESTRESOLVEDANY:\r\n\t\t\treturn \"{\" + this.value + \"}*\";\r\n\t\tcase NodeTest.NAMETESTQNAME:\r\n\t\t\treturn this.value;\r\n\t\tcase NodeTest.NAMETESTRESOLVEDNAME:\r\n\t\t\treturn \"{\" + this.namespaceURI + \"}\" + this.value;\r\n\t\tcase NodeTest.COMMENT:\r\n\t\t\treturn \"comment()\";\r\n\t\tcase NodeTest.TEXT:\r\n\t\t\treturn \"text()\";\r\n\t\tcase NodeTest.PI:\r\n\t\t\tif (this.value != undefined) {\r\n\t\t\t\treturn \"processing-instruction(\\\"\" + this.value + \"\\\")\";\r\n\t\t\t}\r\n\t\t\treturn \"processing-instruction()\";\r\n\t\tcase NodeTest.NODE:\r\n\t\t\treturn \"node()\";\r\n\t}\r\n\treturn \"<unknown nodetest type>\";\r\n};\r\n\r\nNodeTest.prototype.matches = function(n, xpc) {\r\n\tswitch (this.type) {\r\n\t\tcase NodeTest.NAMETESTANY:\r\n\t\t\tif (n.nodeType == 2 /*Node.ATTRIBUTE_NODE*/\r\n\t\t\t\t\t|| n.nodeType == 1 /*Node.ELEMENT_NODE*/\r\n\t\t\t\t\t|| n.nodeType == XPathNamespace.XPATH_NAMESPACE_NODE) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\tcase NodeTest.NAMETESTPREFIXANY:\r\n\t\t\tif ((n.nodeType == 2 /*Node.ATTRIBUTE_NODE*/ || n.nodeType == 1 /*Node.ELEMENT_NODE*/)) {\r\n\t\t\t\tvar ns = xpc.namespaceResolver.getNamespace(this.value, xpc.expressionContextNode);\r\n\t\t\t\tif (ns == null) {\r\n\t\t\t\t\tthrow new Error(\"Cannot resolve QName \" + this.value);\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\t\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\tcase NodeTest.NAMETESTQNAME:\r\n\t\t\tif (n.nodeType == 2 /*Node.ATTRIBUTE_NODE*/\r\n\t\t\t\t\t|| n.nodeType == 1 /*Node.ELEMENT_NODE*/\r\n\t\t\t\t\t|| n.nodeType == XPathNamespace.XPATH_NAMESPACE_NODE) {\r\n\t\t\t\tvar test = Utilities.resolveQName(this.value, xpc.namespaceResolver, xpc.expressionContextNode, false);\r\n\t\t\t\tif (test[0] == null) {\r\n\t\t\t\t\tthrow new Error(\"Cannot resolve QName \" + this.value);\r\n\t\t\t\t}\r\n\t\t\t\ttest[0] = String(test[0]);\r\n\t\t\t\ttest[1] = String(test[1]);\r\n\t\t\t\tif (test[0] == \"\") {\r\n\t\t\t\t\ttest[0] = null;\r\n\t\t\t\t}\r\n\t\t\t\tvar node = Utilities.resolveQName(n.nodeName, xpc.namespaceResolver, n, n.nodeType == 1 /*Node.ELEMENT_NODE*/);\r\n\t\t\t\tnode[0] = String(node[0]);\r\n\t\t\t\tnode[1] = String(node[1]);\r\n\t\t\t\tif (node[0] == \"\") {\r\n\t\t\t\t\tnode[0] = null;\r\n\t\t\t\t}\r\n\t\t\t\tif (xpc.caseInsensitive) {\r\n\t\t\t\t\treturn test[0] == node[0] && String(test[1]).toLowerCase() == String(node[1]).toLowerCase();\r\n\t\t\t\t}\r\n\t\t\t\treturn test[0] == node[0] && test[1] == node[1];\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\tcase NodeTest.COMMENT:\r\n\t\t\treturn n.nodeType == 8 /*Node.COMMENT_NODE*/;\r\n\t\tcase NodeTest.TEXT:\r\n\t\t\treturn n.nodeType == 3 /*Node.TEXT_NODE*/ || n.nodeType == 4 /*Node.CDATA_SECTION_NODE*/;\r\n\t\tcase NodeTest.PI:\r\n\t\t\treturn n.nodeType == 7 /*Node.PROCESSING_INSTRUCTION_NODE*/\r\n\t\t\t\t&& (this.value == null || n.nodeName == this.value);\r\n\t\tcase NodeTest.NODE:\r\n\t\t\treturn n.nodeType == 9 /*Node.DOCUMENT_NODE*/\r\n\t\t\t\t|| n.nodeType == 1 /*Node.ELEMENT_NODE*/\r\n\t\t\t\t|| n.nodeType == 2 /*Node.ATTRIBUTE_NODE*/\r\n\t\t\t\t|| n.nodeType == 3 /*Node.TEXT_NODE*/\r\n\t\t\t\t|| n.nodeType == 4 /*Node.CDATA_SECTION_NODE*/\r\n\t\t\t\t|| n.nodeType == 8 /*Node.COMMENT_NODE*/\r\n\t\t\t\t|| n.nodeType == 7 /*Node.PROCESSING_INSTRUCTION_NODE*/;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nNodeTest.NAMETESTANY = 0;\r\nNodeTest.NAMETESTPREFIXANY = 1;\r\nNodeTest.NAMETESTQNAME = 2;\r\nNodeTest.COMMENT = 3;\r\nNodeTest.TEXT = 4;\r\nNodeTest.PI = 5;\r\nNodeTest.NODE = 6;\r\n\r\n// VariableReference /////////////////////////////////////////////////////////\r\n\r\nVariableReference.prototype = new Expression();\r\nVariableReference.prototype.constructor = VariableReference;\r\nVariableReference.superclass = Expression.prototype;\r\n\r\nfunction VariableReference(v) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(v);\r\n\t}\r\n}\r\n\r\nVariableReference.prototype.init = function(v) {\r\n\tthis.variable = v;\r\n};\r\n\r\nVariableReference.prototype.toString = function() {\r\n\treturn \"$\" + this.variable;\r\n};\r\n\r\nVariableReference.prototype.evaluate = function(c) {\r\n\treturn c.variableResolver.getVariable(this.variable, c);\r\n};\r\n\r\n// FunctionCall //////////////////////////////////////////////////////////////\r\n\r\nFunctionCall.prototype = new Expression();\r\nFunctionCall.prototype.constructor = FunctionCall;\r\nFunctionCall.superclass = Expression.prototype;\r\n\r\nfunction FunctionCall(fn, args) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(fn, args);\r\n\t}\r\n}\r\n\r\nFunctionCall.prototype.init = function(fn, args) {\r\n\tthis.functionName = fn;\r\n\tthis.arguments = args;\r\n};\r\n\r\nFunctionCall.prototype.toString = function() {\r\n\tvar s = this.functionName + \"(\";\r\n\tfor (var i = 0; i < this.arguments.length; i++) {\r\n\t\tif (i > 0) {\r\n\t\t\ts += \", \";\r\n\t\t}\r\n\t\ts += this.arguments[i].toString();\r\n\t}\r\n\treturn s + \")\";\r\n};\r\n\r\nFunctionCall.prototype.evaluate = function(c) {\r\n\tvar f = c.functionResolver.getFunction(this.functionName, c);\r\n\tif (f == undefined) {\r\n\t\tthrow new Error(\"Unknown function \" + this.functionName);\r\n\t}\r\n\tvar a = [c].concat(this.arguments);\r\n\treturn f.apply(c.functionResolver.thisArg, a);\r\n};\r\n\r\n// XString ///////////////////////////////////////////////////////////////////\r\n\r\nXString.prototype = new Expression();\r\nXString.prototype.constructor = XString;\r\nXString.superclass = Expression.prototype;\r\n\r\nfunction XString(s) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(s);\r\n\t}\r\n}\r\n\r\nXString.prototype.init = function(s) {\r\n\tthis.str = s;\r\n};\r\n\r\nXString.prototype.toString = function() {\r\n\treturn this.str;\r\n};\r\n\r\nXString.prototype.evaluate = function(c) {\r\n\treturn this;\r\n};\r\n\r\nXString.prototype.string = function() {\r\n\treturn this;\r\n};\r\n\r\nXString.prototype.number = function() {\r\n\treturn new XNumber(this.str);\r\n};\r\n\r\nXString.prototype.bool = function() {\r\n\treturn new XBoolean(this.str);\r\n};\r\n\r\nXString.prototype.nodeset = function() {\r\n\tthrow new Error(\"Cannot convert string to nodeset\");\r\n};\r\n\r\nXString.prototype.stringValue = function() {\r\n\treturn this.str;\r\n};\r\n\r\nXString.prototype.numberValue = function() {\r\n\treturn this.number().numberValue();\r\n};\r\n\r\nXString.prototype.booleanValue = function() {\r\n\treturn this.bool().booleanValue();\r\n};\r\n\r\nXString.prototype.equals = function(r) {\r\n\tif (Utilities.instance_of(r, XBoolean)) {\r\n\t\treturn this.bool().equals(r);\r\n\t}\r\n\tif (Utilities.instance_of(r, XNumber)) {\r\n\t\treturn this.number().equals(r);\r\n\t}\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithString(this, Operators.equals);\r\n\t}\r\n\treturn new XBoolean(this.str == r.str);\r\n};\r\n\r\nXString.prototype.notequal = function(r) {\r\n\tif (Utilities.instance_of(r, XBoolean)) {\r\n\t\treturn this.bool().notequal(r);\r\n\t}\r\n\tif (Utilities.instance_of(r, XNumber)) {\r\n\t\treturn this.number().notequal(r);\r\n\t}\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithString(this, Operators.notequal);\r\n\t}\r\n\treturn new XBoolean(this.str != r.str);\r\n};\r\n\r\nXString.prototype.lessthan = function(r) {\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this.number(), Operators.greaterthanorequal);\r\n\t}\r\n\treturn this.number().lessthan(r.number());\r\n};\r\n\r\nXString.prototype.greaterthan = function(r) {\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this.number(), Operators.lessthanorequal);\r\n\t}\r\n\treturn this.number().greaterthan(r.number());\r\n};\r\n\r\nXString.prototype.lessthanorequal = function(r) {\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this.number(), Operators.greaterthan);\r\n\t}\r\n\treturn this.number().lessthanorequal(r.number());\r\n};\r\n\r\nXString.prototype.greaterthanorequal = function(r) {\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this.number(), Operators.lessthan);\r\n\t}\r\n\treturn this.number().greaterthanorequal(r.number());\r\n};\r\n\r\n// XNumber ///////////////////////////////////////////////////////////////////\r\n\r\nXNumber.prototype = new Expression();\r\nXNumber.prototype.constructor = XNumber;\r\nXNumber.superclass = Expression.prototype;\r\n\r\nfunction XNumber(n) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(n);\r\n\t}\r\n}\r\n\r\nXNumber.prototype.init = function(n) {\r\n\tthis.num = Number(n);\r\n};\r\n\r\nXNumber.prototype.toString = function() {\r\n\treturn this.num;\r\n};\r\n\r\nXNumber.prototype.evaluate = function(c) {\r\n\treturn this;\r\n};\r\n\r\nXNumber.prototype.string = function() {\r\n\treturn new XString(this.num);\r\n};\r\n\r\nXNumber.prototype.number = function() {\r\n\treturn this;\r\n};\r\n\r\nXNumber.prototype.bool = function() {\r\n\treturn new XBoolean(this.num);\r\n};\r\n\r\nXNumber.prototype.nodeset = function() {\r\n\tthrow new Error(\"Cannot convert number to nodeset\");\r\n};\r\n\r\nXNumber.prototype.stringValue = function() {\r\n\treturn this.string().stringValue();\r\n};\r\n\r\nXNumber.prototype.numberValue = function() {\r\n\treturn this.num;\r\n};\r\n\r\nXNumber.prototype.booleanValue = function() {\r\n\treturn this.bool().booleanValue();\r\n};\r\n\r\nXNumber.prototype.negate = function() {\r\n\treturn new XNumber(-this.num);\r\n};\r\n\r\nXNumber.prototype.equals = function(r) {\r\n\tif (Utilities.instance_of(r, XBoolean)) {\r\n\t\treturn this.bool().equals(r);\r\n\t}\r\n\tif (Utilities.instance_of(r, XString)) {\r\n\t\treturn this.equals(r.number());\r\n\t}\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this, Operators.equals);\r\n\t}\r\n\treturn new XBoolean(this.num == r.num);\r\n};\r\n\r\nXNumber.prototype.notequal = function(r) {\r\n\tif (Utilities.instance_of(r, XBoolean)) {\r\n\t\treturn this.bool().notequal(r);\r\n\t}\r\n\tif (Utilities.instance_of(r, XString)) {\r\n\t\treturn this.notequal(r.number());\r\n\t}\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this, Operators.notequal);\r\n\t}\r\n\treturn new XBoolean(this.num != r.num);\r\n};\r\n\r\nXNumber.prototype.lessthan = function(r) {\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this, Operators.greaterthanorequal);\r\n\t}\r\n\tif (Utilities.instance_of(r, XBoolean) || Utilities.instance_of(r, XString)) {\r\n\t\treturn this.lessthan(r.number());\r\n\t}\r\n\treturn new XBoolean(this.num < r.num);\r\n};\r\n\r\nXNumber.prototype.greaterthan = function(r) {\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this, Operators.lessthanorequal);\r\n\t}\r\n\tif (Utilities.instance_of(r, XBoolean) || Utilities.instance_of(r, XString)) {\r\n\t\treturn this.greaterthan(r.number());\r\n\t}\r\n\treturn new XBoolean(this.num > r.num);\r\n};\r\n\r\nXNumber.prototype.lessthanorequal = function(r) {\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this, Operators.greaterthan);\r\n\t}\r\n\tif (Utilities.instance_of(r, XBoolean) || Utilities.instance_of(r, XString)) {\r\n\t\treturn this.lessthanorequal(r.number());\r\n\t}\r\n\treturn new XBoolean(this.num <= r.num);\r\n};\r\n\r\nXNumber.prototype.greaterthanorequal = function(r) {\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this, Operators.lessthan);\r\n\t}\r\n\tif (Utilities.instance_of(r, XBoolean) || Utilities.instance_of(r, XString)) {\r\n\t\treturn this.greaterthanorequal(r.number());\r\n\t}\r\n\treturn new XBoolean(this.num >= r.num);\r\n};\r\n\r\nXNumber.prototype.plus = function(r) {\r\n\treturn new XNumber(this.num + r.num);\r\n};\r\n\r\nXNumber.prototype.minus = function(r) {\r\n\treturn new XNumber(this.num - r.num);\r\n};\r\n\r\nXNumber.prototype.multiply = function(r) {\r\n\treturn new XNumber(this.num * r.num);\r\n};\r\n\r\nXNumber.prototype.div = function(r) {\r\n\treturn new XNumber(this.num / r.num);\r\n};\r\n\r\nXNumber.prototype.mod = function(r) {\r\n\treturn new XNumber(this.num % r.num);\r\n};\r\n\r\n// XBoolean //////////////////////////////////////////////////////////////////\r\n\r\nXBoolean.prototype = new Expression();\r\nXBoolean.prototype.constructor = XBoolean;\r\nXBoolean.superclass = Expression.prototype;\r\n\r\nfunction XBoolean(b) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(b);\r\n\t}\r\n}\r\n\r\nXBoolean.prototype.init = function(b) {\r\n\tthis.b = Boolean(b);\r\n};\r\n\r\nXBoolean.prototype.toString = function() {\r\n\treturn this.b.toString();\r\n};\r\n\r\nXBoolean.prototype.evaluate = function(c) {\r\n\treturn this;\r\n};\r\n\r\nXBoolean.prototype.string = function() {\r\n\treturn new XString(this.b);\r\n};\r\n\r\nXBoolean.prototype.number = function() {\r\n\treturn new XNumber(this.b);\r\n};\r\n\r\nXBoolean.prototype.bool = function() {\r\n\treturn this;\r\n};\r\n\r\nXBoolean.prototype.nodeset = function() {\r\n\tthrow new Error(\"Cannot convert boolean to nodeset\");\r\n};\r\n\r\nXBoolean.prototype.stringValue = function() {\r\n\treturn this.string().stringValue();\r\n};\r\n\r\nXBoolean.prototype.numberValue = function() {\r\n\treturn this.num().numberValue();\r\n};\r\n\r\nXBoolean.prototype.booleanValue = function() {\r\n\treturn this.b;\r\n};\r\n\r\nXBoolean.prototype.not = function() {\r\n\treturn new XBoolean(!this.b);\r\n};\r\n\r\nXBoolean.prototype.equals = function(r) {\r\n\tif (Utilities.instance_of(r, XString) || Utilities.instance_of(r, XNumber)) {\r\n\t\treturn this.equals(r.bool());\r\n\t}\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithBoolean(this, Operators.equals);\r\n\t}\r\n\treturn new XBoolean(this.b == r.b);\r\n};\r\n\r\nXBoolean.prototype.notequal = function(r) {\r\n\tif (Utilities.instance_of(r, XString) || Utilities.instance_of(r, XNumber)) {\r\n\t\treturn this.notequal(r.bool());\r\n\t}\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithBoolean(this, Operators.notequal);\r\n\t}\r\n\treturn new XBoolean(this.b != r.b);\r\n};\r\n\r\nXBoolean.prototype.lessthan = function(r) {\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this.number(), Operators.greaterthanorequal);\r\n\t}\r\n\treturn this.number().lessthan(r.number());\r\n};\r\n\r\nXBoolean.prototype.greaterthan = function(r) {\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this.number(), Operators.lessthanorequal);\r\n\t}\r\n\treturn this.number().greaterthan(r.number());\r\n};\r\n\r\nXBoolean.prototype.lessthanorequal = function(r) {\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this.number(), Operators.greaterthan);\r\n\t}\r\n\treturn this.number().lessthanorequal(r.number());\r\n};\r\n\r\nXBoolean.prototype.greaterthanorequal = function(r) {\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this.number(), Operators.lessthan);\r\n\t}\r\n\treturn this.number().greaterthanorequal(r.number());\r\n};\r\n\r\n// AVLTree ///////////////////////////////////////////////////////////////////\r\n\r\nAVLTree.prototype = new Object();\r\nAVLTree.prototype.constructor = AVLTree;\r\nAVLTree.superclass = Object.prototype;\r\n\r\nfunction AVLTree(n) {\r\n\tthis.init(n);\r\n}\r\n\r\nAVLTree.prototype.init = function(n) {\r\n\tthis.left = null;\r\n    this.right = null;\r\n\tthis.node = n;\r\n\tthis.depth = 1;\r\n};\r\n\r\nAVLTree.prototype.balance = function() {\r\n    var ldepth = this.left  == null ? 0 : this.left.depth;\r\n    var rdepth = this.right == null ? 0 : this.right.depth;\r\n\r\n\tif (ldepth > rdepth + 1) {\r\n        // LR or LL rotation\r\n        var lldepth = this.left.left  == null ? 0 : this.left.left.depth;\r\n        var lrdepth = this.left.right == null ? 0 : this.left.right.depth;\r\n\r\n        if (lldepth < lrdepth) {\r\n            // LR rotation consists of a RR rotation of the left child\r\n            this.left.rotateRR();\r\n            // plus a LL rotation of this node, which happens anyway \r\n        }\r\n        this.rotateLL();       \r\n    } else if (ldepth + 1 < rdepth) {\r\n        // RR or RL rorarion\r\n\t\tvar rrdepth = this.right.right == null ? 0 : this.right.right.depth;\r\n\t\tvar rldepth = this.right.left  == null ? 0 : this.right.left.depth;\r\n\t \r\n        if (rldepth > rrdepth) {\r\n            // RR rotation consists of a LL rotation of the right child\r\n            this.right.rotateLL();\r\n            // plus a RR rotation of this node, which happens anyway \r\n        }\r\n        this.rotateRR();\r\n    }\t     \r\n};\r\n\r\nAVLTree.prototype.rotateLL = function() {\r\n    // the left side is too long => rotate from the left (_not_ leftwards)\r\n    var nodeBefore = this.node;\r\n    var rightBefore = this.right;\r\n    this.node = this.left.node;\r\n    this.right = this.left;\r\n    this.left = this.left.left;\r\n    this.right.left = this.right.right;\r\n    this.right.right = rightBefore;\r\n    this.right.node = nodeBefore;\r\n    this.right.updateInNewLocation();\r\n    this.updateInNewLocation();\r\n};\r\n\r\nAVLTree.prototype.rotateRR = function() {\r\n    // the right side is too long => rotate from the right (_not_ rightwards)\r\n    var nodeBefore = this.node;\r\n    var leftBefore = this.left;\r\n    this.node = this.right.node;\r\n    this.left = this.right;\r\n    this.right = this.right.right;\r\n    this.left.right = this.left.left;\r\n    this.left.left = leftBefore;\r\n    this.left.node = nodeBefore;\r\n    this.left.updateInNewLocation();\r\n    this.updateInNewLocation();\r\n}; \r\n\t\r\nAVLTree.prototype.updateInNewLocation = function() {\r\n    this.getDepthFromChildren();\r\n};\r\n\r\nAVLTree.prototype.getDepthFromChildren = function() {\r\n    this.depth = this.node == null ? 0 : 1;\r\n    if (this.left != null) {\r\n        this.depth = this.left.depth + 1;\r\n    }\r\n    if (this.right != null && this.depth <= this.right.depth) {\r\n        this.depth = this.right.depth + 1;\r\n    }\r\n};\r\n\r\nAVLTree.prototype.order = function(n1, n2) {\r\n\tif (n1 === n2) {\r\n\t\treturn 0;\r\n\t}\r\n\tvar d1 = 0;\r\n\tvar d2 = 0;\r\n\tfor (var m1 = n1; m1 != null; m1 = m1.parentNode) {\r\n\t\td1++;\r\n\t}\r\n\tfor (var m2 = n2; m2 != null; m2 = m2.parentNode) {\r\n\t\td2++;\r\n\t}\r\n\tif (d1 > d2) {\r\n\t\twhile (d1 > d2) {\r\n\t\t\tn1 = n1.parentNode;\r\n\t\t\td1--;\r\n\t\t}\r\n\t\tif (n1 == n2) {\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t} else if (d2 > d1) {\r\n\t\twhile (d2 > d1) {\r\n\t\t\tn2 = n2.parentNode;\r\n\t\t\td2--;\r\n\t\t}\r\n\t\tif (n1 == n2) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t}\r\n\twhile (n1.parentNode != n2.parentNode) {\r\n\t\tn1 = n1.parentNode;\r\n\t\tn2 = n2.parentNode;\r\n\t}\r\n\twhile (n1.previousSibling != null && n2.previousSibling != null) {\r\n\t\tn1 = n1.previousSibling;\r\n\t\tn2 = n2.previousSibling;\r\n\t}\r\n\tif (n1.previousSibling == null) {\r\n\t\treturn -1;\r\n\t}\r\n\treturn 1;\r\n};\r\n\r\nAVLTree.prototype.add = function(n)  {\r\n\tif (n === this.node) {\r\n        return false;\r\n    }\r\n\t\r\n\tvar o = this.order(n, this.node);\r\n\t\r\n    var ret = false;\r\n    if (o == -1) {\r\n        if (this.left == null) {\r\n            this.left = new AVLTree(n);\r\n            ret = true;\r\n        } else {\r\n            ret = this.left.add(n);\r\n            if (ret) {\r\n                this.balance();\r\n            }\r\n        }\r\n    } else if (o == 1) {\r\n        if (this.right == null) {\r\n            this.right = new AVLTree(n);\r\n            ret = true;\r\n        } else {\r\n            ret = this.right.add(n);\r\n            if (ret) {\r\n                this.balance();\r\n            }\r\n        }\r\n    }\r\n\t\r\n    if (ret) {\r\n        this.getDepthFromChildren();\r\n    }\r\n    return ret;\r\n};\r\n\r\n// XNodeSet //////////////////////////////////////////////////////////////////\r\n\r\nXNodeSet.prototype = new Expression();\r\nXNodeSet.prototype.constructor = XNodeSet;\r\nXNodeSet.superclass = Expression.prototype;\r\n\r\nfunction XNodeSet() {\r\n\tthis.init();\r\n}\r\n\r\nXNodeSet.prototype.init = function() {\r\n\tthis.tree = null;\r\n\tthis.size = 0;\r\n};\r\n\r\nXNodeSet.prototype.toString = function() {\r\n\tvar p = this.first();\r\n\tif (p == null) {\r\n\t\treturn \"\";\r\n\t}\r\n\treturn this.stringForNode(p);\r\n};\r\n\r\nXNodeSet.prototype.evaluate = function(c) {\r\n\treturn this;\r\n};\r\n\r\nXNodeSet.prototype.string = function() {\r\n\treturn new XString(this.toString());\r\n};\r\n\r\nXNodeSet.prototype.stringValue = function() {\r\n\treturn this.toString();\r\n};\r\n\r\nXNodeSet.prototype.number = function() {\r\n\treturn new XNumber(this.string());\r\n};\r\n\r\nXNodeSet.prototype.numberValue = function() {\r\n\treturn Number(this.string());\r\n};\r\n\r\nXNodeSet.prototype.bool = function() {\r\n\treturn new XBoolean(this.tree != null);\r\n};\r\n\r\nXNodeSet.prototype.booleanValue = function() {\r\n\treturn this.tree != null;\r\n};\r\n\r\nXNodeSet.prototype.nodeset = function() {\r\n\treturn this;\r\n};\r\n\r\nXNodeSet.prototype.stringForNode = function(n) {\r\n\tif (n.nodeType == 9 /*Node.DOCUMENT_NODE*/) {\r\n\t\tn = n.documentElement;\r\n\t}\r\n\tif (n.nodeType == 1 /*Node.ELEMENT_NODE*/) {\r\n\t\treturn this.stringForNodeRec(n);\r\n\t}\r\n\tif (n.isNamespaceNode) {\r\n\t\treturn n.namespace;\r\n\t}\r\n\treturn n.nodeValue;\r\n};\r\n\r\nXNodeSet.prototype.stringForNodeRec = function(n) {\r\n\tvar s = \"\";\r\n\tfor (var n2 = n.firstChild; n2 != null; n2 = n2.nextSibling) {\r\n\t\tif (n2.nodeType == 3 /*Node.TEXT_NODE*/) {\r\n\t\t\ts += n2.nodeValue;\r\n\t\t} else if (n2.nodeType == 1 /*Node.ELEMENT_NODE*/) {\r\n\t\t\ts += this.stringForNodeRec(n2);\r\n\t\t}\r\n\t}\r\n\treturn s;\r\n};\r\n\r\nXNodeSet.prototype.first = function() {\r\n\tvar p = this.tree;\r\n\tif (p == null) {\r\n\t\treturn null;\r\n\t}\r\n\twhile (p.left != null) {\r\n\t\tp = p.left;\r\n\t}\r\n\treturn p.node;\r\n};\r\n\r\nXNodeSet.prototype.add = function(n) {\r\n    var added;\r\n    if (this.tree == null) {\r\n        this.tree = new AVLTree(n);\r\n        added = true;\r\n    } else {\r\n        added = this.tree.add(n);\r\n    }\r\n    if (added) {\r\n        this.size++;\r\n    }\r\n};\r\n\r\nXNodeSet.prototype.addArray = function(ns) {\r\n\tfor (var i = 0; i < ns.length; i++) {\r\n\t\tthis.add(ns[i]);\r\n\t}\r\n};\r\n\r\nXNodeSet.prototype.toArray = function() {\r\n\tvar a = [];\r\n\tthis.toArrayRec(this.tree, a);\r\n\treturn a;\r\n};\r\n\r\nXNodeSet.prototype.toArrayRec = function(t, a) {\r\n\tif (t != null) {\r\n\t\tthis.toArrayRec(t.left, a);\r\n\t\ta.push(t.node);\r\n\t\tthis.toArrayRec(t.right, a);\r\n\t}\r\n};\r\n\r\nXNodeSet.prototype.compareWithString = function(r, o) {\r\n\tvar a = this.toArray();\r\n\tfor (var i = 0; i < a.length; i++) {\r\n\t\tvar n = a[i];\r\n\t\tvar l = new XString(this.stringForNode(n));\r\n\t\tvar res = o(l, r);\r\n\t\tif (res.booleanValue()) {\r\n\t\t\treturn res;\r\n\t\t}\r\n\t}\r\n\treturn new XBoolean(false);\r\n};\r\n\r\nXNodeSet.prototype.compareWithNumber = function(r, o) {\r\n\tvar a = this.toArray();\r\n\tfor (var i = 0; i < a.length; i++) {\r\n\t\tvar n = a[i];\r\n\t\tvar l = new XNumber(this.stringForNode(n));\r\n\t\tvar res = o(l, r);\r\n\t\tif (res.booleanValue()) {\r\n\t\t\treturn res;\r\n\t\t}\r\n\t}\r\n\treturn new XBoolean(false);\r\n};\r\n\r\nXNodeSet.prototype.compareWithBoolean = function(r, o) {\r\n\treturn o(this.bool(), r);\r\n};\r\n\r\nXNodeSet.prototype.compareWithNodeSet = function(r, o) {\r\n\tvar a = this.toArray();\r\n\tfor (var i = 0; i < a.length; i++) {\r\n\t\tvar n = a[i];\r\n\t\tvar l = new XString(this.stringForNode(n));\r\n\t\tvar b = r.toArray();\r\n\t\tfor (var j = 0; j < b.length; j++) {\r\n\t\t\tvar n2 = b[j];\r\n\t\t\tvar r = new XString(this.stringForNode(n2));\r\n\t\t\tvar res = o(l, r);\r\n\t\t\tif (res.booleanValue()) {\r\n\t\t\t\treturn res;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn new XBoolean(false);\r\n};\r\n\r\nXNodeSet.prototype.equals = function(r) {\r\n\tif (Utilities.instance_of(r, XString)) {\r\n\t\treturn this.compareWithString(r, Operators.equals);\r\n\t}\r\n\tif (Utilities.instance_of(r, XNumber)) {\r\n\t\treturn this.compareWithNumber(r, Operators.equals);\r\n\t}\r\n\tif (Utilities.instance_of(r, XBoolean)) {\r\n\t\treturn this.compareWithBoolean(r, Operators.equals);\r\n\t}\r\n\treturn this.compareWithNodeSet(r, Operators.equals);\r\n};\r\n\r\nXNodeSet.prototype.notequal = function(r) {\r\n\tif (Utilities.instance_of(r, XString)) {\r\n\t\treturn this.compareWithString(r, Operators.notequal);\r\n\t}\r\n\tif (Utilities.instance_of(r, XNumber)) {\r\n\t\treturn this.compareWithNumber(r, Operators.notequal);\r\n\t}\r\n\tif (Utilities.instance_of(r, XBoolean)) {\r\n\t\treturn this.compareWithBoolean(r, Operators.notequal);\r\n\t}\r\n\treturn this.compareWithNodeSet(r, Operators.notequal);\r\n};\r\n\r\nXNodeSet.prototype.lessthan = function(r) {\r\n\tif (Utilities.instance_of(r, XString)) {\r\n\t\treturn this.compareWithNumber(r.number(), Operators.lessthan);\r\n\t}\r\n\tif (Utilities.instance_of(r, XNumber)) {\r\n\t\treturn this.compareWithNumber(r, Operators.lessthan);\r\n\t}\r\n\tif (Utilities.instance_of(r, XBoolean)) {\r\n\t\treturn this.compareWithBoolean(r, Operators.lessthan);\r\n\t}\r\n\treturn this.compareWithNodeSet(r, Operators.lessthan);\r\n};\r\n\r\nXNodeSet.prototype.greaterthan = function(r) {\r\n\tif (Utilities.instance_of(r, XString)) {\r\n\t\treturn this.compareWithNumber(r.number(), Operators.greaterthan);\r\n\t}\r\n\tif (Utilities.instance_of(r, XNumber)) {\r\n\t\treturn this.compareWithNumber(r, Operators.greaterthan);\r\n\t}\r\n\tif (Utilities.instance_of(r, XBoolean)) {\r\n\t\treturn this.compareWithBoolean(r, Operators.greaterthan);\r\n\t}\r\n\treturn this.compareWithNodeSet(r, Operators.greaterthan);\r\n};\r\n\r\nXNodeSet.prototype.lessthanorequal = function(r) {\r\n\tif (Utilities.instance_of(r, XString)) {\r\n\t\treturn this.compareWithNumber(r.number(), Operators.lessthanorequal);\r\n\t}\r\n\tif (Utilities.instance_of(r, XNumber)) {\r\n\t\treturn this.compareWithNumber(r, Operators.lessthanorequal);\r\n\t}\r\n\tif (Utilities.instance_of(r, XBoolean)) {\r\n\t\treturn this.compareWithBoolean(r, Operators.lessthanorequal);\r\n\t}\r\n\treturn this.compareWithNodeSet(r, Operators.lessthanorequal);\r\n};\r\n\r\nXNodeSet.prototype.greaterthanorequal = function(r) {\r\n\tif (Utilities.instance_of(r, XString)) {\r\n\t\treturn this.compareWithNumber(r.number(), Operators.greaterthanorequal);\r\n\t}\r\n\tif (Utilities.instance_of(r, XNumber)) {\r\n\t\treturn this.compareWithNumber(r, Operators.greaterthanorequal);\r\n\t}\r\n\tif (Utilities.instance_of(r, XBoolean)) {\r\n\t\treturn this.compareWithBoolean(r, Operators.greaterthanorequal);\r\n\t}\r\n\treturn this.compareWithNodeSet(r, Operators.greaterthanorequal);\r\n};\r\n\r\nXNodeSet.prototype.union = function(r) {\r\n\tvar ns = new XNodeSet();\r\n\tns.tree = this.tree;\r\n\tns.size = this.size;\r\n\tns.addArray(r.toArray());\r\n\treturn ns;\r\n};\r\n\r\n// XPathNamespace ////////////////////////////////////////////////////////////\r\n\r\nXPathNamespace.prototype = new Object();\r\nXPathNamespace.prototype.constructor = XPathNamespace;\r\nXPathNamespace.superclass = Object.prototype;\r\n\r\nfunction XPathNamespace(pre, ns, p) {\r\n\tthis.isXPathNamespace = true;\r\n\tthis.ownerDocument = p.ownerDocument;\r\n\tthis.nodeName = \"#namespace\";\r\n\tthis.prefix = pre;\r\n\tthis.localName = pre;\r\n\tthis.namespaceURI = ns;\r\n\tthis.nodeValue = ns;\r\n\tthis.ownerElement = p;\r\n\tthis.nodeType = XPathNamespace.XPATH_NAMESPACE_NODE;\r\n}\r\n\r\nXPathNamespace.prototype.toString = function() {\r\n\treturn \"{ \\\"\" + this.prefix + \"\\\", \\\"\" + this.namespaceURI + \"\\\" }\";\r\n};\r\n\r\n// Operators /////////////////////////////////////////////////////////////////\r\n\r\nvar Operators = new Object();\r\n\r\nOperators.equals = function(l, r) {\r\n\treturn l.equals(r);\r\n};\r\n\r\nOperators.notequal = function(l, r) {\r\n\treturn l.notequal(r);\r\n};\r\n\r\nOperators.lessthan = function(l, r) {\r\n\treturn l.lessthan(r);\r\n};\r\n\r\nOperators.greaterthan = function(l, r) {\r\n\treturn l.greaterthan(r);\r\n};\r\n\r\nOperators.lessthanorequal = function(l, r) {\r\n\treturn l.lessthanorequal(r);\r\n};\r\n\r\nOperators.greaterthanorequal = function(l, r) {\r\n\treturn l.greaterthanorequal(r);\r\n};\r\n\r\n// XPathContext //////////////////////////////////////////////////////////////\r\n\r\nXPathContext.prototype = new Object();\r\nXPathContext.prototype.constructor = XPathContext;\r\nXPathContext.superclass = Object.prototype;\r\n\r\nfunction XPathContext(vr, nr, fr) {\r\n\tthis.variableResolver = vr != null ? vr : new VariableResolver();\r\n\tthis.namespaceResolver = nr != null ? nr : new NamespaceResolver();\r\n\tthis.functionResolver = fr != null ? fr : new FunctionResolver();\r\n}\r\n\r\n// VariableResolver //////////////////////////////////////////////////////////\r\n\r\nVariableResolver.prototype = new Object();\r\nVariableResolver.prototype.constructor = VariableResolver;\r\nVariableResolver.superclass = Object.prototype;\r\n\r\nfunction VariableResolver() {\r\n}\r\n\r\nVariableResolver.prototype.getVariable = function(vn, c) {\r\n\tvar parts = Utilities.splitQName(vn);\r\n\tif (parts[0] != null) {\r\n\t\tparts[0] = c.namespaceResolver.getNamespace(parts[0], c.expressionContextNode);\r\n        if (parts[0] == null) {\r\n            throw new Error(\"Cannot resolve QName \" + fn);\r\n        }\r\n\t}\r\n\treturn this.getVariableWithName(parts[0], parts[1], c.expressionContextNode);\r\n};\r\n\r\nVariableResolver.prototype.getVariableWithName = function(ns, ln, c) {\r\n\treturn null;\r\n};\r\n\r\n// FunctionResolver //////////////////////////////////////////////////////////\r\n\r\nFunctionResolver.prototype = new Object();\r\nFunctionResolver.prototype.constructor = FunctionResolver;\r\nFunctionResolver.superclass = Object.prototype;\r\n\r\nfunction FunctionResolver(thisArg) {\r\n\tthis.thisArg = thisArg != null ? thisArg : Functions;\r\n\tthis.functions = new Object();\r\n\tthis.addStandardFunctions();\r\n}\r\n\r\nFunctionResolver.prototype.addStandardFunctions = function() {\r\n\tthis.functions[\"{}last\"] = Functions.last;\r\n\tthis.functions[\"{}position\"] = Functions.position;\r\n\tthis.functions[\"{}count\"] = Functions.count;\r\n\tthis.functions[\"{}id\"] = Functions.id;\r\n\tthis.functions[\"{}local-name\"] = Functions.localName;\r\n\tthis.functions[\"{}namespace-uri\"] = Functions.namespaceURI;\r\n\tthis.functions[\"{}name\"] = Functions.name;\r\n\tthis.functions[\"{}string\"] = Functions.string;\r\n\tthis.functions[\"{}concat\"] = Functions.concat;\r\n\tthis.functions[\"{}starts-with\"] = Functions.startsWith;\r\n\tthis.functions[\"{}contains\"] = Functions.contains;\r\n\tthis.functions[\"{}substring-before\"] = Functions.substringBefore;\r\n\tthis.functions[\"{}substring-after\"] = Functions.substringAfter;\r\n\tthis.functions[\"{}substring\"] = Functions.substring;\r\n\tthis.functions[\"{}string-length\"] = Functions.stringLength;\r\n\tthis.functions[\"{}normalize-space\"] = Functions.normalizeSpace;\r\n\tthis.functions[\"{}translate\"] = Functions.translate;\r\n\tthis.functions[\"{}boolean\"] = Functions.boolean_;\r\n\tthis.functions[\"{}not\"] = Functions.not;\r\n\tthis.functions[\"{}true\"] = Functions.true_;\r\n\tthis.functions[\"{}false\"] = Functions.false_;\r\n\tthis.functions[\"{}lang\"] = Functions.lang;\r\n\tthis.functions[\"{}number\"] = Functions.number;\r\n\tthis.functions[\"{}sum\"] = Functions.sum;\r\n\tthis.functions[\"{}floor\"] = Functions.floor;\r\n\tthis.functions[\"{}ceiling\"] = Functions.ceiling;\r\n\tthis.functions[\"{}round\"] = Functions.round;\r\n};\r\n\r\nFunctionResolver.prototype.addFunction = function(ns, ln, f) {\r\n\tthis.functions[\"{\" + ns + \"}\" + ln] = f;\r\n};\r\n\r\nFunctionResolver.prototype.getFunction = function(fn, c) {\r\n\tvar parts = Utilities.resolveQName(fn, c.namespaceResolver, c.contextNode, false);\r\n    if (parts[0] == null) {\r\n        throw new Error(\"Cannot resolve QName \" + fn);\r\n    }\r\n\treturn this.getFunctionWithName(parts[0], parts[1], c.contextNode);\r\n};\r\n\r\nFunctionResolver.prototype.getFunctionWithName = function(ns, ln, c) {\r\n\treturn this.functions[\"{\" + ns + \"}\" + ln];\r\n};\r\n\r\n// NamespaceResolver /////////////////////////////////////////////////////////\r\n\r\nNamespaceResolver.prototype = new Object();\r\nNamespaceResolver.prototype.constructor = NamespaceResolver;\r\nNamespaceResolver.superclass = Object.prototype;\r\n\r\nfunction NamespaceResolver() {\r\n}\r\n\r\nNamespaceResolver.prototype.getNamespace = function(prefix, n) {\r\n\tif (prefix == \"xml\") {\r\n\t\treturn XPath.XML_NAMESPACE_URI;\r\n\t} else if (prefix == \"xmlns\") {\r\n\t\treturn XPath.XMLNS_NAMESPACE_URI;\r\n\t}\r\n\tif (n.nodeType == 9 /*Node.DOCUMENT_NODE*/) {\r\n\t\tn = n.documentElement;\r\n\t} else if (n.nodeType == 2 /*Node.ATTRIBUTE_NODE*/) {\r\n\t\tn = PathExpr.prototype.getOwnerElement(n);\r\n\t} else if (n.nodeType != 1 /*Node.ELEMENT_NODE*/) {\r\n\t\tn = n.parentNode;\r\n\t}\r\n\twhile (n != null && n.nodeType == 1 /*Node.ELEMENT_NODE*/) {\r\n\t\tvar nnm = n.attributes;\r\n\t\tfor (var i = 0; i < nnm.length; i++) {\r\n\t\t\tvar a = nnm.item(i);\r\n\t\t\tvar aname = a.nodeName;\r\n\t\t\tif (aname == \"xmlns\" && prefix == \"\"\r\n\t\t\t\t\t|| aname == \"xmlns:\" + prefix) {\r\n\t\t\t\treturn String(a.nodeValue);\r\n\t\t\t}\r\n\t\t}\r\n\t\tn = n.parentNode;\r\n\t}\r\n\treturn null;\r\n};\r\n\r\n// Functions /////////////////////////////////////////////////////////////////\r\n\r\nvar Functions = new Object();\r\n\r\nFunctions.last = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 1) {\r\n\t\tthrow new Error(\"Function last expects ()\");\r\n\t}\r\n\treturn new XNumber(c.contextSize);\r\n};\r\n\r\nFunctions.position = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 1) {\r\n\t\tthrow new Error(\"Function position expects ()\");\r\n\t}\r\n\treturn new XNumber(c.contextPosition);\r\n};\r\n\r\nFunctions.count = function() {\r\n\tvar c = arguments[0];\r\n\tvar ns;\r\n\tif (arguments.length != 2 || !Utilities.instance_of(ns = arguments[1].evaluate(c), XNodeSet)) {\r\n\t\tthrow new Error(\"Function count expects (node-set)\");\r\n\t}\r\n\treturn new XNumber(ns.size);\r\n};\r\n\r\nFunctions.id = function() {\r\n\tvar c = arguments[0];\r\n\tvar id;\r\n\tif (arguments.length != 2) {\r\n\t\tthrow new Error(\"Function id expects (object)\");\r\n\t}\r\n\tid = arguments[1].evaluate(c);\r\n\tif (Utilities.instance_of(id, XNodeSet)) {\r\n\t\tid = id.toArray().join(\" \");\r\n\t} else {\r\n\t\tid = id.stringValue();\r\n\t}\r\n\tvar ids = id.split(/[\\x0d\\x0a\\x09\\x20]+/);\r\n\tvar count = 0;\r\n\tvar ns = new XNodeSet();\r\n\tvar doc = c.contextNode.nodeType == 9 /*Node.DOCUMENT_NODE*/\r\n\t\t\t? c.contextNode\r\n\t\t\t: c.contextNode.ownerDocument;\r\n\tfor (var i = 0; i < ids.length; i++) {\r\n\t\tvar n;\r\n\t\tif (doc.getElementById) {\r\n\t\t\tn = doc.getElementById(ids[i]);\r\n\t\t} else {\r\n\t\t\tn = Utilities.getElementById(doc, ids[i]);\r\n\t\t}\r\n\t\tif (n != null) {\r\n\t\t\tns.add(n);\r\n\t\t\tcount++;\r\n\t\t}\r\n\t}\r\n\treturn ns;\r\n};\r\n\r\nFunctions.localName = function() {\r\n\tvar c = arguments[0];\r\n\tvar n;\r\n\tif (arguments.length == 1) {\r\n\t\tn = c.contextNode;\r\n\t} else if (arguments.length == 2) {\r\n\t\tn = arguments[1].evaluate(c).first();\r\n\t} else {\r\n\t\tthrow new Error(\"Function local-name expects (node-set?)\");\r\n\t}\r\n\tif (n == null) {\r\n\t\treturn new XString(\"\");\r\n\t}\r\n\treturn new XString(n.localName ? n.localName : n.baseName);\r\n};\r\n\r\nFunctions.namespaceURI = function() {\r\n\tvar c = arguments[0];\r\n\tvar n;\r\n\tif (arguments.length == 1) {\r\n\t\tn = c.contextNode;\r\n\t} else if (arguments.length == 2) {\r\n\t\tn = arguments[1].evaluate(c).first();\r\n\t} else {\r\n\t\tthrow new Error(\"Function namespace-uri expects (node-set?)\");\r\n\t}\r\n\tif (n == null) {\r\n\t\treturn new XString(\"\");\r\n\t}\r\n\treturn new XString(n.namespaceURI);\r\n};\r\n\r\nFunctions.name = function() {\r\n\tvar c = arguments[0];\r\n\tvar n;\r\n\tif (arguments.length == 1) {\r\n\t\tn = c.contextNode;\r\n\t} else if (arguments.length == 2) {\r\n\t\tn = arguments[1].evaluate(c).first();\r\n\t} else {\r\n\t\tthrow new Error(\"Function name expects (node-set?)\");\r\n\t}\r\n\tif (n == null) {\r\n\t\treturn new XString(\"\");\r\n\t}\r\n\tif (n.nodeType == 1 /*Node.ELEMENT_NODE*/ || n.nodeType == 2 /*Node.ATTRIBUTE_NODE*/) {\r\n\t\treturn new XString(n.nodeName);\r\n\t} else if (n.localName == null) {\r\n\t\treturn new XString(\"\");\r\n\t} else {\r\n\t\treturn new XString(n.localName);\r\n\t}\r\n};\r\n\r\nFunctions.string = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length == 1) {\r\n\t\treturn XNodeSet.prototype.stringForNode(c.contextNode);\r\n\t} else if (arguments.length == 2) {\r\n\t\treturn arguments[1].evaluate(c).string();\r\n\t}\r\n\tthrow new Error(\"Function string expects (object?)\");\r\n};\r\n\r\nFunctions.concat = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length < 3) {\r\n\t\tthrow new Error(\"Function concat expects (string, string, string*)\");\r\n\t}\r\n\tvar s = \"\";\r\n\tfor (var i = 1; i < arguments.length; i++) {\r\n\t\ts += arguments[i].evaluate(c).stringValue();\r\n\t}\r\n\treturn new XString(s);\r\n};\r\n\r\nFunctions.startsWith = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 3) {\r\n\t\tthrow new Error(\"Function startsWith expects (string, string)\");\r\n\t}\r\n\tvar s1 = arguments[1].evaluate(c).stringValue();\r\n\tvar s2 = arguments[2].evaluate(c).stringValue();\r\n\treturn new XBoolean(s1.substring(0, s2.length) == s2);\r\n};\r\n\r\nFunctions.contains = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 3) {\r\n\t\tthrow new Error(\"Function contains expects (string, string)\");\r\n\t}\r\n\tvar s1 = arguments[1].evaluate(c).stringValue();\r\n\tvar s2 = arguments[2].evaluate(c).stringValue();\r\n\treturn new XBoolean(s1.indexOf(s2) != -1);\r\n};\r\n\r\nFunctions.substringBefore = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 3) {\r\n\t\tthrow new Error(\"Function substring-before expects (string, string)\");\r\n\t}\r\n\tvar s1 = arguments[1].evaluate(c).stringValue();\r\n\tvar s2 = arguments[2].evaluate(c).stringValue();\r\n\treturn new XString(s1.substring(0, s1.indexOf(s2)));\r\n};\r\n\r\nFunctions.substringAfter = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 3) {\r\n\t\tthrow new Error(\"Function substring-after expects (string, string)\");\r\n\t}\r\n\tvar s1 = arguments[1].evaluate(c).stringValue();\r\n\tvar s2 = arguments[2].evaluate(c).stringValue();\r\n\tif (s2.length == 0) {\r\n\t\treturn new XString(s1);\r\n\t}\r\n\tvar i = s1.indexOf(s2);\r\n\tif (i == -1) {\r\n\t\treturn new XString(\"\");\r\n\t}\r\n\treturn new XString(s1.substring(s1.indexOf(s2) + 1));\r\n};\r\n\r\nFunctions.substring = function() {\r\n\tvar c = arguments[0];\r\n\tif (!(arguments.length == 3 || arguments.length == 4)) {\r\n\t\tthrow new Error(\"Function substring expects (string, number, number?)\");\r\n\t}\r\n\tvar s = arguments[1].evaluate(c).stringValue();\r\n\tvar n1 = Math.round(arguments[2].evaluate(c).numberValue()) - 1;\r\n\tvar n2 = arguments.length == 4 ? n1 + Math.round(arguments[3].evaluate(c).numberValue()) : undefined;\r\n\treturn new XString(s.substring(n1, n2));\r\n};\r\n\r\nFunctions.stringLength = function() {\r\n\tvar c = arguments[0];\r\n\tvar s;\r\n\tif (arguments.length == 1) {\r\n\t\ts = XNodeSet.prototype.stringForNode(c.contextNode);\r\n\t} else if (arguments.length == 2) {\r\n\t\ts = arguments[1].evaluate(c).stringValue();\r\n\t} else {\r\n\t\tthrow new Error(\"Function string-length expects (string?)\");\r\n\t}\r\n\treturn new XNumber(s.length);\r\n};\r\n\r\nFunctions.normalizeSpace = function() {\r\n\tvar c = arguments[0];\r\n\tvar s;\r\n\tif (arguments.length == 1) {\r\n\t\ts = XNodeSet.prototype.stringForNode(c.contextNode);\r\n\t} else if (arguments.length == 2) {\r\n\t\ts = arguments[1].evaluate(c).stringValue();\r\n\t} else {\r\n\t\tthrow new Error(\"Function normalize-space expects (string?)\");\r\n\t}\r\n\tvar i = 0;\r\n\tvar j = s.length - 1;\r\n\twhile (Utilities.isSpace(s.charCodeAt(j))) {\r\n\t\tj--;\r\n\t}\r\n\tvar t = \"\";\r\n\twhile (i <= j && Utilities.isSpace(s.charCodeAt(i))) {\r\n\t\ti++;\r\n\t}\r\n\twhile (i <= j) {\r\n\t\tif (Utilities.isSpace(s.charCodeAt(i))) {\r\n\t\t\tt += \" \";\r\n\t\t\twhile (i <= j && Utilities.isSpace(s.charCodeAt(i))) {\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tt += s.charAt(i);\r\n\t\t\ti++;\r\n\t\t}\r\n\t}\r\n\treturn new XString(t);\r\n};\r\n\r\nFunctions.translate = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 4) {\r\n\t\tthrow new Error(\"Function translate expects (string, string, string)\");\r\n\t}\r\n\tvar s1 = arguments[1].evaluate(c).stringValue();\r\n\tvar s2 = arguments[2].evaluate(c).stringValue();\r\n\tvar s3 = arguments[3].evaluate(c).stringValue();\r\n\tvar map = [];\r\n\tfor (var i = 0; i < s2.length; i++) {\r\n\t\tvar j = s2.charCodeAt(i);\r\n\t\tif (map[j] == undefined) {\r\n\t\t\tvar k = i > s3.length ? \"\" : s3.charAt(i);\r\n\t\t\tmap[j] = k;\r\n\t\t}\r\n\t}\r\n\tvar t = \"\";\r\n\tfor (var i = 0; i < s1.length; i++) {\r\n\t\tvar c = s1.charCodeAt(i);\r\n\t\tvar r = map[c];\r\n\t\tif (r == undefined) {\r\n\t\t\tt += s1.charAt(i);\r\n\t\t} else {\r\n\t\t\tt += r;\r\n\t\t}\r\n\t}\r\n\treturn new XString(t);\r\n};\r\n\r\nFunctions.boolean_ = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 2) {\r\n\t\tthrow new Error(\"Function boolean expects (object)\");\r\n\t}\r\n\treturn arguments[1].evaluate(c).bool();\r\n};\r\n\r\nFunctions.not = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 2) {\r\n\t\tthrow new Error(\"Function not expects (object)\");\r\n\t}\r\n\treturn arguments[1].evaluate(c).bool().not();\r\n};\r\n\r\nFunctions.true_ = function() {\r\n\tif (arguments.length != 1) {\r\n\t\tthrow new Error(\"Function true expects ()\");\r\n\t}\r\n\treturn new XBoolean(true);\r\n};\r\n\r\nFunctions.false_ = function() {\r\n\tif (arguments.length != 1) {\r\n\t\tthrow new Error(\"Function false expects ()\");\r\n\t}\r\n\treturn new XBoolean(false);\r\n};\r\n\r\nFunctions.lang = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 2) {\r\n\t\tthrow new Error(\"Function lang expects (string)\");\r\n\t}\r\n\tvar lang;\r\n\tfor (var n = c.contextNode; n != null && n.nodeType != 9 /*Node.DOCUMENT_NODE*/; n = n.parentNode) {\r\n\t\tvar a = n.getAttributeNS(XPath.XML_NAMESPACE_URI, \"lang\");\r\n\t\tif (a != null) {\r\n\t\t\tlang = String(a);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\tif (lang == null) {\r\n\t\treturn new XBoolean(false);\r\n\t}\r\n\tvar s = arguments[1].evaluate(c).stringValue();\r\n\treturn new XBoolean(lang.substring(0, s.length) == s\r\n\t\t\t\t&& (lang.length == s.length || lang.charAt(s.length) == '-'));\r\n};\r\n\r\nFunctions.number = function() {\r\n\tvar c = arguments[0];\r\n\tif (!(arguments.length == 1 || arguments.length == 2)) {\r\n\t\tthrow new Error(\"Function number expects (object?)\");\r\n\t}\r\n\tif (arguments.length == 1) {\r\n\t\treturn new XNumber(XNodeSet.prototype.stringForNode(c.contextNode));\r\n\t}\r\n\treturn arguments[1].evaluate(c).number();\r\n};\r\n\r\nFunctions.sum = function() {\r\n\tvar c = arguments[0];\r\n\tvar ns;\r\n\tif (arguments.length != 2 || !Utilities.instance_of((ns = arguments[1].evaluate(c)), XNodeSet)) {\r\n\t\tthrow new Error(\"Function sum expects (node-set)\");\r\n\t}\r\n\tns = ns.toArray();\r\n\tvar n = 0;\r\n\tfor (var i = 0; i < ns.length; i++) {\r\n\t\tn += new XNumber(XNodeSet.prototype.stringForNode(ns[i])).numberValue();\r\n\t}\r\n\treturn new XNumber(n);\r\n};\r\n\r\nFunctions.floor = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 2) {\r\n\t\tthrow new Error(\"Function floor expects (number)\");\r\n\t}\r\n\treturn new XNumber(Math.floor(arguments[1].evaluate(c).numberValue()));\r\n};\r\n\r\nFunctions.ceiling = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 2) {\r\n\t\tthrow new Error(\"Function ceiling expects (number)\");\r\n\t}\r\n\treturn new XNumber(Math.ceil(arguments[1].evaluate(c).numberValue()));\r\n};\r\n\r\nFunctions.round = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 2) {\r\n\t\tthrow new Error(\"Function round expects (number)\");\r\n\t}\r\n\treturn new XNumber(Math.round(arguments[1].evaluate(c).numberValue()));\r\n};\r\n\r\n// Utilities /////////////////////////////////////////////////////////////////\r\n\r\nvar Utilities = new Object();\r\n\r\nUtilities.splitQName = function(qn) {\r\n\tvar i = qn.indexOf(\":\");\r\n\tif (i == -1) {\r\n\t\treturn [ null, qn ];\r\n\t}\r\n\treturn [ qn.substring(0, i), qn.substring(i + 1) ];\r\n};\r\n\r\nUtilities.resolveQName = function(qn, nr, n, useDefault) {\r\n\tvar parts = Utilities.splitQName(qn);\r\n\tif (parts[0] != null) {\r\n\t\tparts[0] = nr.getNamespace(parts[0], n);\r\n\t} else {\r\n\t\tif (useDefault) {\r\n\t\t\tparts[0] = nr.getNamespace(\"\", n);\r\n\t\t\tif (parts[0] == null) {\r\n\t\t\t\tparts[0] = \"\";\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tparts[0] = \"\";\r\n\t\t}\r\n\t}\r\n\treturn parts;\r\n};\r\n\r\nUtilities.isSpace = function(c) {\r\n\treturn c == 0x9 || c == 0xd || c == 0xa || c == 0x20;\r\n};\r\n\r\nUtilities.isLetter = function(c) {\r\n\treturn c >= 0x0041 && c <= 0x005A ||\r\n\t\tc >= 0x0061 && c <= 0x007A ||\r\n\t\tc >= 0x00C0 && c <= 0x00D6 ||\r\n\t\tc >= 0x00D8 && c <= 0x00F6 ||\r\n\t\tc >= 0x00F8 && c <= 0x00FF ||\r\n\t\tc >= 0x0100 && c <= 0x0131 ||\r\n\t\tc >= 0x0134 && c <= 0x013E ||\r\n\t\tc >= 0x0141 && c <= 0x0148 ||\r\n\t\tc >= 0x014A && c <= 0x017E ||\r\n\t\tc >= 0x0180 && c <= 0x01C3 ||\r\n\t\tc >= 0x01CD && c <= 0x01F0 ||\r\n\t\tc >= 0x01F4 && c <= 0x01F5 ||\r\n\t\tc >= 0x01FA && c <= 0x0217 ||\r\n\t\tc >= 0x0250 && c <= 0x02A8 ||\r\n\t\tc >= 0x02BB && c <= 0x02C1 ||\r\n\t\tc == 0x0386 ||\r\n\t\tc >= 0x0388 && c <= 0x038A ||\r\n\t\tc == 0x038C ||\r\n\t\tc >= 0x038E && c <= 0x03A1 ||\r\n\t\tc >= 0x03A3 && c <= 0x03CE ||\r\n\t\tc >= 0x03D0 && c <= 0x03D6 ||\r\n\t\tc == 0x03DA ||\r\n\t\tc == 0x03DC ||\r\n\t\tc == 0x03DE ||\r\n\t\tc == 0x03E0 ||\r\n\t\tc >= 0x03E2 && c <= 0x03F3 ||\r\n\t\tc >= 0x0401 && c <= 0x040C ||\r\n\t\tc >= 0x040E && c <= 0x044F ||\r\n\t\tc >= 0x0451 && c <= 0x045C ||\r\n\t\tc >= 0x045E && c <= 0x0481 ||\r\n\t\tc >= 0x0490 && c <= 0x04C4 ||\r\n\t\tc >= 0x04C7 && c <= 0x04C8 ||\r\n\t\tc >= 0x04CB && c <= 0x04CC ||\r\n\t\tc >= 0x04D0 && c <= 0x04EB ||\r\n\t\tc >= 0x04EE && c <= 0x04F5 ||\r\n\t\tc >= 0x04F8 && c <= 0x04F9 ||\r\n\t\tc >= 0x0531 && c <= 0x0556 ||\r\n\t\tc == 0x0559 ||\r\n\t\tc >= 0x0561 && c <= 0x0586 ||\r\n\t\tc >= 0x05D0 && c <= 0x05EA ||\r\n\t\tc >= 0x05F0 && c <= 0x05F2 ||\r\n\t\tc >= 0x0621 && c <= 0x063A ||\r\n\t\tc >= 0x0641 && c <= 0x064A ||\r\n\t\tc >= 0x0671 && c <= 0x06B7 ||\r\n\t\tc >= 0x06BA && c <= 0x06BE ||\r\n\t\tc >= 0x06C0 && c <= 0x06CE ||\r\n\t\tc >= 0x06D0 && c <= 0x06D3 ||\r\n\t\tc == 0x06D5 ||\r\n\t\tc >= 0x06E5 && c <= 0x06E6 ||\r\n\t\tc >= 0x0905 && c <= 0x0939 ||\r\n\t\tc == 0x093D ||\r\n\t\tc >= 0x0958 && c <= 0x0961 ||\r\n\t\tc >= 0x0985 && c <= 0x098C ||\r\n\t\tc >= 0x098F && c <= 0x0990 ||\r\n\t\tc >= 0x0993 && c <= 0x09A8 ||\r\n\t\tc >= 0x09AA && c <= 0x09B0 ||\r\n\t\tc == 0x09B2 ||\r\n\t\tc >= 0x09B6 && c <= 0x09B9 ||\r\n\t\tc >= 0x09DC && c <= 0x09DD ||\r\n\t\tc >= 0x09DF && c <= 0x09E1 ||\r\n\t\tc >= 0x09F0 && c <= 0x09F1 ||\r\n\t\tc >= 0x0A05 && c <= 0x0A0A ||\r\n\t\tc >= 0x0A0F && c <= 0x0A10 ||\r\n\t\tc >= 0x0A13 && c <= 0x0A28 ||\r\n\t\tc >= 0x0A2A && c <= 0x0A30 ||\r\n\t\tc >= 0x0A32 && c <= 0x0A33 ||\r\n\t\tc >= 0x0A35 && c <= 0x0A36 ||\r\n\t\tc >= 0x0A38 && c <= 0x0A39 ||\r\n\t\tc >= 0x0A59 && c <= 0x0A5C ||\r\n\t\tc == 0x0A5E ||\r\n\t\tc >= 0x0A72 && c <= 0x0A74 ||\r\n\t\tc >= 0x0A85 && c <= 0x0A8B ||\r\n\t\tc == 0x0A8D ||\r\n\t\tc >= 0x0A8F && c <= 0x0A91 ||\r\n\t\tc >= 0x0A93 && c <= 0x0AA8 ||\r\n\t\tc >= 0x0AAA && c <= 0x0AB0 ||\r\n\t\tc >= 0x0AB2 && c <= 0x0AB3 ||\r\n\t\tc >= 0x0AB5 && c <= 0x0AB9 ||\r\n\t\tc == 0x0ABD ||\r\n\t\tc == 0x0AE0 ||\r\n\t\tc >= 0x0B05 && c <= 0x0B0C ||\r\n\t\tc >= 0x0B0F && c <= 0x0B10 ||\r\n\t\tc >= 0x0B13 && c <= 0x0B28 ||\r\n\t\tc >= 0x0B2A && c <= 0x0B30 ||\r\n\t\tc >= 0x0B32 && c <= 0x0B33 ||\r\n\t\tc >= 0x0B36 && c <= 0x0B39 ||\r\n\t\tc == 0x0B3D ||\r\n\t\tc >= 0x0B5C && c <= 0x0B5D ||\r\n\t\tc >= 0x0B5F && c <= 0x0B61 ||\r\n\t\tc >= 0x0B85 && c <= 0x0B8A ||\r\n\t\tc >= 0x0B8E && c <= 0x0B90 ||\r\n\t\tc >= 0x0B92 && c <= 0x0B95 ||\r\n\t\tc >= 0x0B99 && c <= 0x0B9A ||\r\n\t\tc == 0x0B9C ||\r\n\t\tc >= 0x0B9E && c <= 0x0B9F ||\r\n\t\tc >= 0x0BA3 && c <= 0x0BA4 ||\r\n\t\tc >= 0x0BA8 && c <= 0x0BAA ||\r\n\t\tc >= 0x0BAE && c <= 0x0BB5 ||\r\n\t\tc >= 0x0BB7 && c <= 0x0BB9 ||\r\n\t\tc >= 0x0C05 && c <= 0x0C0C ||\r\n\t\tc >= 0x0C0E && c <= 0x0C10 ||\r\n\t\tc >= 0x0C12 && c <= 0x0C28 ||\r\n\t\tc >= 0x0C2A && c <= 0x0C33 ||\r\n\t\tc >= 0x0C35 && c <= 0x0C39 ||\r\n\t\tc >= 0x0C60 && c <= 0x0C61 ||\r\n\t\tc >= 0x0C85 && c <= 0x0C8C ||\r\n\t\tc >= 0x0C8E && c <= 0x0C90 ||\r\n\t\tc >= 0x0C92 && c <= 0x0CA8 ||\r\n\t\tc >= 0x0CAA && c <= 0x0CB3 ||\r\n\t\tc >= 0x0CB5 && c <= 0x0CB9 ||\r\n\t\tc == 0x0CDE ||\r\n\t\tc >= 0x0CE0 && c <= 0x0CE1 ||\r\n\t\tc >= 0x0D05 && c <= 0x0D0C ||\r\n\t\tc >= 0x0D0E && c <= 0x0D10 ||\r\n\t\tc >= 0x0D12 && c <= 0x0D28 ||\r\n\t\tc >= 0x0D2A && c <= 0x0D39 ||\r\n\t\tc >= 0x0D60 && c <= 0x0D61 ||\r\n\t\tc >= 0x0E01 && c <= 0x0E2E ||\r\n\t\tc == 0x0E30 ||\r\n\t\tc >= 0x0E32 && c <= 0x0E33 ||\r\n\t\tc >= 0x0E40 && c <= 0x0E45 ||\r\n\t\tc >= 0x0E81 && c <= 0x0E82 ||\r\n\t\tc == 0x0E84 ||\r\n\t\tc >= 0x0E87 && c <= 0x0E88 ||\r\n\t\tc == 0x0E8A ||\r\n\t\tc == 0x0E8D ||\r\n\t\tc >= 0x0E94 && c <= 0x0E97 ||\r\n\t\tc >= 0x0E99 && c <= 0x0E9F ||\r\n\t\tc >= 0x0EA1 && c <= 0x0EA3 ||\r\n\t\tc == 0x0EA5 ||\r\n\t\tc == 0x0EA7 ||\r\n\t\tc >= 0x0EAA && c <= 0x0EAB ||\r\n\t\tc >= 0x0EAD && c <= 0x0EAE ||\r\n\t\tc == 0x0EB0 ||\r\n\t\tc >= 0x0EB2 && c <= 0x0EB3 ||\r\n\t\tc == 0x0EBD ||\r\n\t\tc >= 0x0EC0 && c <= 0x0EC4 ||\r\n\t\tc >= 0x0F40 && c <= 0x0F47 ||\r\n\t\tc >= 0x0F49 && c <= 0x0F69 ||\r\n\t\tc >= 0x10A0 && c <= 0x10C5 ||\r\n\t\tc >= 0x10D0 && c <= 0x10F6 ||\r\n\t\tc == 0x1100 ||\r\n\t\tc >= 0x1102 && c <= 0x1103 ||\r\n\t\tc >= 0x1105 && c <= 0x1107 ||\r\n\t\tc == 0x1109 ||\r\n\t\tc >= 0x110B && c <= 0x110C ||\r\n\t\tc >= 0x110E && c <= 0x1112 ||\r\n\t\tc == 0x113C ||\r\n\t\tc == 0x113E ||\r\n\t\tc == 0x1140 ||\r\n\t\tc == 0x114C ||\r\n\t\tc == 0x114E ||\r\n\t\tc == 0x1150 ||\r\n\t\tc >= 0x1154 && c <= 0x1155 ||\r\n\t\tc == 0x1159 ||\r\n\t\tc >= 0x115F && c <= 0x1161 ||\r\n\t\tc == 0x1163 ||\r\n\t\tc == 0x1165 ||\r\n\t\tc == 0x1167 ||\r\n\t\tc == 0x1169 ||\r\n\t\tc >= 0x116D && c <= 0x116E ||\r\n\t\tc >= 0x1172 && c <= 0x1173 ||\r\n\t\tc == 0x1175 ||\r\n\t\tc == 0x119E ||\r\n\t\tc == 0x11A8 ||\r\n\t\tc == 0x11AB ||\r\n\t\tc >= 0x11AE && c <= 0x11AF ||\r\n\t\tc >= 0x11B7 && c <= 0x11B8 ||\r\n\t\tc == 0x11BA ||\r\n\t\tc >= 0x11BC && c <= 0x11C2 ||\r\n\t\tc == 0x11EB ||\r\n\t\tc == 0x11F0 ||\r\n\t\tc == 0x11F9 ||\r\n\t\tc >= 0x1E00 && c <= 0x1E9B ||\r\n\t\tc >= 0x1EA0 && c <= 0x1EF9 ||\r\n\t\tc >= 0x1F00 && c <= 0x1F15 ||\r\n\t\tc >= 0x1F18 && c <= 0x1F1D ||\r\n\t\tc >= 0x1F20 && c <= 0x1F45 ||\r\n\t\tc >= 0x1F48 && c <= 0x1F4D ||\r\n\t\tc >= 0x1F50 && c <= 0x1F57 ||\r\n\t\tc == 0x1F59 ||\r\n\t\tc == 0x1F5B ||\r\n\t\tc == 0x1F5D ||\r\n\t\tc >= 0x1F5F && c <= 0x1F7D ||\r\n\t\tc >= 0x1F80 && c <= 0x1FB4 ||\r\n\t\tc >= 0x1FB6 && c <= 0x1FBC ||\r\n\t\tc == 0x1FBE ||\r\n\t\tc >= 0x1FC2 && c <= 0x1FC4 ||\r\n\t\tc >= 0x1FC6 && c <= 0x1FCC ||\r\n\t\tc >= 0x1FD0 && c <= 0x1FD3 ||\r\n\t\tc >= 0x1FD6 && c <= 0x1FDB ||\r\n\t\tc >= 0x1FE0 && c <= 0x1FEC ||\r\n\t\tc >= 0x1FF2 && c <= 0x1FF4 ||\r\n\t\tc >= 0x1FF6 && c <= 0x1FFC ||\r\n\t\tc == 0x2126 ||\r\n\t\tc >= 0x212A && c <= 0x212B ||\r\n\t\tc == 0x212E ||\r\n\t\tc >= 0x2180 && c <= 0x2182 ||\r\n\t\tc >= 0x3041 && c <= 0x3094 ||\r\n\t\tc >= 0x30A1 && c <= 0x30FA ||\r\n\t\tc >= 0x3105 && c <= 0x312C ||\r\n\t\tc >= 0xAC00 && c <= 0xD7A3 ||\r\n\t\tc >= 0x4E00 && c <= 0x9FA5 ||\r\n\t\tc == 0x3007 ||\r\n\t\tc >= 0x3021 && c <= 0x3029;\r\n};\r\n\r\nUtilities.isNCNameChar = function(c) {\r\n\treturn c >= 0x0030 && c <= 0x0039 \r\n\t\t|| c >= 0x0660 && c <= 0x0669 \r\n\t\t|| c >= 0x06F0 && c <= 0x06F9 \r\n\t\t|| c >= 0x0966 && c <= 0x096F \r\n\t\t|| c >= 0x09E6 && c <= 0x09EF \r\n\t\t|| c >= 0x0A66 && c <= 0x0A6F \r\n\t\t|| c >= 0x0AE6 && c <= 0x0AEF \r\n\t\t|| c >= 0x0B66 && c <= 0x0B6F \r\n\t\t|| c >= 0x0BE7 && c <= 0x0BEF \r\n\t\t|| c >= 0x0C66 && c <= 0x0C6F \r\n\t\t|| c >= 0x0CE6 && c <= 0x0CEF \r\n\t\t|| c >= 0x0D66 && c <= 0x0D6F \r\n\t\t|| c >= 0x0E50 && c <= 0x0E59 \r\n\t\t|| c >= 0x0ED0 && c <= 0x0ED9 \r\n\t\t|| c >= 0x0F20 && c <= 0x0F29\r\n\t\t|| c == 0x002E\r\n\t\t|| c == 0x002D\r\n\t\t|| c == 0x005F\r\n\t\t|| Utilities.isLetter(c)\r\n\t\t|| c >= 0x0300 && c <= 0x0345 \r\n\t\t|| c >= 0x0360 && c <= 0x0361 \r\n\t\t|| c >= 0x0483 && c <= 0x0486 \r\n\t\t|| c >= 0x0591 && c <= 0x05A1 \r\n\t\t|| c >= 0x05A3 && c <= 0x05B9 \r\n\t\t|| c >= 0x05BB && c <= 0x05BD \r\n\t\t|| c == 0x05BF \r\n\t\t|| c >= 0x05C1 && c <= 0x05C2 \r\n\t\t|| c == 0x05C4 \r\n\t\t|| c >= 0x064B && c <= 0x0652 \r\n\t\t|| c == 0x0670 \r\n\t\t|| c >= 0x06D6 && c <= 0x06DC \r\n\t\t|| c >= 0x06DD && c <= 0x06DF \r\n\t\t|| c >= 0x06E0 && c <= 0x06E4 \r\n\t\t|| c >= 0x06E7 && c <= 0x06E8 \r\n\t\t|| c >= 0x06EA && c <= 0x06ED \r\n\t\t|| c >= 0x0901 && c <= 0x0903 \r\n\t\t|| c == 0x093C \r\n\t\t|| c >= 0x093E && c <= 0x094C \r\n\t\t|| c == 0x094D \r\n\t\t|| c >= 0x0951 && c <= 0x0954 \r\n\t\t|| c >= 0x0962 && c <= 0x0963 \r\n\t\t|| c >= 0x0981 && c <= 0x0983 \r\n\t\t|| c == 0x09BC \r\n\t\t|| c == 0x09BE \r\n\t\t|| c == 0x09BF \r\n\t\t|| c >= 0x09C0 && c <= 0x09C4 \r\n\t\t|| c >= 0x09C7 && c <= 0x09C8 \r\n\t\t|| c >= 0x09CB && c <= 0x09CD \r\n\t\t|| c == 0x09D7 \r\n\t\t|| c >= 0x09E2 && c <= 0x09E3 \r\n\t\t|| c == 0x0A02 \r\n\t\t|| c == 0x0A3C \r\n\t\t|| c == 0x0A3E \r\n\t\t|| c == 0x0A3F \r\n\t\t|| c >= 0x0A40 && c <= 0x0A42 \r\n\t\t|| c >= 0x0A47 && c <= 0x0A48 \r\n\t\t|| c >= 0x0A4B && c <= 0x0A4D \r\n\t\t|| c >= 0x0A70 && c <= 0x0A71 \r\n\t\t|| c >= 0x0A81 && c <= 0x0A83 \r\n\t\t|| c == 0x0ABC \r\n\t\t|| c >= 0x0ABE && c <= 0x0AC5 \r\n\t\t|| c >= 0x0AC7 && c <= 0x0AC9 \r\n\t\t|| c >= 0x0ACB && c <= 0x0ACD \r\n\t\t|| c >= 0x0B01 && c <= 0x0B03 \r\n\t\t|| c == 0x0B3C \r\n\t\t|| c >= 0x0B3E && c <= 0x0B43 \r\n\t\t|| c >= 0x0B47 && c <= 0x0B48 \r\n\t\t|| c >= 0x0B4B && c <= 0x0B4D \r\n\t\t|| c >= 0x0B56 && c <= 0x0B57 \r\n\t\t|| c >= 0x0B82 && c <= 0x0B83 \r\n\t\t|| c >= 0x0BBE && c <= 0x0BC2 \r\n\t\t|| c >= 0x0BC6 && c <= 0x0BC8 \r\n\t\t|| c >= 0x0BCA && c <= 0x0BCD \r\n\t\t|| c == 0x0BD7 \r\n\t\t|| c >= 0x0C01 && c <= 0x0C03 \r\n\t\t|| c >= 0x0C3E && c <= 0x0C44 \r\n\t\t|| c >= 0x0C46 && c <= 0x0C48 \r\n\t\t|| c >= 0x0C4A && c <= 0x0C4D \r\n\t\t|| c >= 0x0C55 && c <= 0x0C56 \r\n\t\t|| c >= 0x0C82 && c <= 0x0C83 \r\n\t\t|| c >= 0x0CBE && c <= 0x0CC4 \r\n\t\t|| c >= 0x0CC6 && c <= 0x0CC8 \r\n\t\t|| c >= 0x0CCA && c <= 0x0CCD \r\n\t\t|| c >= 0x0CD5 && c <= 0x0CD6 \r\n\t\t|| c >= 0x0D02 && c <= 0x0D03 \r\n\t\t|| c >= 0x0D3E && c <= 0x0D43 \r\n\t\t|| c >= 0x0D46 && c <= 0x0D48 \r\n\t\t|| c >= 0x0D4A && c <= 0x0D4D \r\n\t\t|| c == 0x0D57 \r\n\t\t|| c == 0x0E31 \r\n\t\t|| c >= 0x0E34 && c <= 0x0E3A \r\n\t\t|| c >= 0x0E47 && c <= 0x0E4E \r\n\t\t|| c == 0x0EB1 \r\n\t\t|| c >= 0x0EB4 && c <= 0x0EB9 \r\n\t\t|| c >= 0x0EBB && c <= 0x0EBC \r\n\t\t|| c >= 0x0EC8 && c <= 0x0ECD \r\n\t\t|| c >= 0x0F18 && c <= 0x0F19 \r\n\t\t|| c == 0x0F35 \r\n\t\t|| c == 0x0F37 \r\n\t\t|| c == 0x0F39 \r\n\t\t|| c == 0x0F3E \r\n\t\t|| c == 0x0F3F \r\n\t\t|| c >= 0x0F71 && c <= 0x0F84 \r\n\t\t|| c >= 0x0F86 && c <= 0x0F8B \r\n\t\t|| c >= 0x0F90 && c <= 0x0F95 \r\n\t\t|| c == 0x0F97 \r\n\t\t|| c >= 0x0F99 && c <= 0x0FAD \r\n\t\t|| c >= 0x0FB1 && c <= 0x0FB7 \r\n\t\t|| c == 0x0FB9 \r\n\t\t|| c >= 0x20D0 && c <= 0x20DC \r\n\t\t|| c == 0x20E1 \r\n\t\t|| c >= 0x302A && c <= 0x302F \r\n\t\t|| c == 0x3099 \r\n\t\t|| c == 0x309A\r\n\t\t|| c == 0x00B7 \r\n\t\t|| c == 0x02D0 \r\n\t\t|| c == 0x02D1 \r\n\t\t|| c == 0x0387 \r\n\t\t|| c == 0x0640 \r\n\t\t|| c == 0x0E46 \r\n\t\t|| c == 0x0EC6 \r\n\t\t|| c == 0x3005 \r\n\t\t|| c >= 0x3031 && c <= 0x3035 \r\n\t\t|| c >= 0x309D && c <= 0x309E \r\n\t\t|| c >= 0x30FC && c <= 0x30FE;\r\n};\r\n\r\nUtilities.coalesceText = function(n) {\r\n\tfor (var m = n.firstChild; m != null; m = m.nextSibling) {\r\n\t\tif (m.nodeType == 3 /*Node.TEXT_NODE*/ || m.nodeType == 4 /*Node.CDATA_SECTION_NODE*/) {\r\n\t\t\tvar s = m.nodeValue;\r\n\t\t\tvar first = m;\r\n\t\t\tm = m.nextSibling;\r\n\t\t\twhile (m != null && (m.nodeType == 3 /*Node.TEXT_NODE*/ || m.nodeType == 4 /*Node.CDATA_SECTION_NODE*/)) {\r\n\t\t\t\ts += m.nodeValue;\r\n\t\t\t\tvar del = m;\r\n\t\t\t\tm = m.nextSibling;\r\n\t\t\t\tdel.parentNode.removeChild(del);\r\n\t\t\t}\r\n\t\t\tif (first.nodeType == 4 /*Node.CDATA_SECTION_NODE*/) {\r\n\t\t\t\tvar p = first.parentNode;\r\n\t\t\t\tif (first.nextSibling == null) {\r\n\t\t\t\t\tp.removeChild(first);\r\n\t\t\t\t\tp.appendChild(p.ownerDocument.createTextNode(s));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar next = first.nextSibling;\r\n\t\t\t\t\tp.removeChild(first);\r\n\t\t\t\t\tp.insertBefore(p.ownerDocument.createTextNode(s), next);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfirst.nodeValue = s;\r\n\t\t\t}\r\n\t\t\tif (m == null) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t} else if (m.nodeType == 1 /*Node.ELEMENT_NODE*/) {\r\n\t\t\tUtilities.coalesceText(m);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nUtilities.instance_of = function(o, c) {\r\n\twhile (o != null) {\r\n\t\tif (o.constructor === c) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (o === Object) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\to = o.constructor.superclass;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nUtilities.getElementById = function(n, id) {\r\n\t// Note that this does not check the DTD to check for actual\r\n\t// attributes of type ID, so this may be a bit wrong.\r\n\tif (n.nodeType == 1 /*Node.ELEMENT_NODE*/) {\r\n\t\tif (n.getAttribute(\"id\") == id\r\n\t\t\t\t|| n.getAttributeNS(null, \"id\") == id) {\r\n\t\t\treturn n;\r\n\t\t}\r\n\t}\r\n\tfor (var m = n.firstChild; m != null; m = m.nextSibling) {\r\n\t\tvar res = Utilities.getElementById(m, id);\r\n\t\tif (res != null) {\r\n\t\t\treturn res;\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\n// XPathException ////////////////////////////////////////////////////////////\r\n\r\nXPathException.prototype = {};\r\nXPathException.prototype.constructor = XPathException;\r\nXPathException.superclass = Object.prototype;\r\n\r\nfunction XPathException(c, e) {\r\n\tthis.code = c;\r\n\tthis.exception = e;\r\n}\r\n\r\nXPathException.prototype.toString = function() {\r\n\tvar msg = this.exception ? \": \" + this.exception.toString() : \"\";\r\n\tswitch (this.code) {\r\n\t\tcase XPathException.INVALID_EXPRESSION_ERR:\r\n\t\t\treturn \"Invalid expression\" + msg;\r\n\t\tcase XPathException.TYPE_ERR:\r\n\t\t\treturn \"Type error\" + msg;\r\n\t}\r\n};\r\n\r\nXPathException.INVALID_EXPRESSION_ERR = 51;\r\nXPathException.TYPE_ERR = 52;\r\n\r\n// XPathExpression ///////////////////////////////////////////////////////////\r\n\r\nXPathExpression.prototype = {};\r\nXPathExpression.prototype.constructor = XPathExpression;\r\nXPathExpression.superclass = Object.prototype;\r\n\r\nfunction XPathExpression(e, r, p) {\r\n\tthis.xpath = p.parse(e);\r\n\tthis.context = new XPathContext();\r\n\tthis.context.namespaceResolver = new XPathNSResolverWrapper(r);\r\n}\r\n\r\nXPathExpression.prototype.evaluate = function(n, t, res) {\r\n\tthis.context.expressionContextNode = n;\r\n\tvar result = this.xpath.evaluate(this.context);\r\n\treturn new XPathResult(result, t);\r\n}\r\n\r\n// XPathNSResolverWrapper ////////////////////////////////////////////////////\r\n\r\nXPathNSResolverWrapper.prototype = {};\r\nXPathNSResolverWrapper.prototype.constructor = XPathNSResolverWrapper;\r\nXPathNSResolverWrapper.superclass = Object.prototype;\r\n\r\nfunction XPathNSResolverWrapper(r) {\r\n\tthis.xpathNSResolver = r;\r\n}\r\n\r\nXPathNSResolverWrapper.prototype.getNamespace = function(prefix, n) {\r\n    if (this.xpathNSResolver == null) {\r\n        return null;\r\n    }\r\n\treturn this.xpathNSResolver.lookupNamespaceURI(prefix);\r\n};\r\n\r\n// NodeXPathNSResolver ///////////////////////////////////////////////////////\r\n\r\nNodeXPathNSResolver.prototype = {};\r\nNodeXPathNSResolver.prototype.constructor = NodeXPathNSResolver;\r\nNodeXPathNSResolver.superclass = Object.prototype;\r\n\r\nfunction NodeXPathNSResolver(n) {\r\n\tthis.node = n;\r\n\tthis.namespaceResolver = new NamespaceResolver();\r\n}\r\n\r\nNodeXPathNSResolver.prototype.lookupNamespaceURI = function(prefix) {\r\n\treturn this.namespaceResolver.getNamespace(prefix, this.node);\r\n};\r\n\r\n// XPathResult ///////////////////////////////////////////////////////////////\r\n\r\nXPathResult.prototype = {};\r\nXPathResult.prototype.constructor = XPathResult;\r\nXPathResult.superclass = Object.prototype;\r\n\r\nfunction XPathResult(v, t) {\r\n\tif (t == XPathResult.ANY_TYPE) {\r\n\t\tif (v.constructor === XString) {\r\n\t\t\tt = XPathResult.STRING_TYPE;\r\n\t\t} else if (v.constructor === XNumber) {\r\n\t\t\tt = XPathResult.NUMBER_TYPE;\r\n\t\t} else if (v.constructor === XBoolean) {\r\n\t\t\tt = XPathResult.BOOLEAN_TYPE;\r\n\t\t} else if (v.constructor === XNodeSet) {\r\n\t\t\tt = XPathResult.UNORDERED_NODE_ITERATOR_TYPE;\r\n\t\t}\r\n\t}\r\n\tthis.resultType = t;\r\n\tswitch (t) {\r\n\t\tcase XPathResult.NUMBER_TYPE:\r\n\t\t\tthis.numberValue = v.numberValue();\r\n\t\t\treturn;\r\n\t\tcase XPathResult.STRING_TYPE:\r\n\t\t\tthis.stringValue = v.stringValue();\r\n\t\t\treturn;\r\n\t\tcase XPathResult.BOOLEAN_TYPE:\r\n\t\t\tthis.booleanValue = v.booleanValue();\r\n\t\t\treturn;\r\n\t\tcase XPathResult.ANY_UNORDERED_NODE_TYPE:\r\n\t\tcase XPathResult.FIRST_ORDERED_NODE_TYPE:\r\n\t\t\tif (v.constructor === XNodeSet) {\r\n\t\t\t\tthis.singleNodeValue = v.first();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase XPathResult.UNORDERED_NODE_ITERATOR_TYPE:\r\n\t\tcase XPathResult.ORDERED_NODE_ITERATOR_TYPE:\r\n\t\t\tif (v.constructor === XNodeSet) {\r\n\t\t\t\tthis.invalidIteratorState = false;\r\n\t\t\t\tthis.nodes = v.toArray();\r\n\t\t\t\tthis.iteratorIndex = 0;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE:\r\n\t\tcase XPathResult.ORDERED_NODE_SNAPSHOT_TYPE:\r\n\t\t\tif (v.constructor === XNodeSet) {\r\n\t\t\t\tthis.nodes = v.toArray();\r\n\t\t\t\tthis.snapshotLength = this.nodes.length;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t}\r\n\tthrow new XPathException(XPathException.TYPE_ERR);\r\n};\r\n\r\nXPathResult.prototype.iterateNext = function() {\r\n\tif (this.resultType != XPathResult.UNORDERED_NODE_ITERATOR_TYPE\r\n\t\t\t&& this.resultType != XPathResult.ORDERED_NODE_ITERATOR_TYPE) {\r\n\t\tthrow new XPathException(XPathException.TYPE_ERR);\r\n\t}\r\n\treturn this.nodes[this.iteratorIndex++];\r\n};\r\n\r\nXPathResult.prototype.snapshotItem = function(i) {\r\n\tif (this.resultType != XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE\r\n\t\t\t&& this.resultType != XPathResult.ORDERED_NODE_SNAPSHOT_TYPE) {\r\n\t\tthrow new XPathException(XPathException.TYPE_ERR);\r\n\t}\r\n\treturn this.nodes[i];\r\n};\r\n\r\nXPathResult.ANY_TYPE = 0;\r\nXPathResult.NUMBER_TYPE = 1;\r\nXPathResult.STRING_TYPE = 2;\r\nXPathResult.BOOLEAN_TYPE = 3;\r\nXPathResult.UNORDERED_NODE_ITERATOR_TYPE = 4;\r\nXPathResult.ORDERED_NODE_ITERATOR_TYPE = 5;\r\nXPathResult.UNORDERED_NODE_SNAPSHOT_TYPE = 6;\r\nXPathResult.ORDERED_NODE_SNAPSHOT_TYPE = 7;\r\nXPathResult.ANY_UNORDERED_NODE_TYPE = 8;\r\nXPathResult.FIRST_ORDERED_NODE_TYPE = 9;\r\n\r\n// DOM 3 XPath support ///////////////////////////////////////////////////////\r\n\r\nfunction installDOM3XPathSupport(doc, p) {\r\n\tdoc.createExpression = function(e, r) {\r\n\t\ttry {\r\n\t\t\treturn new XPathExpression(e, r, p);\r\n\t\t} catch (e) {\r\n\t\t\tthrow new XPathException(XPathException.INVALID_EXPRESSION_ERR, e);\r\n\t\t}\r\n\t};\r\n\tdoc.createNSResolver = function(n) {\r\n\t\treturn new NodeXPathNSResolver(n);\r\n\t};\r\n\tdoc.evaluate = function(e, cn, r, t, res) {\r\n\t\tif (t < 0 || t > 9) {\r\n\t\t\tthrow { code: 0, toString: function() { return \"Request type not supported\"; } };\r\n\t\t}\r\n        return doc.createExpression(e, r, p).evaluate(cn, t, res);\r\n\t};\r\n};\r\n\r\n// ---------------------------------------------------------------------------\r\n\r\n// Install DOM 3 XPath support for the current document.\r\ntry {\r\n\tvar shouldInstall = true;\r\n\ttry {\r\n\t\tif (document.implementation\r\n\t\t\t\t&& document.implementation.hasFeature\r\n\t\t\t\t&& document.implementation.hasFeature(\"XPath\", null)) {\r\n\t\t\tshouldInstall = false;\r\n\t\t}\r\n\t} catch (e) {\r\n\t}\r\n\tif (shouldInstall) {\r\n\t\tinstallDOM3XPathSupport(document, new XPathParser());\r\n\t}\r\n} catch (e) {\r\n}\r\n\r\n\r\nfunction SelectNodes(doc, xpath)\r\n{\r\n\tvar parser = new XPathParser();\r\n\tvar xpath = parser.parse(xpath);\r\n\tvar context = new XPathContext();\r\n\tif(doc.documentElement){\r\n\t\tcontext.expressionContextNode = doc.documentElement;\r\n\t} else {\r\n\t\tcontext.expressionContextNode = doc;\r\n\t}\r\n\tvar res = xpath.evaluate(context)\r\n\treturn res.toArray();\r\n}\r\n\r\nmodule.exports = SelectNodes;\r\n"]},"metadata":{},"sourceType":"script"}